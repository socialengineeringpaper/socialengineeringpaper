var AssistancePanel={};AssistancePanel.ControlId='',AssistancePanel.ContextControlSelectors=[],AssistancePanel.ShowPanel=!1,AssistancePanel.ShowSearch=!1,AssistancePanel.ShowPopularAnswers=!1,AssistancePanel.ShowAskQuestion=!1,AssistancePanel.ShowViewQuestions=!1,AssistancePanel.CommunityIsDown=!0,AssistancePanel.CommunityUserExists=!1,AssistancePanel.ShowSuggestion=!0,AssistancePanel.panel_is_open=!1,AssistancePanel.search_is_open=!1,AssistancePanel.UpdatePopularAnswersCalled=!1,AssistancePanel.onbeforeunloadfired=!1,AssistancePanel.lastLoadedSearchTerm=null,AssistancePanel.SearchText='',AssistancePanel.SearchContextualOnly=!0,AssistancePanel.SearchCurrentPageNum=1,AssistancePanel.MessagePopularAnswers='popular answers',AssistancePanel.MessageHaveIssue='Have a specific question\x3f',AssistancePanel.MessageGetHelp='Get help from Office 365 community experts.',AssistancePanel.MessageHowCanWeHelp='How can we help\x3f',AssistancePanel.MessageGiveUsDetails='Add details\x3a',AssistancePanel.MessageEnterQuestion='Enter your question here\x3a',AssistancePanel.MessageCantFind='Can\x27t find question\x3f',AssistancePanel.MessageNoExistingQuestions='Sorry, no results found.',AssistancePanel.MessagePostInfomation='By posting you agree to abide by the \x3ca href\x3d\x22http\x3a\x2f\x2fwww.microsoft.com\x2fonline\x2flegal\x2fv2\x2f\x3fdocid\x3d39\x26langid\x3den-us\x22 target\x3d\x22_blank\x22\x3ecode of conduct\x3c\x2fa\x3e for our community.',AssistancePanel.MessageFirstTime='Looks like this is the first time you\x27ve posted to the community',AssistancePanel.MessageCreateName='To post to the community, you need to create a display name. It will appear on all your posts and be linked to your public profile.',AssistancePanel.MessageCreateEmail='Notification email\x3a',AssistancePanel.MessageDisplayName='Display name',AssistancePanel.MessageChangeLater='Don\x27t worry, you can always change it later.',AssistancePanel.MessageSearchResult='Results for ',AssistancePanel.MessageSearchContextual='Contextual',AssistancePanel.MessageSearchAllAreas='All areas',AssistancePanel.MessageSearchIn='Search for help with ',AssistancePanel.MessageSearchDefault='Search community and help',AssistancePanel.MessagePostError='Something wrong when posting.',AssistancePanel.MessageCreateUserError='Something wrong when creating user.',AssistancePanel.MessageComfirmDismiss='Are you sure\x3f You will lose the question and any other information you\u2019ve provided so far.',AssistancePanel.MessageEmailDescription='This is used to notify you when people reply to your question. It isn\u2019t seen by anyone in the community.',AssistancePanel.PopularAnswersErrorMessage='Sorry, no results found.',AssistancePanel.SuggestionsErrorMessage='There\u2019s a problem with suggestion right now.',AssistancePanel.PostErrorMessage='Sorry, can you try again\x3f',AssistancePanel.SearchErrorMessage='\x3c\x25\x3dWebResourceString\x28\x22Microsoft.Online.BOX.Admin.UI.Loc.AssistancePanel\x22, \x22SearchErrorMessage\x22, Encoding.JavaScript\x29\x25\x3e',AssistancePanel.SearchResultErrorMessage='Sorry, there\u2019s a problem with search right now. Please try again later.',AssistancePanel.CreateUserErrorMessage='There was a problem submitting the post, please try again',AssistancePanel.ExpandPanelArrowLinkId='',AssistancePanel.CollapsePanelArrowLinkId='',AssistancePanel.SearchControlId='',AssistancePanel.EmailId='',AssistancePanel.ViewQuestionsTipId='',AssistancePanel.FirstRunTipId='',AssistancePanel.CommunityDownId='',AssistancePanel.PanelOpenCookieKey='',AssistancePanel.TipsCookieKey='',AssistancePanel.ViewQuestions=null,AssistancePanel.QuestionTitle=null,AssistancePanel.QuestionTitleVal=null,AssistancePanel.QuestionDesc=null,AssistancePanel.QuestionDescVal=null,AssistancePanel.CommunityDisplayName=null,AssistancePanel.NameVal=null,AssistancePanel.CommunityEmail=null,AssistancePanel.EmailVal=null,AssistancePanel.Post_CommunityDisplayNameServerValidator=null,AssistancePanel.Post_CommunityEmailServerValidator=null,AssistancePanel.PageId=null,AssistancePanel.TabSaver=null,AssistancePanel.PanelStartup=function(n,t,i,r,u,f,e,o,s,h,c){if(AssistancePanel.ViewQuestions=document.getElementById(n),AssistancePanel.QuestionTitle=document.getElementById(t),AssistancePanel.QuestionTitleVal=document.getElementById(i),AssistancePanel.QuestionDesc=document.getElementById(r),AssistancePanel.QuestionDescVal=document.getElementById(u),AssistancePanel.CommunityDisplayName=document.getElementById(f),AssistancePanel.NameVal=document.getElementById(e),AssistancePanel.CommunityEmail=document.getElementById(o),AssistancePanel.EmailVal=document.getElementById(s),AssistancePanel.Post_CommunityDisplayNameServerValidator=document.getElementById(h),AssistancePanel.Post_CommunityEmailServerValidator=document.getElementById(c),AssistancePanel.QuestionTitleVal.enabled=!1,AssistancePanel.QuestionDescVal.enabled=!1,AssistancePanel.NameVal.enabled=!1,AssistancePanel.EmailVal.enabled=!1,AssistancePanel.Post_CommunityDisplayNameServerValidator.enabled=!1,AssistancePanel.Post_CommunityEmailServerValidator.enabled=!1,location.href!=top.location.href&&!PageLayout.IsEmbeddedInDefaultPage()){AssistancePanel.DisplayPanel(!1);return}if(AssistancePanel.PageId=$("#BOXPageIDField").val(),$(".sidepanel01 .clicky").click(function(){$(".sidepanel01").hasClass('sidepanel01_default')?(AssistancePanel.expandAssistancePanel(),O365.Log.WriteLog(171816,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)):!$(".sidepanel01").hasClass('sidepanel01_default')&&$(".sidepanel01").hasClass('sidepanel_open')&&(AssistancePanel.collapseAssistancePanel(),O365.Log.WriteLog(171817,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)),Microsoft.Online.BOX.JS.Shared.GetPersistentCookie(AssistancePanel.TipsCookieKey)||(Microsoft.Online.BOX.JS.Shared.SetPersistentCookie(AssistancePanel.TipsCookieKey,'true',365,'/'),BalloonTip.Hide(AssistancePanel.FirstRunTipId),O365.Log.WriteLog(171818,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId))}),$('.sidepanel01_default').hover(function(){$(this).stop(!0,!0),AssistancePanel.AddClass('.sidepanel01_default','panel_peek',{width:"40px"},"width",200)},function(){$(this).stop(!0,!0),AssistancePanel.RemoveClass('.sidepanel01_default','panel_peek',{width:"30px"},"width",200)}),$('#ShellBodyAndFooterContainer')){var l=0;$('#ShellBodyAndFooterContainer').scroll(function(){var t=$(this).scrollLeft();l!=t&&(l=t,$('.sidepanel_wrapper').css("right",0-t))})}$(window).on('resize',function(){var n=750;$(window).width()<n&&AssistancePanel.panel_is_open&&!AssistancePanel.search_is_open&&AssistancePanel.collapseAssistancePanel()});Microsoft.Online.BOX.JS.Shared.GetSessionCookie(AssistancePanel.PanelOpenCookieKey)?AssistancePanel.expandAssistancePanel():AssistancePanel.collapseAssistancePanel(),AssistancePanel.DisplayPanel(),AssistancePanel.DisplaySearch(),AssistancePanel.DisplayPopularAnswers(),Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.Initialize(AssistancePanel.InitializeCallBack,AssistancePanel.InitializeErrorCallBack),window.setTimeout(function(){AssistancePanel.ShowTips()},2e3)},AssistancePanel.InitializeCallBack=function(n){n.Code>0||n.AdditionalInfo.length<5||(AssistancePanel.CommunityIsDown=AssistancePanel.GetBool(n.AdditionalInfo[0]),communityDown=document.getElementById(AssistancePanel.CommunityDownId),communityDown!=null&&AssistancePanel.CommunityIsDown&&(communityDown.style.display="block"),AssistancePanel.CommunityUserExists=AssistancePanel.GetBool(n.AdditionalInfo[1]),AssistancePanel.DisplayAskQuestion(AssistancePanel.GetBool(n.AdditionalInfo[2])),AssistancePanel.DisplayViewQuestions(AssistancePanel.GetBool(n.AdditionalInfo[3])),AssistancePanel.ViewQuestions.href=HtmlEncode(n.AdditionalInfo[4]))},AssistancePanel.InitializeErrorCallBack=function(){},AssistancePanel.OnSearch=function(){(AssistancePanel.SearchText=$.trim(SearchBox.GetText(AssistancePanel.SearchControlId)),AssistancePanel.SearchText.length!=0)&&($(".search-results-panel").hasClass("search-results-panel_closed")&&(AssistancePanel.search_is_open=!0,AssistancePanel.DisplayPopularAnswers(),AssistancePanel.removeSidepanelCollapseButton(),$(".sidepanel_wrapper").css("width","100%"),$(".search-results-panel").show(),AssistancePanel.SwitchClass(".search-results-panel","search-results-panel_closed","search-results-panel_open",{width:"100%"},"width",400),window.setTimeout(function(){AssistancePanel.DisplayPageLayout(!1)},400),O365.Log.WriteLog(171819,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)),AssistancePanel.Search())},AssistancePanel.Search=function(n){$("#SearchResultsControl").hide(),$("#SearchLoading").show(),$("div#SearchError").hide(),(typeof n=='undefined'||Boolean(n))&&(AssistancePanel.SearchCurrentPageNum=1),Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.Search(AssistancePanel.SearchText,AssistancePanel.SearchContextualOnly,AssistancePanel.SearchCurrentPageNum,AssistancePanel.ControlId,AssistancePanel.SearchCallBack,AssistancePanel.SearchErrorCallBack)},AssistancePanel.SearchCallBack=function(n){typeof AssistancePanel.OnSearchCallBack=="function"&&AssistancePanel.OnSeachCallback(n),n.Code>0?$("#SearchResultsControl").html(HtmlEncode(n.Message)):$("#SearchResultsControl").html(n.AdditionalInfo),$("#SearchResultsControl").show(),$("#SearchLoading").hide(),$("div#SearchError").hide()},AssistancePanel.SearchErrorCallBack=function(){$("#SearchResultsControl").html(''),$("#SearchResultsControl").hide(),$("#SearchLoading").hide(),$("div#SearchError").show()},AssistancePanel.DisplayPanel=function(n){n!=null&&AssistancePanel.ShowPanel!=n&&(AssistancePanel.ShowPanel=n),AssistancePanel.ShowPanel==!0?$(".sidepanel_wrapper").fadeIn(100):$(".sidepanel_wrapper").fadeOut(100)},AssistancePanel.DisplaySearch=function(n){n!=null&&AssistancePanel.ShowSearch!=n&&(AssistancePanel.ShowSearch=n),$("div#SearchDiv")!=null&&(AssistancePanel.ShowSearch==!0?$("div#SearchDiv").show():$("div#SearchDiv").hide())},AssistancePanel.DisplayPopularAnswers=function(n){n!=null&&AssistancePanel.ShowPopularAnswers!=n&&(AssistancePanel.ShowPopularAnswers=n),$("div#PopularAnswersDiv")!=null&&(AssistancePanel.ShowPopularAnswers==!0&&AssistancePanel.search_is_open==!1?$("div#PopularAnswersDiv").show():$("div#PopularAnswersDiv").hide())},AssistancePanel.DisplayAskQuestion=function(n){n!=null&&AssistancePanel.ShowAskQuestion!=n&&(AssistancePanel.ShowAskQuestion=n),$("div#AskQuestionDiv")!=null&&(AssistancePanel.ShowAskQuestion==!0?$("div#AskQuestionDiv").show():$("div#AskQuestionDiv").hide())},AssistancePanel.DisplayViewQuestions=function(n){n!=null&&AssistancePanel.ShowViewQuestions!=n&&(AssistancePanel.ShowViewQuestions=n),$("div#ViewQuestionsDiv")!=null&&(AssistancePanel.ShowViewQuestions==!0?$("div#ViewQuestionsDiv").show():$("div#ViewQuestionsDiv").hide())},AssistancePanel.collapseAssistancePanel=function(){$(".sidepanel01").hasClass("sidepanel_wide")&&AssistancePanel.closePostQuestionPanel(),AssistancePanel.SwitchClass(".sidepanel01","sidepanel_open","sidepanel01_default",{width:"30px"},"width",400),$(".sidepanel-info").fadeOut(100),AssistancePanel.panel_is_open=!1,$(AssistancePanel.CollapsePanelArrowLinkId).css("display","none"),$(AssistancePanel.ExpandPanelArrowLinkId).css("display","block"),null!==AssistancePanel.TabSaver&&(AssistancePanel.TabSaver.RestoreTab(),AssistancePanel.TabSaver=null),Microsoft.Online.BOX.JS.Shared.GetSessionCookie(AssistancePanel.PanelOpenCookieKey)&&Microsoft.Online.BOX.JS.Shared.ClearSessionCookie(AssistancePanel.PanelOpenCookieKey)},AssistancePanel.expandAssistancePanel=function(){AssistancePanel.SwitchClass(".sidepanel01","sidepanel01_default","sidepanel_open",{width:"310px"},"width",400),$(".sidepanel-info").fadeIn(100),AssistancePanel.panel_is_open=!0,$(AssistancePanel.ExpandPanelArrowLinkId).css("display","none"),$(AssistancePanel.CollapsePanelArrowLinkId).css("display","block"),AssistancePanel.TabSaver=new O365.TabSaver($(".sidepanel_wrapper").get(0)),AssistancePanel.TabSaver.DisableTab(),AssistancePanel.UpdatePopularAnswers(),Microsoft.Online.BOX.JS.Shared.GetSessionCookie(AssistancePanel.PanelOpenCookieKey)||Microsoft.Online.BOX.JS.Shared.SetSessionCookie(AssistancePanel.PanelOpenCookieKey,'true','/')},AssistancePanel.addSidepanelCollapseButton=function(){$(".sidepanel01 .sidepanel-arrow").fadeIn(300)},AssistancePanel.removeSidepanelCollapseButton=function(){$(".sidepanel01 .sidepanel-arrow").fadeOut(300)},AssistancePanel.closePostQuestionPanel=function(){$(".sidepanel-wide-panels").fadeOut(100),AssistancePanel.ShowPostQuestionForm(!1),$(".sidepanel01").removeClass("sidepanel_wide"),AssistancePanel.resetPostQuestionForm(),AssistancePanel.addSidepanelCollapseButton(),$(".sidepanel-info").fadeIn(200),AssistancePanel.DisplaySearch(),AssistancePanel.DisplayPopularAnswers(),AssistancePanel.DisplayAskQuestion(),AssistancePanel.DisplayViewQuestions()},AssistancePanel.resetPostQuestionForm=function(){$(".suggestion-box").slideUp(100),AssistancePanel.ShowPostQuestionDetailForm(!1),$(".sidepanel-info-status, .sidepanel-info-retry").hide(),AssistancePanel.ShowCreateUserForm(!1),AssistancePanel.QuestionTitle.value='',AssistancePanel.QuestionDesc.value='',AssistancePanel.CommunityDisplayName.value='',AssistancePanel.CommunityEmail.value='',AssistancePanel.ShowSuggestion=!0},AssistancePanel.UpdateCurrentControl=function(n){n!=null&&n!=AssistancePanel.ControlId&&(AssistancePanel.ControlId=n,Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.GetVisibilities(AssistancePanel.ControlId,AssistancePanel.GetVisibilitiesCallBack,AssistancePanel.GetVisibilitiesErrorCallBack))},AssistancePanel.SetPageContextControlSelectors=function(n){Object.prototype.toString.call(n)=="[object Array]"&&(AssistancePanel.ContextControlSelectors=n,AssistancePanel.ContextControlSelectors.length>0&&$(document).ready(function(){$('iframe').on("load",AssistancePanel.OnIframeLoaded);$(document).click(AssistancePanel.RefreshCurrentContextControlID),window.setTimeout(AssistancePanel.RefreshCurrentContextControlID,500)}))},AssistancePanel.GetFirstVisibleControlID=function(){for(var n,r,i,t=0;t<AssistancePanel.ContextControlSelectors.length;t++){if(n=AssistancePanel.ContextControlSelectors[t],$(n).is(":visible"))return n;for(r=$('iframe'),i=0;i<r.length;i++)try{if($(r[i]).contents().find(n).is(":visible"))return n}catch(u){}}return undefined},AssistancePanel.RefreshCurrentContextControlID=function(){var n=AssistancePanel.GetFirstVisibleControlID();n!=undefined&&AssistancePanel.UpdateCurrentControl(n)},AssistancePanel.OnIframeLoaded=function(){$('iframe').each(function(){try{$(this).contents().find("html").unbind("click",AssistancePanel.RefreshCurrentContextControlID),$(this).contents().find("html").bind("click",AssistancePanel.RefreshCurrentContextControlID)}catch(n){}}),window.setTimeout(AssistancePanel.RefreshCurrentContextControlID,500)},AssistancePanel.GetBool=function(n){return n=="1"},AssistancePanel.GetVisibilitiesCallBack=function(n){if(n.Code>0||n.AdditionalInfo.length<5){AssistancePanel.DisplayPanel(!1);return}AssistancePanel.DisplayPanel(AssistancePanel.GetBool(n.AdditionalInfo[0])),AssistancePanel.DisplaySearch(AssistancePanel.GetBool(n.AdditionalInfo[1])),AssistancePanel.DisplayPopularAnswers(AssistancePanel.GetBool(n.AdditionalInfo[2])),AssistancePanel.DisplayAskQuestion(AssistancePanel.GetBool(n.AdditionalInfo[3])&&!AssistancePanel.CommunityIsDown),AssistancePanel.DisplayViewQuestions(AssistancePanel.GetBool(n.AdditionalInfo[4])&&!AssistancePanel.CommunityIsDown),AssistancePanel.ShowPopularAnswers&&AssistancePanel.panel_is_open&&!AssistancePanel.search_is_open&&AssistancePanel.UpdatePopularAnswers()},AssistancePanel.GetVisibilitiesErrorCallBack=function(){AssistancePanel.DisplayPanel(!1)},AssistancePanel.UpdatePopularAnswers=function(){AssistancePanel.UpdatePopularAnswersCalled===!1&&(AssistancePanel.UpdatePopularAnswersCalled=!0,$("#PopularAnswersLoading").show(),$("div#PopularAnswersResultDiv").html(''),Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.GetPopularAnswers(AssistancePanel.ControlId,AssistancePanel.GetPopularAnswersCallback,AssistancePanel.GetPopularAnswersErrorCallback))},AssistancePanel.GetPopularAnswersCallback=function(n){typeof AssistancePanel.OnGetPopularAnswersCallback=="function"&&AssistancePanel.OnGetPopularAnswersCallback(n);var t='';t=n.Code!=0?HtmlEncode(n.Message):n.AdditionalInfo,$("#PopularAnswersLoading").hide(),$("div#PopularAnswersResultDiv").html(t)},AssistancePanel.GetPopularAnswersErrorCallback=function(){$("#PopularAnswersLoading").hide(),$("div#PopularAnswersResultDiv").html(HtmlEncode(AssistancePanel.PopularAnswersErrorMessage))},AssistancePanel.VerifyPostForm=function(){return AssistancePanel.QuestionTitle.value.length>0||AssistancePanel.QuestionDesc.value.length>0?!1:!0},AssistancePanel.VerifyCreateUserForm=function(){return AssistancePanel.CommunityDisplayName.value.length>0||AssistancePanel.CommunityEmail.value.length>0?!1:!0},AssistancePanel.Post=function(){if(AssistancePanel.Validate(AssistancePanel.QuestionTitleVal)&&AssistancePanel.Validate(AssistancePanel.QuestionDescVal)){if(AssistancePanel.CommunityUserExists==!1){AssistancePanel.ShowCreateUserForm(!0),Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.GetDefaultUserInfo(AssistancePanel.GetDefaultUserInfoCallBack,AssistancePanel.GetDefaultUserInfoErrorCallBack),AssistancePanel.ShowPostQuestionForm(!1),$(".sidepanel-info-retry").fadeOut(100);return}$(".sidepanel-info-status").fadeIn(100),AssistancePanel.ShowPostQuestionForm(!1),$(".sidepanel-info-retry").fadeOut(100);var n=$(AssistancePanel.EmailId).is(':checked');Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.PostQuestion(AssistancePanel.QuestionTitle.value,AssistancePanel.QuestionDesc.value,n,AssistancePanel.ControlId,AssistancePanel.PostQuestionCallback,AssistancePanel.PostQuestionErrorCallback)}},AssistancePanel.PostQuestionCallback=function(n){if(typeof AssistancePanel.OnPostQuestionCallback=="function"&&AssistancePanel.OnPostQuestionCallback(n),n.Code>0){$("div#PostResultDiv").html(HtmlEncode(n.Message)),$("div#PostRetryDiv").show(),$("div#CreateRetryDiv").hide(),$(".sidepanel-info-status").fadeOut(100),$(".sidepanel-info-retry").fadeIn(100);return}AssistancePanel.closePostQuestionPanel(),AssistancePanel.DisplayViewQuestions(!0),window.setTimeout(function(){BalloonTip.Show(AssistancePanel.ViewQuestionsTipId),window.setTimeout(function(){BalloonTip.Hide(AssistancePanel.ViewQuestionsTipId)},3e3)},1e3)},AssistancePanel.PostQuestionErrorCallback=function(){$("div#PostResultDiv").html(HtmlEncode(AssistancePanel.PostErrorMessage)),$("div#PostRetryDiv").show(),$("div#CreateRetryDiv").hide(),$(".sidepanel-info-status").fadeOut(100),$(".sidepanel-info-retry").fadeIn(100)},AssistancePanel.GetDefaultUserInfoCallBack=function(n){n.Code==0&&(AssistancePanel.CommunityDisplayName.value.length==0&&(AssistancePanel.CommunityDisplayName.value=n.AdditionalInfo.Name),AssistancePanel.CommunityEmail.value.length==0&&(AssistancePanel.CommunityEmail.value=n.AdditionalInfo.EMail))},AssistancePanel.GetDefaultUserInfoErrorCallBack=function(){},AssistancePanel.CreateUser=function(){AssistancePanel.CommunityUserExists!=!0&&AssistancePanel.Validate(AssistancePanel.NameVal)&&AssistancePanel.Validate(AssistancePanel.EmailVal)&&($(".sidepanel-info-status").fadeIn(100),AssistancePanel.ShowCreateUserForm(!1),$(".sidepanel-info-retry").fadeOut(100),Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.CreateUser(AssistancePanel.CommunityDisplayName.value,AssistancePanel.CommunityEmail.value,AssistancePanel.CreateUserCallback,AssistancePanel.CreateUserErrorCallback))},AssistancePanel.CreateUserCallback=function(n){var t,i,r;if(typeof AssistancePanel.OnCreateUserCallback=="function"&&AssistancePanel.OnCreateUserCallback(n),n.Code>0){if(t=!1,i=n.Message,n.Code==5&&Object.prototype.toString.call(n.AdditionalInfo)==="[object Array]"&&n.AdditionalInfo.length>0)for(i="",r=0;r<n.AdditionalInfo.length;r++)i=i.concat(n.AdditionalInfo[r].Message+" "),t=AssistancePanel.Post_ApplyValidationResult(n.AdditionalInfo[r])||t;else t=t||AssistancePanel.Post_ApplyValidationResult(n);t?($("div#PostRetryDiv").hide(),$(".sidepanel-info-status").fadeOut(100),AssistancePanel.ShowCreateUserForm(!0),AssistancePanel.Validate(AssistancePanel.Post_CommunityDisplayNameServerValidator),AssistancePanel.Validate(AssistancePanel.Post_CommunityEmailServerValidator)):($("div#CreateResultDiv").html(HtmlEncode(i)),$("div#PostRetryDiv").hide(),$("div#CreateRetryDiv").show(),$(".sidepanel-info-status").fadeOut(100),$(".sidepanel-info-retry").fadeIn(100));return}AssistancePanel.CommunityUserExists=!0,Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.GetViewMyQuestionsUrl(AssistancePanel.GetViewMyQuestionsUrlCallback,AssistancePanel.GetViewMyQuestionsUrlErrorCallback),AssistancePanel.Post()},AssistancePanel.Post_ApplyValidationResult=function(n){var t=null,i;return n.AdditionalInfo===AssistancePanel.Post_CommunityDisplayNamePropertyName?t=AssistancePanel.Post_CommunityDisplayNameServerValidator:n.AdditionalInfo===AssistancePanel.Post_CommunityEmailPropertyName&&(t=AssistancePanel.Post_CommunityEmailServerValidator),t?(i=document.getElementById(t.controltovalidate),t.ErrorValue=i.value,t.errormessage=n.Message,!0):!1},AssistancePanel.Post_ServerValidation=function(n,t){t.IsValid=t.Value===n.ErrorValue?!1:!0},AssistancePanel.CreateUserErrorCallback=function(){$("div#CreateResultDiv").html(HtmlEncode(AssistancePanel.CreateUserErrorMessage)),$("div#PostRetryDiv").hide(),$("div#CreateRetryDiv").show(),$(".sidepanel-info-status").fadeOut(100),$(".sidepanel-info-retry").fadeIn(100)},AssistancePanel.GetViewMyQuestionsUrlCallback=function(n){n.Code==0&&(AssistancePanel.ViewQuestions.href=HtmlEncode(n.AdditionalInfo))},AssistancePanel.GetViewMyQuestionsUrlErrorCallback=function(){},AssistancePanel.BackButton=function(){if($('.sidepanel-info-post-question').is(':visible')){AssistancePanel.CancelPost();return}if(!$('.sidepanel-info-status').is(':visible')){if($('.sidepanel-info-firstrun').is(':visible')){if(!AssistancePanel.VerifyCreateUserForm()&&!AssistancePanel.ConfirmDismiss())return;AssistancePanel.ShowPostQuestionForm(!0),AssistancePanel.ShowCreateUserForm(!1);return}if($('.sidepanel-info-retry').is(':visible')){if($('div#PostRetryDiv').is(':visible')){AssistancePanel.ShowPostQuestionForm(!0),$('.sidepanel-info-retry').fadeOut(100);return}if($('div#CreateRetryDiv').is(':visible')){AssistancePanel.ShowCreateUserForm(!0),$('.sidepanel-info-retry').fadeOut(100);return}}}},AssistancePanel.CloseSearch=function(){$('div#SearchResultDiv').html(''),AssistancePanel.DisplayPageLayout(!0),AssistancePanel.SwitchClass(".search-results-panel","search-results-panel_open","search-results-panel_closed",{width:"0%"},"width",400),SearchBox.Blur(AssistancePanel.SearchControlId),window.setTimeout(function(){$(".search-results-panel").hide(),$(".sidepanel_wrapper").css("width","0px"),AssistancePanel.search_is_open=!1,AssistancePanel.DisplayPopularAnswers(),AssistancePanel.addSidepanelCollapseButton()},500),O365.Log.WriteLog(171820,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)},AssistancePanel.AskQuestion=function(){AssistancePanel.AddClass(".sidepanel01","sidepanel_wide",{width:"480px"},"width",400,function(){$(".sidepanel-wide-panels").fadeIn(100),AssistancePanel.ShowPostQuestionForm(!0)}),$(".sidepanel-info").fadeOut(200),AssistancePanel.removeSidepanelCollapseButton()},AssistancePanel.CancelPost=function(){(AssistancePanel.VerifyPostForm()||AssistancePanel.ConfirmDismiss())&&AssistancePanel.closePostQuestionPanel()},AssistancePanel.GetQuestions=function(){AssistancePanel.ShowSuggestion==!0&&(AssistancePanel.QuestionTitle.value.length>0?($("span#DescriptionValidation").hide(),AssistancePanel.QuestionTitle.value!=AssistancePanel.lastLoadedSearchTerm&&Microsoft.Online.BOX.Admin.UI.WebControls.AssistancePanel.GetQuestions(AssistancePanel.QuestionTitle.value,AssistancePanel.ControlId,AssistancePanel.GetQuestionsCallback,AssistancePanel.GetQuestionsErrorCallback)):$(".suggestion-box").slideUp(100))},AssistancePanel.GetQuestionsCallback=function(n){if(AssistancePanel.ShowSuggestion==!0){$(".suggestion-box").slideDown(100);var t='';n.Code>0?t=HtmlEncode(n.Message):(t=n.AdditionalInfo,AssistancePanel.lastLoadedSearchTerm=n.Message),$("div#SuggestionDiv").html(t)}},AssistancePanel.GetQuestionsErrorCallback=function(){AssistancePanel.ShowSuggestion==!0&&$("div#SuggestionDiv").html(HtmlEncode(AssistancePanel.SuggestionsErrorMessage))},AssistancePanel.AddYourQuestion=function(){$(".suggestion-box").slideUp(100),AssistancePanel.ShowPostQuestionDetailForm(!0),AssistancePanel.ShowSuggestion=!1},AssistancePanel.ShowCreateUserForm=function(n){n==!0?($('.sidepanel-info-firstrun').fadeIn(100),O365.Log.WriteLog(171821,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)):($('.sidepanel-info-firstrun').fadeOut(100),BaseValidator.HideCalloutByTargetControl(AssistancePanel.CommunityDisplayName),BaseValidator.HideCalloutByTargetControl(AssistancePanel.CommunityEmail),O365.Log.WriteLog(171823,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId))},AssistancePanel.ShowPostQuestionForm=function(n){n==!0?($('.sidepanel-info-post-question').fadeIn(100),O365.Log.WriteLog(171822,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)):($('.sidepanel-info-post-question').fadeOut(100),BaseValidator.HideCalloutByTargetControl(AssistancePanel.QuestionTitle),BaseValidator.HideCalloutByTargetControl(AssistancePanel.QuestionDesc),O365.Log.WriteLog(171824,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId))},AssistancePanel.ShowPostQuestionDetailForm=function(n){n==!0?($(".post-question-details, .add-post-controls").show(),AssistancePanel.AddClass(".add-post-form","add-post-form-full",{bottom:"160px"},"bottom",100),O365.Log.WriteLog(171825,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId)):($(".post-question-details, .add-post-controls").hide(),AssistancePanel.RemoveClass(".add-post-form","add-post-form-full",{bottom:"0px"},"bottom",100),O365.Log.WriteLog(171826,O365.LogLevel.Info,O365.LogArea.AssistancePanel,O365.LogParameter.Empty,AssistancePanel.PageId))},AssistancePanel.ShowTips=function(){AssistancePanel.ShowPanel!=!0||Microsoft.Online.BOX.JS.Shared.GetPersistentCookie(AssistancePanel.TipsCookieKey)||BalloonTip.Show(AssistancePanel.FirstRunTipId)},AssistancePanel.ConfirmDismiss=function(){return confirm(AssistancePanel.MessageComfirmDismiss)},AssistancePanel.ValidateTitle=function(n,t){AssistancePanel.QuestionTitle.value.trim().length==0&&(t.IsValid=!1)},AssistancePanel.ValidateDesc=function(n,t){AssistancePanel.QuestionDesc.value.trim().length==0&&(t.IsValid=!1)},AssistancePanel.ValidateName=function(n,t){AssistancePanel.CommunityDisplayName.value.trim().length==0&&(t.IsValid=!1)},AssistancePanel.ValidateEmail=function(n,t){AssistancePanel.CommunityEmail.value.trim().length==0&&(t.IsValid=!1)},AssistancePanel.Validate=function(n){return typeof n=='undefined'?!1:(ValidatorEnable(n),n.enabled=!1,n.isvalid)},AssistancePanel.DisplayPageLayout=function(n){$('.PageLayout').length>0&&(n==!0?$('.PageLayout').css("visibility","visible"):$('.PageLayout').css("visibility","hidden"))},AssistancePanel.SwitchClass=function(n,t,i,r,u,f){$(n).animate(r,f,function(){$(this).addClass(i).removeClass(t).css(u,'')})},AssistancePanel.AddClass=function(n,t,i,r,u,f){$(n).animate(i,u,function(){$(this).addClass(t).css(r,''),f&&f()})},AssistancePanel.RemoveClass=function(n,t,i,r,u){$(n).animate(i,u,function(){$(this).removeClass(t).css(r,'')})}