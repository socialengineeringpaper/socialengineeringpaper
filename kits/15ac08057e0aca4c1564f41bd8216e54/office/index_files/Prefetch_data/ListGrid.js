var NavigatePage,BOX,ListGrid;(function(n){n[n.NoChange=0]="NoChange",n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.Direct=16]="Direct"})(NavigatePage||(NavigatePage={})),function(n){var t;(function(n){function i(n){var t=document.createElement("div");return t.appendChild(document.createTextNode(n)),t.innerHTML.replace(/\"/g,"&quot;")}function t(n){var t=i(n);return t.replace(/\'/g,"&#39;")}function o(n,t){return t.length?t.length>n.length?!1:n.substr(0,t.length)==t:!0}function u(n){return n!==null&&n!==undefined&&n!=''}var a,v,s,h,f,c,l,r,e;(function(n){n[n.ascending=0]="ascending",n[n.descending=1]="descending"})(n.SortOrder||(n.SortOrder={})),a=n.SortOrder,function(n){n[n.clientInitiated=0]="clientInitiated",n[n.serverInitiated=1]="serverInitiated"}(n.DataFetchMode||(n.DataFetchMode={})),v=n.DataFetchMode,s=function(){function n(){this.AddButton='AddButton',this.ArrowDown='ArrowDown',this.ArrowUp='ArrowUp',this.CloseButton='CloseButton',this.DeleteButton='DeleteButton',this.DeleteButtonDisabled='DeleteButtonDisabled',this.EditButton='EditButton',this.EditButtonDisabled='EditButtonDisabled',this.FilterButton='FilterButton',this.FirstPageButton='FirstPageButton',this.FirstPageButtonDisabled='FirstPageButtonDisabled',this.LastPageButton='LastPageButton',this.LastPageButtonDisabled='LastPageButtonDisabled',this.NextPageButton='NextPageButton',this.NextPageButtonDisabled='NextPageButtonDisabled',this.PreviousPageButton='PreviousPageButton',this.PreviousPageButtonDisabled='PreviousPageButtonDisabled',this.SearchButton='SearchButton'}return n}(),n.ListGridIconType=s,h=function(){function n(){}return n}(),n.ListGridState=h,f=function(){function n(n){this.LinkID=n.LinkID,this.Text=n.Text,this.Url=n.Url,this.OnClientClick=n.OnClientClick,this.Tooltip=n.Tooltip,this.Icon=n.Icon,this.IconTooltip=n.IconTooltip,this.Enabled=n.Enabled,this.HiddenForMultipleUsers=n.HiddenForMultipleUsers,this.Target=n.Target,this.IsVisible=n.IsVisible}return n}(),n.LinkInfo=f,c=function(){function n(n,t){var i,r;if(this._watermarkCssClass='ms-fcl-ns',this._spanEndTag="</span>",this._state=null,this._parentListGrid=null,this._actionBarContainerElement=null,this._addButtonElement=null,this._filterContainerElement=null,this._filterDeactivatedContainerElement=null,this._filterActivatedContainerElement=null,this._filterButtonElement=null,this._filterCloseButtonElement=null,this._filterSelectElement=null,this._searchContainerElement=null,this._searchDeactivatedContainerElement=null,this._searchActivatedContainerElement=null,this._searchButtonElement=null,this._searchCloseButtonElement=null,this._searchTextBoxElement=null,this._getAvailableFilters=null,this._filters=null,this._filterActions=null,this._filterActions={},this._parentListGrid=n,this._state=t,this._state.FilterActions!=null)for(i=0;i<this._state.FilterActions.length;i++)r=this._state.FilterActions[i],this._filterActions[r.ActionID]=r;this._getAvailableFilters=typeof this._state.GetAvailableFilters!='undefined'&&!!this._state.GetAvailableFilters?this.onGetAvailableFilters:null}return n.prototype.GetState=function(){return this._state},n.prototype.GetSearchText=function(){return this._searchTextBoxElement.val()},n.prototype.GetContainer=function(){return this._actionBarContainerElement},n.prototype.initialRender=function(){var n,t,i,r;this._actionBarContainerElement=$(String.format("<div id='{0}' class='ListGrid-ABContainer'></div>",this._parentListGrid.getElementID('ActionBarContainer')));var f=$("<table/>").appendTo(this._actionBarContainerElement),e=$("<tbody/>").appendTo(f),u=$("<tr/>").appendTo(e);this._addButtonElement=$("<td/>").appendTo(u),n=$(String.format("<a href='#' id='{0}' class='ListGrid-ABButton ms-fcl-ns' role='button' title='{1}' aria-label='{1}'></a>",this._parentListGrid.getElementID('AddButton'),this._parentListGrid.getIconTitle('AddButton'))),n.get(0).innerHTML=this._parentListGrid.getIconMarkup('AddButton'),n.click($.proxy(this._onAdd,this)),n.appendTo(this._addButtonElement),this._filterContainerElement=$("<td/>").appendTo(u),t=$(String.format("<span id='{0}'></span>",this._parentListGrid.getElementID('FilterContainer'))),t.appendTo(this._filterContainerElement),this._filterDeactivatedContainerElement=$(String.format("<span id='{0}'></span>",this._parentListGrid.getElementID('DeactivatedFilterUI'))),this._filterDeactivatedContainerElement.appendTo(t),this._filterButtonElement=$(String.format("<a href='#' id='{0}' class='ListGrid-ABButton ms-fcl-ns' role='button' title='{1}' aria-label='{1}'></a>",this._parentListGrid.getElementID('FilterButton'),this._parentListGrid.getIconTitle('FilterButton'))),this._filterButtonElement.get(0).innerHTML=this._parentListGrid.getIconMarkup('FilterButton'),this._filterButtonElement.click($.proxy(this._onActivateFilterControl,this)),this._filterButtonElement.appendTo(this._filterDeactivatedContainerElement),this._filterActivatedContainerElement=$(String.format("<span id='{0}'></span>",this._parentListGrid.getElementID('ActivatedFilterUI'))),this._filterActivatedContainerElement.appendTo(t),i='Filter',this._filterSelectElement=$(String.format("<select id='{0}' class='ListGrid-ABFilterSelect' title='{1}'></select>",this._parentListGrid.getElementID('FilterSelect'),i)),this._filterSelectElement.change($.proxy(this._onFilterChanged,this)),this._filterSelectElement.appendTo(this._filterActivatedContainerElement),this._filterCloseButtonElement=$(String.format("<a href='#' id='{0}' class='ListGrid-ABCloseButton ms-bcl-tl' role='button' title='{1}' aria-label='{1}'></a>",this._parentListGrid.getElementID('FilterCloseButton'),this._parentListGrid.getIconTitle('CloseButton'))),this._filterCloseButtonElement.get(0).innerHTML=this._parentListGrid.getIconMarkup('CloseButton'),this._filterCloseButtonElement.click($.proxy(this._onDeactivateFilterControl,this)),this._filterCloseButtonElement.appendTo(this._filterActivatedContainerElement),this.activateFilterControl(!1),this._searchContainerElement=$("<td/>").appendTo(u),r=$(String.format("<span id='{0}'></span>",this._parentListGrid.getElementID('SearchContainer'))),r.appendTo(this._searchContainerElement),this._searchDeactivatedContainerElement=$(String.format("<span id='{0}'></span>",this._parentListGrid.getElementID('DeactivatedSearchUI'))),this._searchDeactivatedContainerElement.appendTo(r),this._searchButtonElement=$(String.format("<a href='#' id='{0}' class='ListGrid-ABButton ms-fcl-ns' role='button' title='{1}' aria-label='{1}'></a>",this._parentListGrid.getElementID('SearchButton'),this._parentListGrid.getIconTitle('SearchButton'))),this._searchButtonElement.get(0).innerHTML=this._parentListGrid.getIconMarkup('SearchButton'),this._searchButtonElement.click($.proxy(this._onActivateSearchControl,this)),this._searchButtonElement.appendTo(this._searchDeactivatedContainerElement),this._searchActivatedContainerElement=$(String.format("<span id='{0}'></span>",this._parentListGrid.getElementID('ActivatedSearchUI'))),this._searchActivatedContainerElement.appendTo(r),i='Search',this._searchTextBoxElement=$(String.format("<input id='{0}' class='ListGrid-ABSearchTextBox' type='text' title='{1}' maxlength='{2}' />",this._parentListGrid.getElementID('SearchTextBox'),i,this._state.SearchStringMaxLength)),this._searchTextBoxElement.appendTo(this._searchActivatedContainerElement),this._searchTextBoxElement.blur($.proxy(this._onSearchTextboxBlur,this)),this._searchTextBoxElement.focus($.proxy(this._onSearchTextboxFocus,this)),this._searchTextBoxElement.keydown($.proxy(this._onSearchTextboxKeyDown,this)),this._searchCloseButtonElement=$(String.format("<a href='#' id='{0}' role='button' title='{1}' aria-label='{1}' class='ListGrid-ABCloseButton ms-bcl-tt'></a>",this._parentListGrid.getElementID('SearchCloseButton'),this._parentListGrid.getIconTitle('CloseButton'))),this._searchCloseButtonElement.get(0).innerHTML=this._parentListGrid.getIconMarkup('CloseButton'),this._searchCloseButtonElement.click($.proxy(this._onDeactivateSearchControl,this)),this._searchCloseButtonElement.appendTo(this._searchActivatedContainerElement),this.activateSearchControl(!1),this._renderCustomActions(),this._actionBarContainerElement.appendTo(this._parentListGrid.get_listGridContainerElement()),this._getAvailableFilters!=null&&this._getAvailableFilters($.proxy(this.onGetAvailableFiltersComplete,this),$.proxy(this.onGetAvailableFiltersComplete,this)),this.Update()},n.prototype.onGetAvailableFilters=function(n,t){Microsoft.Online.BOX.UI.WebControls.ListGrid.GenericGetAvailableFilters(this._state.GetAvailableFilters,n,t)},n.prototype.onGetAvailableFiltersComplete=function(n){if(n.ReturnCode.toString()==='0'&&this.updateFilters(n.Filters),typeof this._state.OnGetAvailableFiltersCompleted!='undefined'&&!(!this._state.OnGetAvailableFiltersCompleted||!this._state.OnGetAvailableFiltersCompleted.length)){var t=new Function(String.format('{0}();',this._state.OnGetAvailableFiltersCompleted));t()}},n.prototype.updateFilters=function(n){var u,r,e,o,s,t,f;if(this._filters=n,this._filterSelectElement.empty(),this._filters!=null)for(t=0;t<this._filters.length;t++)r=this._filters[t],$(String.format("<option id='Filter_{0}' value='{1},{2}' title='{3}' {4}>{5}</option>",i(r.TrackingID),i(r.FilterID),i(r.FilterType),i(r.FilterTooltip),this._state.DefaultFilter!=null&&r.FilterID!=null&&r.FilterID==this._state.DefaultFilter.FilterID?"selected=\"selected\"":'',i(r.FilterDisplayName))).appendTo(this._filterSelectElement);if(this._state.FilterActions!=null&&this._state.FilterActions.length>0){for(u=0,t=0;t<this._filters.length;t++)r=this._filters[t],u=Math.max(r.FilterDisplayName.length,u);for(t=0;t<this._state.FilterActions.length;t++)f=this._state.FilterActions[t],u=Math.max(f.ActionDisplayName.length,u);for(e="",o=0;o<u/2;o++)e=e+String.fromCharCode(8212);for(s=$("<option id='FilterSeparator' class='ms-fcl-nsa' title='' disabled='disabled' onchange='return false;'></option>").appendTo(this._filterSelectElement),s.text(e.toString()),t=0;t<this._state.FilterActions.length;t++)f=this._state.FilterActions[t],$(String.format("<option id='FilterAction_{0}' value='{0}' title='{1}'>{2}</option>",i(f.ActionID),i(f.ActionTooltip),i(f.ActionDisplayName))).appendTo(this._filterSelectElement)}this.Update()},n.prototype.Update=function(){this._state.IsVisible?this._actionBarContainerElement.show():this._state.ShowEmptyActionBar?this._actionBarContainerElement.css('visibility','hidden'):this._actionBarContainerElement.hide(),this._state.AddEnabled?this._addButtonElement.show():this._addButtonElement.hide(),this._state.FilterEnabled?(this._filterContainerElement.show(),this._filters!=null&&this._filters.length>0&&this.activateFilterControl(this._state.FilterControlActivated)):this._filterContainerElement.hide(),this._state.SearchEnabled?(this._searchContainerElement.show(),this.activateSearchControl(this._state.SearchControlActivated)):this._searchContainerElement.hide()},n.prototype.EnableFilterAction=function(n,t){var i=this._filterSelectElement.find(String.format("option[value='{0}']",n));t?i.get(0).removeAttribute('disabled'):i.attr('disabled','disabled')},n.prototype.isElementActivated=function(n){var t,i;try{if(n!=null&&n!=''&&document.activeElement!=null)for(t=document.activeElement;t!=null;){if(i=t.id,i!=null&&i!=''&&i==n)return!0;t=t.parentNode}}catch(r){}return!1},n.prototype.activateFilterControl=function(n){var t,i;this._state.FilterControlActivated=n,n?(t=this._parentListGrid.getElementID('FilterButton'),i=this.isElementActivated(t),this._filterDeactivatedContainerElement.hide(),this._filterActivatedContainerElement.show(),i&&this._filterSelectElement.focus()):(t=this._parentListGrid.getElementID('FilterCloseButton'),i=this.isElementActivated(t),this._filterActivatedContainerElement.hide(),this._filterDeactivatedContainerElement.show(),i&&this._filterButtonElement.focus())},n.prototype.activateSearchControl=function(n){var t,i;this._state.SearchControlActivated=n,n?(t=this._parentListGrid.getElementID('SearchButton'),i=this.isElementActivated(t),this._searchDeactivatedContainerElement.hide(),this._searchActivatedContainerElement.show(),i&&this._searchTextBoxElement.focus()):(t=this._parentListGrid.getElementID('SearchCloseButton'),i=this.isElementActivated(t),this._searchActivatedContainerElement.hide(),this._searchDeactivatedContainerElement.show(),i&&this._searchButtonElement.focus())},n.prototype.clearSearch=function(){this._searchTextBoxElement.val('');this._searchTextBoxElement.one("change",$.proxy(this._onSearchChanged,this));this._searchTextBoxElement.change()},n.prototype.displaySearchControl=function(n){n&&this._state.SearchEnabled?this._searchContainerElement.css('visibility','visible'):this._searchContainerElement.css('visibility','hidden')},n.prototype.displayAddButton=function(n){n&&this._state.AddEnabled?this._addButtonElement.show():this._addButtonElement.hide()},n.prototype.focusFilterCloseButton=function(){this._state.FilterControlActivated&&this._filterCloseButtonElement.focus()},n.prototype.setFilter=function(n){for(var r=this._filterSelectElement.get(0),i,u,t=0;t<r.options.length;t++)if(i=r.options[t],i.id===n){this.activateFilterControl(!0),r.selectedIndex=t,u=this._buildFilterDetails(i),u!=null&&(WebTracking.TrackLinkClick(i.id,null),this._parentListGrid.UpdateData('',null,1,u));break}},n.prototype._buildFilterDetails=function(n){var i=null,t=n.value.split(',');return t.length>=2&&(i={FilterID:t[0],FilterType:t[1],SearchText:this._parentListGrid.get_CurrentFilter()!=null?this._parentListGrid.get_CurrentFilter().SearchText:null}),i},n.prototype._onAdd=function(n){if(!(!this._state.OnAdd||!this._state.OnAdd.length)){var t=new Function(String.format('return {0}()',this._state.OnAdd)),i=t();i||n.stopPropagation()}n.preventDefault()},n.prototype._onCustomAction=function(n){var t=n.target.getAttribute('onclientclick'),i,r;!t||!t.length||(i=new Function(String.format('return {0}()',t)),r=i(),r||n.stopPropagation())},n.prototype._renderCustomActions=function(){var u,s,h;if(this._actionBarContainerElement.remove("a[id^='CustomAction_']"),this._state.CustomActions!=null)for(u=0;u<this._state.CustomActions.length;u++){var n=this._state.CustomActions[u],o=t(n.Tooltip),c=!n.Url||!n.Url.length?'#':encodeURI(t(n.Url)),e=t(n.OnClientClick),l=this._parentListGrid.getElementID(n.ID),r=$("<td/>"),f=$(String.format("<a id='{0}' href='{1}' onclientclick='{2}' role='button' title='{3}' class='ListGrid-ABButton ms-fcl-ns' style='display: inline-table;'></a>",'CustomAction_Icon_'+l,c,e,o));f.appendTo(r),s=$(String.format("<img src='{0}' title='{2}' alt='{2}' onclientclick='{1}' style='margin: 0 5px;' />",t(n.Icon),e,o)),s.appendTo(f),n.Text!=null&&n.Text.length>0&&(h=$(String.format("<span onclientclick='{0}' style='vertical-align: top;'>{1}</span>",e,i(n.Text))),h.appendTo(f)),!n.OnClientClick||!n.OnClientClick.length||f.click(this._onCustomAction),n.Position?n.Position===1?r.insertBefore(this._filterContainerElement):n.Position===2?r.insertBefore(this._searchContainerElement):r.appendTo(this._actionBarContainerElement.find("tr")[0]):r.insertBefore(this._addButtonElement)}},n.prototype._onActivateFilterControl=function(n){this.activateFilterControl(!0),n.preventDefault()},n.prototype._onDeactivateFilterControl=function(n){var r,i,t;if(this.activateFilterControl(!1),r=this._filterSelectElement.get(0),i=0,this._state.DefaultFilter!=null)for(t=0;t<this._filters.length;t++)this._filters[t].FilterID==this._state.DefaultFilter.FilterID&&(i=t);r.selectedIndex!=i&&(r.selectedIndex=i,this._onFilterChanged(n)),n.preventDefault()},n.prototype._onFilterChanged=function(n){if(!this._state.OnFilter||!this._state.OnFilter.length)this.applyCurrentFilter(n,'');else{var t=new Function(String.format('return {0}()',this._state.OnFilter)),i=t();i||n.stopPropagation()}},n.prototype._onActivateSearchControl=function(n){this.activateSearchControl(!0),n.preventDefault()},n.prototype._onDeactivateSearchControl=function(n){var t,i,r,u;this.activateSearchControl(!1),t=this._parentListGrid.get_CurrentFilter(),t!=null?(i=t.SearchText,!i||!i.length||(this._searchTextBoxElement.val(''),this._onSearchChanged(n))):this._state.OnSearchControlDeactivated!=null&&this._state.OnSearchControlDeactivated.length!=0?(r=new Function("return "+this._state.OnSearchControlDeactivated+"()"),u=r(),u||(n.stopPropagation(),n.preventDefault())):n.preventDefault()},n.prototype._onSearchTextboxBlur=function(){this._onShowWatermarkText(this._searchTextBoxElement,!0)},n.prototype._onSearchTextboxFocus=function(){this._onShowWatermarkText(this._searchTextBoxElement,!1)},n.prototype._onShowWatermarkText=function(n,t){if(t){if(!n.val().length){n.addClass(this._watermarkCssClass);var i=this._state.SearchWatermarkText;n.val(i)}}else n.hasClass(this._watermarkCssClass)&&(n.val(''),n.removeClass(this._watermarkCssClass))},n.prototype._onSearchTextboxKeyDown=function(n){n.which===13&&(this._onSearchChanged(n),n.stopPropagation(),n.preventDefault())},n.prototype._onSearchChanged=function(n){if(this._state.OnSearch!=null&&this._state.OnSearch.length!=0){var t=new Function("return "+this._state.OnSearch+"()"),i=t();i||(n.stopPropagation(),n.preventDefault())}else this.search(''),n.stopPropagation(),n.preventDefault()},n.prototype.search=function(n){this._onShowWatermarkText(this._searchTextBoxElement,!1);var t={FilterID:this._parentListGrid.get_CurrentFilter()!=null?this._parentListGrid.get_CurrentFilter().FilterID:null,FilterType:this._parentListGrid.get_CurrentFilter()!=null?this._parentListGrid.get_CurrentFilter().FilterType:null,SearchText:this._searchTextBoxElement.val()};this._parentListGrid.UpdateData(n,null,1,t)},n.prototype.applyCurrentFilter=function(n,t){var s=this._filterSelectElement.get(0),i=s.options[s.selectedIndex],u,f,e,r,h,c;o(i.id,'Filter_')?(u=this._buildFilterDetails(i),u!=null&&(WebTracking.TrackLinkClick(i.id,null),this._parentListGrid.UpdateData(t,null,1,u))):o(i.id,'FilterAction_')&&(f=i.value,this._filterActions[f]!==undefined&&(e=this._filterActions[f],e!=null&&(r=e.OnSelected,!r||!r.length||(h=new Function(String.format('return {0}()',r)),c=h(),c||n.stopPropagation()))))},n}(),n.ActionBarComponent=c,l=function(){function n(n,t){this._state=null,this._parentListGrid=null,this._quickPanelContent=null,this._faderContainer=null,this._currentEditIconEnabled=!1,this._currentDeleteIconEnabled=!1,this._currentCheckedMultiCheckboxes=!1,this._selectedItems=null,this._currentDescription=[],this._currentQuickLinks={},this._currentRelatedLinks={},this._currentPrimaryInfo=[],this._currentSecondaryInfo=[],this._parentListGrid=n,this._state=t}return n.prototype.getState=function(){return this._state},n.prototype.initialRender=function(){var n=this._parentListGrid.get_listGridContainerElement().find(String.format('#{0}',this._parentListGrid.get_quickPanelContainerID()));this._quickPanelContent=$(String.format("<div id='{0}'></div>",this._parentListGrid.getElementID('QuickPanelContent'))).appendTo(n),this._faderContainer=$(String.format("<div id='{0}'></div>",this._parentListGrid.getElementID('FaderContainer'))).appendTo(n),this.showItems(null),this.update(),$(window).resize($.proxy(this.onWindowResize,this))},n.prototype.onWindowResize=function(){this.updateFader()},n.prototype.updateFader=function(){var i=3,r=10,t;this._faderContainer.children().remove();var n=this._quickPanelContent.get(0),u=0,f=0,o=null;for($.browser||e.SetBrowser();n!=null&&($.browser.msie&&$.browser.version==='7.0'||n.id!=='ShellBody');)f+=n.offsetLeft,u+=n.offsetTop,o!=null||!n.style.backgroundColor||!n.style.backgroundColor.length||(o=n.style.backgroundColor),n=n.offsetParent;for(t=0;t<r;t++)$(String.format("<div class='ListGrid-QPFader ms-bgc-w' style='opacity:{0}; filter:alpha(opacity={1}); top:{2}px; left:{3}px; width:{4}px; height:{5}px;' />",1-t/r,100-100*t/r,u,f+(Shared.IsTextRightToLeft?t*i:this._quickPanelContent.width()-t*i),i,this._quickPanelContent.height())).appendTo(this._faderContainer)},n.prototype.showItems=function(n){var l,p,h,c,a,i,v,u,e,o,t,s,y;if(n!=null&&r._getKeyCount(n)){this._selectedItems=[];for(l in n)this._selectedItems.push(l);this._currentDescription=[],p="",this._currentDeleteIconEnabled=!1,this._currentEditIconEnabled=!1,this._currentQuickLinks={},this._currentRelatedLinks={},this._currentPrimaryInfo=[],this._currentSecondaryInfo=[],this._currentCheckedMultiCheckboxes=r._getKeyCount(n)>1,h=n;for(c in h){if(a={key:c,value:h[c]},i=a.value,r._getKeyCount(n)===1)for(t=0;t<i.QuickPanelDescriptions.length;t++)v=i.QuickPanelDescriptions[t],this._currentDescription[this._currentDescription.length]=v;for(this._currentEditIconEnabled=(this._currentEditIconEnabled||!i.EditDisabled)===!0,this._currentDeleteIconEnabled=(this._currentDeleteIconEnabled||!i.DeleteDisabled)===!0,t=0;t<i.QuickPanelQuickLinks.length;t++)u=i.QuickPanelQuickLinks[t],this._currentQuickLinks[u.LinkID]!==undefined?this._currentQuickLinks[u.LinkID].Enabled=(this._currentQuickLinks[u.LinkID].Enabled|u.Enabled)==1:this._currentQuickLinks[u.LinkID]=new f(u);for(t=0;t<i.QuickPanelRelatedLinks.length;t++)e=i.QuickPanelRelatedLinks[t],this._currentRelatedLinks[e.LinkID]!==undefined?this._currentRelatedLinks[e.LinkID].Enabled=(this._currentRelatedLinks[e.LinkID].Enabled|e.Enabled)==1:this._currentRelatedLinks[e.LinkID]=new f(e);if(r._getKeyCount(n)===1&&i.SecondaryInfo!=null)for(t=0;t<i.SecondaryInfo.length;t++)o=i.SecondaryInfo[t],o!==null&&o!==undefined&&(this._currentSecondaryInfo[this._currentSecondaryInfo.length]=o);if(r._getKeyCount(n)===1&&i.PrimaryInfo!=null)for(t=0;t<i.PrimaryInfo.length;t++)s=i.PrimaryInfo[t],s!==null&&s!==undefined&&(this._currentPrimaryInfo[this._currentPrimaryInfo.length]=s)}r._getKeyCount(n)>1&&(y='\x7b0\x7d selected',this._currentDescription[this._currentDescription.length]=String.format(y,r._getKeyCount(n)),this._currentDeleteIconEnabled=(this._currentDeleteIconEnabled&&this._state.AllowBulkDelete)===!0,this._currentEditIconEnabled=(this._currentEditIconEnabled&&this._state.AllowBulkEdit)===!0),this._currentDeleteIconEnabled=(this._currentDeleteIconEnabled&&this._state.DeleteEnabled)===!0,this._currentEditIconEnabled=(this._currentEditIconEnabled&&this._state.EditEnabled)===!0,this._renderQuickPanelContent()}else this._quickPanelContent.children().remove()},n.prototype._onEdit=function(n){this._onAction(this._state.OnEdit,n)},n.prototype._onDelete=function(n){this._onAction(this._state.OnDelete,n)},n.prototype._onAction=function(n,t){var i,u,r,f,e,o;if(!(!n||!n.length)&&this._selectedItems!=null){for(i="",i=i+'[',u=!0,r=0;r<this._selectedItems.length;r++)f=this._selectedItems[r],i=i+String.format("{1}'{0}'",f,u?'':','),u=!1;i=i+']',e=new Function(String.format('return {0}({1})',n,i)),o=e(),o||(t.stopPropagation(),t.preventDefault())}},n.prototype._renderQuickPanelContent=function(){var l=this,a,n,y,r,f,e,o;if(this._quickPanelContent.children().remove(),this._currentDescription.length>0&&(a=$(String.format("<div class='ListGrid-QPDescription1 ListGrid-QPContentContainer ms-fcl-ns' style='{0}'></div>",this._state.DescriptionStyle==null?'':this._state.DescriptionStyle)).appendTo(this._quickPanelContent),a.text(this._currentDescription[0])),this._currentDescription.length>1){var b=$("<div class='ListGrid-QPContentContainer'></div>").appendTo(this._quickPanelContent),s="",v='';for(n=1;n<this._currentDescription.length;n++)!this._currentDescription[n]||!this._currentDescription[n].length||(this._currentDescription[n].indexOf('@')>0&&(v="class='Ltr'"),s=s+String.format("<div {0}>{1}</div><br />",v,i(this._currentDescription[n])));b.html(s.toString())}if(this._renderQuickPanelInfo(this._currentPrimaryInfo),this._state.EditEnabled||this._state.DeleteEnabled){if(y="<span class='ListGrid-QPIconSeparator'>|</span>",r=$("<div class='ListGrid-QPIcons'></div>").appendTo(this._quickPanelContent),this._currentEditIconEnabled){var u=this._getDetailedTitle(this._parentListGrid.getIconTitle('EditButton')),h=$(String.format("<a class='ListGrid-QPIconContainer' href='#' title='{0}'></a>",t(u))),p=String.format("<span class='HiddenForScreenReader' tabindex='-1'>{0}</span>",i(u)),w='';this._state.EditButtonText!=null&&this._state.EditButtonText!=''&&(w=String.format("<span class= 'ListGrid-QPIconText' tabindex='-1'>{0}</span>",i(this._state.EditButtonText))),h.get(0).innerHTML=p+this._parentListGrid.getIconMarkup('EditButton')+w,h.bind('click',function(n){l._onEdit(n)}),h.appendTo(r)}else this._state.HideDisabledButtons||(f=$("<span class='ListGrid-QPIconContainer'></span>"),f.get(0).innerHTML=this._parentListGrid.getIconMarkup('EditButtonDisabled'),f.bind('click',function(n){n.preventDefault()}),f.appendTo(r));if(this._state.HideDisabledButtons||$(y).appendTo(r),this._currentDeleteIconEnabled){var u=this._getDetailedTitle(this._parentListGrid.getIconTitle('DeleteButton')),c=$(String.format("<a class='ListGrid-QPIconContainer' href='#' title='{0}'></a>",t(u))),p=String.format("<span class='HiddenForScreenReader' tabindex='-1'>{0}</span>",i(u));c.get(0).innerHTML=p+this._parentListGrid.getIconMarkup('DeleteButton'),c.bind('click',function(n){l._onDelete(n)}),c.appendTo(r)}else this._state.HideDisabledButtons||(e=$("<span class='ListGrid-QPIconContainer'></span>"),e.get(0).innerHTML=this._parentListGrid.getIconMarkup('DeleteButtonDisabled'),e.bind('click',function(n){n.preventDefault()}),e.appendTo(r))}this._renderQuickPanelInfo(this._currentSecondaryInfo),o=this._state.QuickLinksHeading,this._renderLinkSection(this._currentQuickLinks,o,'ListGrid-QPQuickLinks'),o=this._state.RelatedLinksHeading,this._renderLinkSection(this._currentRelatedLinks,o,'ListGrid-QPRelatedLinks'),this.update()},n.prototype._renderQuickPanelInfo=function(n){var r,i,o,f,s,v,e,y,p,h,c;if(n.length>0)for(r=0;r<n.length;r++){if(i=n[r],u(i.Title))if(u(i.TitleUrl)||u(i.OnClick)){var e=$("<div class='ListGrid-QPSecondaryInfoHeading'></div>").appendTo(this._quickPanelContent),l="",a="";u(i.OnClick)&&(l=String.format("onClick='{0}'",t(i.OnClick))),t(i.TitleUrl)&&(a=String.format("href='{0}'",t(i.TitleUrl))),o=$(String.format("<a class='ListGrid-QPIconContainer' {0} title='{1}' {2}></a>",a,i.Title,l)),f=t(i.Title),u(i.TitleIcon)&&(s=this._parentListGrid.getIconMarkup(i.TitleIcon),s!==null&&(v=String.format("<span class='HiddenForScreenReader' tabindex='-1'>{0}</span>",i.Title),f=v+s+f)),o.get(0).innerHTML=f,o.appendTo(e)}else e=$("<div class='ListGrid-QPSecondaryInfoHeading'></div>").appendTo(this._quickPanelContent),e.text(i.Title);u(i.Text)?u(i.Url)?(y=String.format("<a href='{0}' class='ms-fcl-tp {4}' title='{1}'>{2}<span class='HiddenForScreenReader' tabindex='-1'>{3}</span></a><br />",t(i.Url),t(i.Text),t(i.Text),t(i.Text),i.CssClass),$(y).appendTo(this._quickPanelContent)):(p=String.format("<div class='{0}'></div>",i.CssClass),h=$(p).appendTo(this._quickPanelContent),h.text(i.Text)):u(i.HtmlString)&&$(i.HtmlString).appendTo(this._quickPanelContent),i.RangeValue!==null&&i.RangeValue!==undefined&&i.RangeMaxValue!==null&&i.RangeMaxValue!==undefined&&(c=Math.ceil(i.RangeValue*100/i.RangeMaxValue),$(String.format("\r\n<br />\r\n<table class='ListGrid-QPSecondaryInfoRange' cellpadding='0' cellspacing='0'>\r\n<tr><td class='ListGrid-QPSecondaryInfoRangeForeground' style='width:{0}%'></td>\r\n<td class='ListGrid-QPSecondaryInfoRangeBackground' style='width:{1}%'></td></tr></table>",c,100-c)).appendTo(h))}},n.prototype._getDetailedTitle=function(n){var t;return this._state.UseDetailedTitle&&(this._currentDescription!=null&&this._currentDescription.length==1?(t='\x7b0\x7d for \x7b1\x7d',n=String.format(t,n,this._currentDescription[0])):this._currentDescription!=null&&this._currentDescription.length>1&&(t='\x7b0\x7d for \x7b1\x7d \x7b2\x7d',n=String.format(t,n,this._currentDescription[0],this._currentDescription[1]))),n},n.prototype._getDetailedTextForHiddenSpan=function(){var t="",n;return this._currentDescription!=null&&this._currentDescription.length==1?(n=',for \x7b0\x7d',t=String.format(n,this._currentDescription[0])):this._currentDescription!=null&&this._currentDescription.length>1&&(n=',for \x7b0\x7d \x7b1\x7d',t=String.format(n,this._currentDescription[0],this._currentDescription[1])),t},n.prototype._renderLinkSection=function(n,i,u){var k=this,s,c,l,f,b,h,o;if(r._getKeyCount(n)>0){this._state.HideLinkSectionTitle||$(String.format("<div class='ListGrid-QPHeading ms-fcl-ns'>{0}</div>",i)).appendTo(this._quickPanelContent),s=n;for(c in s){if(l={key:c,value:s[c]},f=l.value,this._currentCheckedMultiCheckboxes&&f.HiddenForMultipleUsers)break;if(f.IsVisible){var tt=t(this._getDetailedTextForHiddenSpan()),a=t(this._getDetailedTitle(f.Tooltip)),v=t(f.Tooltip),rt=t(f.IconTooltip),nt=$(String.format("<div class='{0}'></div>",u)).appendTo(this._quickPanelContent),g=$(String.format("<table summary='{0}'/>",v)).appendTo(nt),d=$("<tbody/>").appendTo(g),w=$("<tr/>").appendTo(d);f.Icon!=null&&f.Icon.length>0&&(b=$(String.format("<td><img src='{0}' title='{1}' alt='{1}'/></td>",t(f.Icon),f.IconTooltip?rt:v)),b.appendTo(w));var it=$("<td/>").appendTo(w),p=String.format("<a id='{0}' href='{1}' class='ms-fcl-tp' title='{2}' {3}",f.LinkID,!f.Url||!f.Url.length?'#':encodeURI(t(f.Url)),a,f.Target!=null?"target='"+f.Target+"'>":">"),y=String.format("<span class='HiddenForScreenReader' tabindex='-1'>{0}</span></a>",tt),e=t(f.Text);e.search(/&lt;[Aa]&gt;.*&lt;\/[Aa]&gt;/i)<0?e=p+e+y:(e=e.replace(/&lt;\/[Aa]&gt;/i,y),e=e.replace(/&lt;[Aa]&gt;/i,"</a>"+p),e=String.format("<div><a id='{0}' class='ListGrid-QPDisabledLink' disabled='true' onclick='return false;' title='{1}' {2}{3}</div>",f.LinkID+"_text",a,f.Target!=null?"target='"+f.Target+"'>":">",e)),h=$(e).appendTo(it),f.Enabled?!f.OnClientClick||!f.OnClientClick.length||h.bind('click',function(t){var i=t.target.id;k._onAction(n[i].OnClientClick,t)}):(o=h.get(0),o.className='ListGrid-QPDisabledLink',o.setAttribute('onclick','return false;'),o.setAttribute('disabled','true'),o.removeAttribute('href'))}}}},n.prototype.update=function(){this._state.IsVisible?(this._quickPanelContent.show(),this.updateFader()):this._quickPanelContent.hide()},n}(),n.QuickPanelComponent=l,r=function(){function n(n,t,i){this._state=null,this._parentListGrid=null,this._shiftSelectAnchorIndex=0,this._gridviewContainerElement=null,this._gridviewTableElement=null,this._gridviewHeaderRow=null,this._gridviewFooterRow=null,this._pagingControlsPlaceHolder=null,this._pagingControlsContainer=null,this._pagingStatusContainer=null,this._pagingIcons=null,this._pagingCallbacks=null,this._gridviewTableBody=null,this._quickPanelContainerCell=null,this._verticalBufferingTableRow=null,this._emptyMessageContainer=null,this._selectedItems=null,this._notifySelectionChanged=null,this._checkBoxColumnWidth=0,this._titleAttribute="title",this._selectType="checkbox",this._parentListGrid=n,this._state=t,this._selectedItems={},this._notifySelectionChanged=i,this._pagingCallbacks=[this._onFirstPageClicked,this._onPreviousPageClicked,this._onNextPageClicked,this._onLastPageClicked],t.MultiSelectEnabled||(this._selectType="radio")}return n.prototype.get__isQuickPanelVisible=function(){return this._parentListGrid.QuickPanel.getState().IsVisible},n.prototype.GetState=function(){return this._state},n.prototype.initialRender=function(){var h=this._state.GridColumns.length*2,f=h+2,t,c,u,o,a,s,n,v;for(this._gridviewContainerElement=$(String.format("<div id='{0}'></div>",this._parentListGrid.getElementID('GridViewContainer'))).appendTo(this._parentListGrid.get_listGridContainerElement()),this._gridviewTableElement=$(String.format("<table id='{0}' class='ListGrid-GVTable' cellpadding='0' cellspacing='0'></table>",this._parentListGrid.getElementID('GridViewTable'))).appendTo(this._gridviewContainerElement),!this._state.Summary||!this._state.Summary.length||this._gridviewTableElement.attr('summary',this._state.Summary),t='<colgroup>',n=0;n<f;n++)t=t+'<col />';this.get__isQuickPanelVisible()&&(t=t+"<col width='200px'>"),t=t+'</colgroup>',$(t.toString()).appendTo(this._gridviewTableElement),c=$('<thead></thead>').appendTo(this._gridviewTableElement),this._gridviewHeaderRow=$("<tr class='ListGrid-GVColumnHeaderRow'></tr>").appendTo(c);var l=$("<th class='ListGrid-GVCheckboxColumnHeader'></th>").appendTo(this._gridviewHeaderRow),y='Select all items',p=$(String.format("<input id='{0}' type='checkbox' title='{1}' aria-label='{1}' />",this._parentListGrid.getElementID('SelectAllCheckbox'),y)).appendTo(l);for(p.click($.proxy(this.onCheckboxColumnHeaderClick,this)),$("<th class='ListGrid-GVSpacerColumnHeader' aria-hidden='true'>&nbsp;</th>").appendTo(this._gridviewHeaderRow),u=0;u<this._state.GridColumns.length;u++){var r=this._state.GridColumns[u],w=r.CssClass!=null?r.CssClass:'',e=$(String.format("<th class='ListGrid-GVDataHeader ms-fcl-ns {1}' property='{0}'></th>",i(r.PropertyName),w));!r.Width||!r.Width.length||e.width(r.Width),e.attr('scope','col'),e.appendTo(this._gridviewHeaderRow),$("<th class='ListGrid-GVDataSpacerColumnHeader' aria-hidden='true'>&nbsp;</th>").appendTo(this._gridviewHeaderRow)}for(this.get__isQuickPanelVisible()&&$("<th class='ListGrid-GVQuickPanelHeader' aria-hidden='true'>&nbsp;</th>").appendTo(this._gridviewHeaderRow),this._gridviewTableBody=$('<tbody></tbody>').appendTo(this._gridviewTableElement),o=$(String.format("<tr id='{0}'></tr>",this._parentListGrid.getElementID('QuickPanelTableRow'))).appendTo(this._gridviewTableBody),n=0;n<f;n++)$("<td class='ListGrid-QPEmptyCell' aria-hidden='true'>&nbsp;</td>").appendTo(o);for(this.get__isQuickPanelVisible()&&(this._quickPanelContainerCell=$("<td class='ListGrid-GVQuickPanelCell'></td>").appendTo(o),$(String.format("<div id='{0}' class='ListGrid-QPContainer'></div>",this._parentListGrid.get_quickPanelContainerID())).appendTo(this._quickPanelContainerCell)),this._verticalBufferingTableRow=$(String.format("<tr id='{0}'></tr>",this._parentListGrid.getElementID('VerticalBufferRow'))).appendTo(this._gridviewTableBody),this._emptyMessageContainer=$(String.format("<td class='ListGrid-GVVerticalBufferCell' colspan='{0}'>&nbsp;</td>",f)).appendTo(this._verticalBufferingTableRow),a=$('<tfoot></tfoot>').appendTo(this._gridviewTableElement),this._gridviewFooterRow=$("<tr class='ListGrid-GVFooterRow'></tr>").appendTo(a),$("<td class='ListGrid-GVFooterCheckbox'>&nbsp;</td><td class='ListGrid-GVFooterSpacer'>&nbsp;</td>").appendTo(this._gridviewFooterRow),s=$(String.format("<td class='ListGrid-GVFooterPagingInfoLeft' colspan='{0}'></td>",h)).appendTo(this._gridviewFooterRow),this._pagingControlsPlaceHolder=$('<span>&nbsp;</span>').appendTo(s).hide(),this._pagingControlsContainer=$("<div class='ListGrid-GVFooterPagingContainer'></div>").appendTo(s).hide(),this._pagingIcons=new Array(this._pagingCallbacks.length),n=0;n<this._pagingCallbacks.length;n++)this._pagingIcons[n]=$("<a href='#' class='ListGrid-GVPagingIcons'></a>"),this._pagingIcons[n].click($.proxy(this._pagingCallbacks[n],this)),this._pagingIcons[n].appendTo(this._pagingControlsContainer);v=$("<td class='ListGrid-GVFooterPagingInfoRight'></td>").appendTo(this._gridviewFooterRow),this._pagingStatusContainer=$("<div class='ListGrid-GVFooterPagingContainer ListGrid-GVFooterPagingStatusContainer'></div>").appendTo(v),this._checkBoxColumnWidth=l.outerWidth(),this._update()},n.prototype.onCheckboxColumnHeaderClick=function(n){n.target.checked?this.selectAllRows():this.clearSelection()},n.prototype.addDataRow=function(n){var rt=this,f=$(String.format("<tr scope='row' item='{0}' class='ListGrid-GVDataRow'></tr>",escape(n.ID))).insertBefore(this._verticalBufferingTableRow),r,s,o,a,tt,it,e,l,b,c,g,ht;n.SelectDisabled||f.click($.proxy(this.onDataRowClicked,this)),f.mouseover($.proxy(this.onDataRowMouseOver,this)),f.mouseout($.proxy(this.onDataRowMouseOut,this)),f.get(0).setAttribute('onselectstart','new function() { return false; }');var p='Select item',nt=p,y={},d={},et={},ot={},ut={},st={};for(s=0;s<n.Properties.length;s++)r=n.Properties[s],y[r.Name]=r.Value||'',r.Tooltip&&r.Tooltip!=''&&(d[r.Name]=r.Tooltip),r.ImageSrc&&r.ImageSrc!=''&&(et[r.Name]=r.ImageSrc),r.Url&&r.Url!=''&&(ot[r.Name]=r.Url),r.OnClientClick&&r.OnClientClick!=''&&(ut[r.Name]=r.OnClientClick),r.OnAdd&&r.OnAdd!=''&&(st[r.Name]=r.OnAdd),r.Name=="DisplayName"&&(p=String.format('Select \x7b0\x7d',t(y[r.Name])),nt=p),r.Name=="DomainName"&&this._selectType=="radio"&&(p=String.format('Select domain',t(y[r.Name])),nt=String.format('Select domain \x7b0\x7d',t(y[r.Name])));for($(String.format("<td class='ListGrid-GVCheckboxCell'><input type='{3}' title='{0}' aria-label='{1}'{2}/></td>",p,nt,n.SelectDisabled?" disabled='disabled'":'',this._selectType)).appendTo(f),$("<td class='ListGrid-GVSpacerCell' aria-hidden='true'>&nbsp;</td>").appendTo(f),s=0;s<this._state.GridColumns.length;s++){var u=this._state.GridColumns[s],v=y[u.PropertyName],w=u.CssClass!=null?u.CssClass:'';if(v!=null){var h=null,ft=null,k='';u.NeedSetDir&&(k='Ltr'),o='',a='',u.IsImageColumn?(tt=et[u.PropertyName]||'',tt!=''&&(a=d[u.PropertyName]||'',o=String.format("<img src='{0}' alt='{1}' title='{2}' />",i(tt),a,a))):o=u.IsHtmlColumn?v:i(v),!u.OnLinkClick||!u.OnLinkClick.length?(e='',e=u.IsImageColumn?a:d[u.PropertyName]!=null?d[u.PropertyName]:u.Title!=null?u.Title:t(v),l=ot[u.PropertyName]||'',b=ut[u.PropertyName]||'',l!=''||b!=''?(h=$(String.format("<td class='ListGrid-GVDataCell {0} {2}' item='{1}' />",k,u.PropertyName,w)).appendTo(f),c=null,b!=''?(c=$(String.format("<a title='{3}' class='ms-fcl-tp' alt='{3}' href='{0}' onclientclick='{1}'>{2}</a>",l!=''?l:'#',b,o,e)),c.bind('click',function(n){rt._onLinkClick(n)})):c=$(String.format("<a title='{2}' class='ms-fcl-tp' alt='{2}' href='{0}'>{1}</a>",l,o,e)).click(function(n){n.stopPropagation()}),c.appendTo(h)):h=$(String.format("<td class='ListGrid-GVDataCell {0} {4}' title='{3}' item='{1}'>{2}</td>",k,u.PropertyName,o,e,w)).appendTo(f)):(h=$(String.format("<td class='ListGrid-GVDataCell {0} {2}' item='{1}' />",k,u.PropertyName,w)).appendTo(f),it=$(String.format("<a title='{0}' href='#' aria-label='{0}' class='ms-fcl-tp {3}' onclientclick='{1}'>{2}</a>",u.Title!=null?t(u.Title):t(v),u.OnLinkClick,o,w)).appendTo(h),it.bind('click',function(n){rt._onLinkClick(n)}),this._state.MultiSelectEnabled||it.focus($.proxy(this.onDataRowClicked,this))),ft=$("<td class='ListGrid-GVDataSpacerCell' aria-hidden='true'>&nbsp;</td>").appendTo(f),this.makeElementUnselectable(h.get(0)),this.makeElementUnselectable(ft.get(0)),g=st[u.PropertyName]||'',g!=''&&(ht=new Function(String.format("return {0}",g)),ht())}}},n.prototype.makeElementUnselectable=function(n){$.browser||e.SetBrowser(),$.browser.msie||$.browser.opera?n.setAttribute('unselectable','on'):$.browser.mozilla?$(n).css('-moz-user-select','none'):$(n).css('-webkit-user-select','none')},n.prototype.EnablePagingControl=function(n,t){for(var u=[1,2,4,8],r,i=0;i<u.length;i++)r=u[i],(n&r)===r&&this._enableSinglePagingControl(r,t)},n.prototype.onDataRowClicked=function(n){var r=$(n.target).parents('tr.ListGrid-GVDataRow').andSelf()[0],t=r.getAttribute('item').toString(),u=n.target.getAttribute('type'),s=$(n.target).children(":first").attr("type"),f=this._state.MultiSelectEnabled,h=u!=null&&u.toString()===this._selectType||s===this._selectType,i=this._gridviewTableBody.find('tr.ListGrid-GVDataRow').index(r),e,o;n.ctrlKey||n.shiftKey||h?f&&n.shiftKey?(e=Math.min(this._shiftSelectAnchorIndex,i),o=Math.max(this._shiftSelectAnchorIndex,i),n.ctrlKey||this.clearSelection(),this.selectRows(e,o)):(f?this._selectedItems[t]!==undefined?this.deselectRow(t):this.selectRow(t):this.selectRow(t),this._shiftSelectAnchorIndex=i):(this.clearSelection(),this.selectRow(t),this._shiftSelectAnchorIndex=i),n.stopPropagation()},n.prototype.onDataRowMouseOver=function(n){var t=$(n.target).parents('tr.ListGrid-GVDataRow').andSelf()[0],i=t.getAttribute('item').toString();this.highlightItemRow(i,!0)},n.prototype.onDataRowMouseOut=function(n){var i=$(n.target).parents('tr.ListGrid-GVDataRow').andSelf()[0],t=i.getAttribute('item').toString();this._selectedItems[t]!==undefined||this.highlightItemRow(t,!1)},n.prototype.selectRows=function(n,t){for(var r,i=n;i<t+1;i++)r=this._gridviewTableBody.find('tr.ListGrid-GVDataRow')[i].getAttribute('item'),this._selectRowInternal(r);this._onSelectionChanged()},n.prototype.selectRow=function(n){this._state.MultiSelectEnabled||this.clearSelection(),this._selectRowInternal(n),this._onSelectionChanged()},n.prototype.selectAllRows=function(){var t,i,n,r,u;this._state.SelectedItems.length=0,t=this._parentListGrid.get_CurrentData();for(i in t)n={key:i,value:t[i]},n.value.SelectDisabled||(this._selectedItems[n.key]=n.value,this._state.SelectedItems[this._state.SelectedItems.length]=n.key);r=this._gridviewTableBody.find('tr.ListGrid-GVDataRow'),u=r.find("td.ListGrid-GVCheckboxCell input[type='checkbox']:not([disabled])").attr('checked','true'),this.highlightRows(u,!0),this._onSelectionChanged()},n.prototype.highlightItemRow=function(n,t){var i=this._gridviewTableBody.find(String.format("tr.ListGrid-GVDataRow[item='{0}']",n));this.highlightRows(i,t)},n.prototype.highlightRows=function(n,t){t?(n.addClass('ListGrid-GVDataRowSelected ms-bgc-tlr'),n.find('a').addClass('ms-fcl-td')):(n.removeClass('ListGrid-GVDataRowSelected ms-bgc-tlr'),n.find('a').removeClass('ms-fcl-td'))},n.prototype.deselectRow=function(n){var t,i;delete this._selectedItems[n],t=this._state.SelectedItems.indexOf(n),t>=0&&this._state.SelectedItems.splice(t,1),i=this._gridviewTableBody.find(String.format("tr.ListGrid-GVDataRow[item='{0}']",n)),i.find(String.format("td.ListGrid-GVCheckboxCell input[type='{0}']",this._selectType)).removeAttr('checked'),this.highlightRows(i,!1),this._onSelectionChanged()},n.prototype.findCell=function(n,t){return n.find(String.format("td.ListGrid-GVDataCell[item='{0}']",t))},n.prototype.findRow=function(n){return this._gridviewTableBody.find(String.format("tr.ListGrid-GVDataRow[item='{0}']",n))},n.prototype.getAllCells=function(){return this._gridviewTableBody.find('td.ListGrid-GVDataCell')},n.prototype.clearSelection=function(){var t,n;for(t in this._selectedItems)delete this._selectedItems[t];this._state.SelectedItems.length=0,n=this._gridviewTableBody.find('tr.ListGrid-GVDataRow'),n.find(String.format("td.ListGrid-GVCheckboxCell input[type='{0}']",this._selectType)).removeAttr('checked'),this.highlightRows(n,!1),this._onSelectionChanged()},n.prototype.clearData=function(){this.clearSelection(),this._gridviewTableBody.find('tr.ListGrid-GVDataRow').remove(),this._shiftSelectAnchorIndex=0},n.prototype.OnDataChanged=function(){var f,u,t,r,h,e,o,s,c;if(this._state.FullDataSetAvailable?this._gridviewFooterRow.hide():this.InitializePaging(),this.InitializeSorting(),this._gridviewHeaderRow.find('span.ListGrid-SortArrowImage').remove(),this._parentListGrid.get_CurrentSort()!=null){if(f=this._gridviewHeaderRow.find(String.format("th[property='{0}']",this._parentListGrid.get_CurrentSort().SortProperty)),u=f.find('a'),u.length>0){t=u.get(0).innerHTML,r=u.attr(this._titleAttribute),t.indexOf("<span")>=0&&(t=t.substring(0,t.indexOf("<span")),r=r.substring(0,r.indexOf(",")));var l='\x7b0\x7d\x3cspan class\x3d\x22HiddenForScreenReader\x22 tabindex\x3d\x22-1\x22\x3e, sort descending\x3c\x2fspan\x3e',a='\x7b0\x7d\x3cspan class\x3d\x22HiddenForScreenReader\x22 tabindex\x3d\x22-1\x22\x3e, sort ascending\x3c\x2fspan\x3e',v=this._parentListGrid.get_CurrentSort().SortOrder?l:a;t=String.format(v,i(t));var y='\x7b0\x7d, sort descending',p='\x7b0\x7d, sort ascending',w=this._parentListGrid.get_CurrentSort().SortOrder?y:p;r=String.format(w,r),u.get(0).innerHTML=t,u.attr(this._titleAttribute,r)}h=this._parentListGrid.get_CurrentSort().SortOrder?'ArrowDown':'ArrowUp',e=$("<span class='ListGrid-SortArrowImage' />"),e.get(0).innerHTML=this._parentListGrid.getIconMarkup(h),e.appendTo(f)}this.get__isQuickPanelVisible()&&this._quickPanelContainerCell.get(0).setAttribute('rowSpan',this._gridviewTableBody.find('tr').length.toString()),this._emptyMessageContainer.children().remove(),this._update(),n._getKeyCount(this._parentListGrid.get_CurrentData())||(o=this._state.EmptyDataSetText,this._parentListGrid.get_CurrentFilter()!=null&&(s=this._parentListGrid.get_CurrentFilter().SearchText,s&&s.length&&(o=this._state.EmptySearchText)),c=String.format("<div id='{0}' class='ListGrid-GVEmptyMessageContainer'>{1}</div>",this._parentListGrid.getElementID('GridViewEmptyMessageContainer'),o),$(c).appendTo(this._emptyMessageContainer),this.EnablePagingControl(15,!1))},n.prototype.InitializeSorting=function(){for(var s=!!this._gridviewTableBody.find('tr.ListGrid-GVDataRow').length,n,t,u,r,e,o,f=0;f<this._state.GridColumns.length;f++)n=this._state.GridColumns[f],t=this._gridviewHeaderRow.find(String.format("th[property='{0}']",n.PropertyName)),s&&this._state.SortingEnabled&&n.Sortable?(t.find('span.ListGrid-GVDataHeaderText').remove(),u=i(n.DisplayName),r=t.find('a'),r.length?(r.attr(this._titleAttribute,u),r.get(0).innerHTML=u.toUpperCase()):(r=$(String.format("<a href='#' property='{0}' title='{1}' class='ms-fcl-ns'>{2}</a>",i(n.PropertyName),u,u.toUpperCase())).appendTo(t),r.click($.proxy(this._onChangeSort,this)))):(t.find('a').remove(),e=t.find('span.ListGrid-GVDataHeaderText'),e.length||(o=String.format("<span class='ListGrid-GVDataHeaderText' property='{0}'>{1}</span>",i(n.PropertyName),i(n.DisplayName.toUpperCase())),e=$(o).appendTo(t)))},n.prototype.InitializePaging=function(){if(this._parentListGrid.get_CurrentPaging()!=null&&this._parentListGrid.get_CurrentPaging().Context!=null)if(this._gridviewFooterRow.show(),this.EnablePagingControl(3,!this._parentListGrid.get_CurrentPaging().Context.BeginningOfData),this.EnablePagingControl(12,!this._parentListGrid.get_CurrentPaging().Context.EndOfData),this._parentListGrid.get_CurrentPaging().Context.BeginningOfData&&this._parentListGrid.get_CurrentPaging().Context.EndOfData?(this._pagingControlsContainer.hide(),this._pagingControlsPlaceHolder.show()):(this._pagingControlsPlaceHolder.hide(),this._pagingControlsContainer.show()),this._parentListGrid.get_CurrentPaging().Context.Range!=null){var n=String.format('{0}-{1} of {2} items',this._parentListGrid.get_CurrentPaging().Context.Range.RangeStart,this._parentListGrid.get_CurrentPaging().Context.Range.RangeEnd,this._parentListGrid.get_CurrentPaging().Context.Range.TotalItems);this._pagingStatusContainer.text(n)}else this._pagingStatusContainer.text('');else this._gridviewFooterRow.hide()},n.prototype._update=function(){var r,t,i;this.get__isQuickPanelVisible()&&(n._getKeyCount(this._selectedItems)>0?(this._quickPanelContainerCell.addClass('ListGrid-GVQuickPanelCellVisible'),this._quickPanelContainerCell.attr('aria-hidden','false')):(this._quickPanelContainerCell.removeClass('ListGrid-GVQuickPanelCellVisible'),this._quickPanelContainerCell.attr('aria-hidden','true'))),this._showCheckboxColumn(n._getKeyCount(this._parentListGrid.get_CurrentData())>0),r=n._getKeyCount(this._selectedItems)===n._getKeyCount(this._parentListGrid.get_CurrentData()),this._setColumnHeaderCheckbox(r),this._parentListGrid.get_listGridContainerElement().css('margin-left',n._getKeyCount(this._parentListGrid.get_CurrentData())>0?'0px':-1*this._checkBoxColumnWidth+'px'),this._verticalBufferingTableRow.find('td').height(0),t=this.get__isQuickPanelVisible()?this._quickPanelContainerCell.height():0,i=$('tr.ListGrid-GVDataRow').length*34,t>i&&this._verticalBufferingTableRow.find('td').height(t-i),PageLayout.ResizePanels()},n.prototype._onSelectionChanged=function(){this._notifySelectionChanged(this._selectedItems),this._update(),$.browser||e.SetBrowser(),$.browser.msie&&$.browser.version[0]=='8'&&(this._gridviewTableElement.get(0).className=this._gridviewTableElement.get(0).className)},n.prototype._selectRowInternal=function(n){var t=this._gridviewTableBody.find(String.format("tr.ListGrid-GVDataRow[item='{0}']",n));t.find(String.format("td.ListGrid-GVCheckboxCell input[type='{0}']",this._selectType)).get(0).checked=!0,this.highlightRows(t,!0),this._selectedItems[n]=this._parentListGrid.get_CurrentData()[n],this._state.SelectedItems[this._state.SelectedItems.length]=n},n.prototype._showCheckboxColumn=function(n){var t=this._state.MultiSelectEnabled,i=this._state.ShowRadioButtonColumnInSingleSelectionMode;this._gridviewTableElement.find('tr').each(function(r,u){var f=$(u).find(String.format("input[type='{0}']",t?"checkbox":"radio"));return n&&(t||i)?f.show():f.hide(),$(u)}),this._showColumnHeaderCheckbox(n&&t)},n.prototype._setColumnHeaderCheckbox=function(n){var t=this._getColumnHeaderCheckbox();t.checked=n},n.prototype._showColumnHeaderCheckbox=function(n){var t=this._getColumnHeaderCheckbox();t.style.display=n?'block':'none'},n.prototype._getColumnHeaderCheckbox=function(){return this._gridviewTableElement.find(String.format('input#{0}',this._parentListGrid.getElementID('SelectAllCheckbox'))).get(0)},n.prototype._enableSinglePagingControl=function(n,t){var i=null,r='FirstPageButton';switch(n){case 1:i=this._pagingIcons[0],r=t?'FirstPageButton':'FirstPageButtonDisabled';break;case 2:i=this._pagingIcons[1],r=t?'PreviousPageButton':'PreviousPageButtonDisabled';break;case 4:i=this._pagingIcons[2],r=t?'NextPageButton':'NextPageButtonDisabled';break;case 8:i=this._pagingIcons[3],r=t?'LastPageButton':'LastPageButtonDisabled'}i!=null&&(i.get(0).innerHTML=this._parentListGrid.getIconMarkup(r),i.get(0).setAttribute(this._titleAttribute,this._parentListGrid.getIconTitle(r)),t?(i.get(0).style.cursor='pointer',i.get(0).removeAttribute('disabled'),i.get(0).removeAttribute('tabindex')):(i.get(0).style.cursor='default',i.get(0).setAttribute('disabled','true'),i.get(0).setAttribute('tabindex','-1')))},n.prototype._onChangeSort=function(n){var t=n.target.getAttribute('property'),i,r;!this._state.OnSort||!this._state.OnSort.length?(this.sort(t,''),n.stopPropagation(),n.preventDefault()):(i=new Function(String.format("return {0}('{1}')",this._state.OnSort,t)),r=i(),r||n.stopPropagation())},n.prototype._onFirstPageClicked=function(n){this._parentListGrid.get_CurrentPaging().Context.BeginningOfData||(this._state.FullDataSetAvailable?this._onClientNavigatePage(1,n):this._onNavigatePage(1)),n.preventDefault()},n.prototype._onPreviousPageClicked=function(n){this._parentListGrid.get_CurrentPaging().Context.BeginningOfData||(this._state.FullDataSetAvailable?this._onClientNavigatePage(2,n):this._onNavigatePage(2)),n.preventDefault()},n.prototype._onNextPageClicked=function(n){this._parentListGrid.get_CurrentPaging().Context.EndOfData||(this._state.FullDataSetAvailable?this._onClientNavigatePage(4,n):this._onNavigatePage(4)),n.preventDefault()},n.prototype._onLastPageClicked=function(n){this._parentListGrid.get_CurrentPaging().Context.EndOfData||(this._state.FullDataSetAvailable?this._onClientNavigatePage(8,n):this._onNavigatePage(8)),n.preventDefault()},n.prototype._onNavigatePage=function(n){this._parentListGrid.UpdateData(this._parentListGrid.get_CurrentPaging().Context.ContextDetails,null,n,null)},n.prototype._onClientNavigatePage=function(n,t){if(!(!this._state.OnPage||!this._state.OnPage.length)){var i=new Function(String.format("return {0}({1})",this._state.OnPage,n)),r=i();r||t.stopPropagation()}},n.prototype._onLinkClick=function(n){var t=n.target.getAttribute('onclientclick');if(!(!t||!t.length)){var i=$(n.target).parents('tr.ListGrid-GVDataRow').andSelf()[0],r=i.getAttribute('item').toString(),u=String.format("['{0}']",r),f=new Function(String.format('return {0}({1})',t,u)),e=f();e||(n.stopPropagation(),n.preventDefault())}},n._getKeyCount=function(n){var t=0,i;for(i in n)t++;return t},n.prototype.sort=function(n,t){var i={SortProperty:n,SortOrder:0};this._parentListGrid.get_CurrentSort()==null||this._parentListGrid.get_CurrentSort().SortProperty!==n||this._parentListGrid.get_CurrentSort().SortOrder||(i.SortOrder=1),this._parentListGrid.UpdateData(t,i,1,null)},n}(),n.GridViewComponent=r,e=function(){function n(){}return n.GetUaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}},n.SetBrowser=function(){var t=this.GetUaMatch(navigator.userAgent),n={webkit:null,safari:null,opera:null,msie:null,mozilla:null,chrome:null,version:null};t.browser&&(n[t.browser]=!0,n.version=t.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),$.browser=n},n}()})(t=n.JS||(n.JS={}))}(BOX||(BOX={})),ListGrid=function(){function n(t,i){var u,r;for(this._id=null,this._state=null,this._listGridContainerElement=null,this._iconContainer=null,this._statePipeline=null,this._fetchDataCallback=null,this.LastDataFetchReturnCode=0,this.ActionBar=null,this.GridView=null,this.QuickPanel=null,this._currentDataSet=[],this._currentDataSetByID={},this._fullDataSet=[],this._id=t,this._statePipeline=$('#'+i),u=this._statePipeline.val(),this._state=typeof u!='undefined'&&u!=null?n._jsonDeserialize(u):new BOX.JS.ListGridState,this._listGridContainerElement=$('#'+t),this._listGridContainerElement==null&&(this._listGridContainerElement=$(String.format("<div id='{0}'></div>",t)),this._listGridContainerElement.appendTo($(document))),this._iconContainer=this._listGridContainerElement.find('div#'+this._state.IconContainerID),this.ActionBar=new BOX.JS.ActionBarComponent(this,this._state.ActionBar),this.GridView=new BOX.JS.GridViewComponent(this,this._state.GridView,$.proxy(this._onSelectionChanged,this)),this.QuickPanel=new BOX.JS.QuickPanelComponent(this,this._state.QuickPanel),this._fetchDataCallback=typeof this._state.BeginFetchData!='undefined'&&!!this._state.BeginFetchData&&typeof this._state.EndFetchData!='undefined'&&!!this._state.EndFetchData?this._onFetchData:null,r=this._listGridContainerElement.parent();r!=null&&r.get(0).tagName.toLowerCase()!=='form';)r=r.parent();r!=null&&r.submit($.proxy(this._onFormSubmit,this))}return n.prototype.get_listGridContainerElement=function(){return this._listGridContainerElement},n.prototype.get_quickPanelContainerID=function(){return this.getElementID('QuickPanelContainer')},n.prototype.get_CurrentFilter=function(){return this._state.CurrentFilter},n.prototype.get_CurrentSort=function(){return this._state.CurrentSort},n.prototype.set_CurrentSort=function(n){this._state.CurrentSort==null?this._state.CurrentSort={SortProperty:n,SortOrder:0}:this._state.CurrentSort.SortProperty==n?this._state.CurrentSort.SortOrder=this._state.CurrentSort.SortOrder==0?1:0:(this._state.CurrentSort.SortProperty=n,this._state.CurrentSort.SortOrder=0)},n.prototype.get_CurrentPaging=function(){return this._state.CurrentPagingInfo},n.prototype.get_CurrentContext=function(){return this._state.CurrentContext},n.prototype.SetInitialDataFetchResponse=function(t){var i=n._jsonDeserialize(t);this._onFetchDataComplete(i)},n.prototype.get_CurrentData=function(){return this._currentDataSetByID},n.prototype.get_FullDataSet=function(){return this._fullDataSet},n.prototype.set_FullDataSet=function(n){this._fullDataSet=n},n.prototype.UpdateData=function(n,t,i,r){n==null&&this._state.CurrentPagingInfo.Context!=null&&(n=this._state.CurrentPagingInfo.Context.ContextDetails),t==null&&(t=this._state.CurrentSort),i||(i=this._state.CurrentPagingInfo.NavigateDetails),r==null&&(r=this._state.CurrentFilter),this._fetchDataCallback(n,t,i,r,$.proxy(this._onFetchDataComplete,this),$.proxy(this._onFetchDataComplete,this))},n.prototype.SetPagingState=function(n,t,i,r,u){typeof this._state.CurrentPagingInfo=='undefined'||this._state.CurrentPagingInfo==null||this._state.CurrentPagingInfo.Context==null||this._state.CurrentPagingInfo.Context.Range==null?this._state.CurrentPagingInfo={NavigateDetails:0,Context:{BeginningOfData:n,EndOfData:t,Range:{RangeStart:i,RangeEnd:r,TotalItems:u},ContextDetails:''}}:(this._state.CurrentPagingInfo.Context.BeginningOfData=n,this._state.CurrentPagingInfo.Context.EndOfData=t,this._state.CurrentPagingInfo.Context.Range.RangeStart=i,this._state.CurrentPagingInfo.Context.Range.RangeEnd=r,this._state.CurrentPagingInfo.Context.Range.TotalItems=u)},n.prototype.Refresh=function(){var n=null;this._state.LastDataContext==null||!this._state.LastDataContext.ContextDetails||!this._state.LastDataContext.ContextDetails.length||(n=this._state.LastDataContext.ContextDetails),this.UpdateData(n,null,0,null)},n.prototype.getElementID=function(n){return this._id+'_'+n},n.prototype.getIconMarkup=function(n){var i=null,t=this._iconContainer.find(String.format("div[icontype='{0}']",n));return t!=null&&t.length>0&&(i=t.get(0).innerHTML),i},n.prototype.getIconTitle=function(n){var i='',t=this._iconContainer.find(String.format("div[icontype='{0}']",n));return t!=null&&t.length>0?t.find('img').attr('title'):i},n.prototype._initialRender=function(){if(this.ActionBar.initialRender(),this.GridView.initialRender(),this.QuickPanel.initialRender(),!this._state.InitialDataFetchMode&&this._fetchDataCallback!=null){var n=this._state.CurrentPagingInfo!=null?this._state.CurrentPagingInfo.NavigateDetails:1;this._fetchDataCallback(this._state.CurrentContext,this._state.CurrentSort,n,this._state.CurrentFilter,$.proxy(this._onFetchDataComplete,this),$.proxy(this._onFetchDataComplete,this))}this._onInitialRenderComplete()},n.prototype._onFormSubmit=function(){this._statePipeline.val(n._jsonSerialize(this._state))},n.prototype._onFetchData=function(t,i,r,u,f,e){if(typeof this._state.OnBeginFetchData!='undefined'&&this._state.OnBeginFetchData!=null){var o=new Function(String.format('{0}()',this._state.OnBeginFetchData));o()}Microsoft.Online.BOX.UI.WebControls.ListGrid.GenericFetchData(this._state.BeginFetchData,this._state.EndFetchData,t,n._jsonSerialize(i),n._jsonSerialize(r),n._jsonSerialize(u),f,e)},n.prototype._onFetchDataComplete=function(n){var e,o,s,r,t,u,f,i;n.Sort!=null&&(n.Sort.SortOrder=parseInt(n.Sort.SortOrder)),n.Paging!=null&&(n.Paging.NavigateDetails=parseInt(n.Paging.NavigateDetails),n.Paging.Context!=null&&(n.Paging.Context.BeginningOfData=n.Paging.Context.BeginningOfData.toString()==='1'||n.Paging.Context.BeginningOfData.toString()==='true',n.Paging.Context.EndOfData=n.Paging.Context.EndOfData.toString()==='1'||n.Paging.Context.EndOfData.toString()==='true')),this.LastDataFetchReturnCode=n.ReturnCode,this._state.LastDataContext=n.Paging.NavigateDetails===2||n.Paging.NavigateDetails===4?this._state.CurrentPagingInfo!=null?this._state.CurrentPagingInfo.Context:null:n.Paging.Context,this._state.CurrentSort=n.Sort,this._state.CurrentPagingInfo=n.Paging,this._state.CurrentFilter=n.Filter,this._state.CurrentContext=n.Context,this._currentDataSet.length=0,this._state.GridView.FullDataSetAvailable&&(this._state.GridView.SortingEnabled=!1,this.ActionBar.displaySearchControl(!1),this.ActionBar.displayAddButton(!1),e=n.Items.length<=this._state.GridView.PageSize,o=e?n.Items.length:this._state.GridView.PageSize,this.SetPagingState(!0,e,1,o,n.Items.length)),this._state.GridView.FullDataSetAvailable&&(this._fullDataSet.length=0);for(s in this._currentDataSetByID)delete this._currentDataSetByID[s];for(r=0;r<n.Items.length;r++){for(t=n.Items[r],this._state.GridView.FullDataSetAvailable?(this._fullDataSet[this._fullDataSet.length]=t,r<this._state.GridView.PageSize&&(this._currentDataSet[this._currentDataSet.length]=t)):this._currentDataSet[this._currentDataSet.length]=t,this._currentDataSetByID[t.ID]=t,t.SelectDisabled=t.SelectDisabled.toString()==='1'||t.SelectDisabled.toString()==='true',t.DeleteDisabled=t.DeleteDisabled.toString()==='1'||t.DeleteDisabled.toString()==='true',t.EditDisabled=t.EditDisabled.toString()==='1'||t.EditDisabled.toString()==='true',u=0;u<t.QuickPanelQuickLinks.length;u++)i=t.QuickPanelQuickLinks[u],i.Enabled=i.Enabled.toString()==='1'||i.Enabled.toString()==='true',i.HiddenForMultipleUsers=i.HiddenForMultipleUsers.toString()==='1'||i.HiddenForMultipleUsers.toString()==='true';for(f=0;f<t.QuickPanelRelatedLinks.length;f++)i=t.QuickPanelRelatedLinks[f],i.Enabled=i.Enabled.toString()==='1'||i.Enabled.toString()==='true'}this._onDataChanged()},n.prototype._onDataChanged=function(){var n,r,t,i;for(this.GridView.clearData(),n=0;n<this._currentDataSet.length;n++)r=this._currentDataSet[n],this.GridView.addDataRow(r);this.GridView.OnDataChanged(),t=this.ActionBar.GetState().OnFilterCompleted,this.get_CurrentFilter()==null||!t||!t.length||(i=new Function(String.format('{0}()',t)),i()),this.get_CurrentFilter()!=null&&this.ActionBar.focusFilterCloseButton(),!this._state.OnFetchDataCompleted||!this._state.OnFetchDataCompleted.length||(i=new Function(String.format('{0}()',this._state.OnFetchDataCompleted)),i())},n.prototype._onSelectionChanged=function(n){if(this.QuickPanel.showItems(n),!(!this._state.OnSelectionChanged||!this._state.OnSelectionChanged.length)){var t=new Function("currentSelection",String.format('{0}(currentSelection)',this._state.OnSelectionChanged));t(n)}},n.prototype._onInitialRenderComplete=function(){if(typeof this._state.OnListGridInit!='undefined'&&!(!this._state.OnListGridInit||!this._state.OnListGridInit.length)){var n=new Function(this._state.OnListGridInit);n()}},n._jsonSerialize=function(n){return Sys.Serialization.JavaScriptSerializer.serialize(n)},n._jsonDeserialize=function(n){return Sys.Serialization.JavaScriptSerializer.deserialize(n)},n.CreateInstance=function(t,i){var r=new n(t,i);return r._initialRender(),n.ListGridCollection[t]=r,r},n.ListGridCollection={},n}()