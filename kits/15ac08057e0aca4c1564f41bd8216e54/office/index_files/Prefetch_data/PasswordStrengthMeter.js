var PasswordStrengthMeter=function(){function n(n,t,i){(this.PasswordMeterDiv=document.getElementById(n+"_passwordStrengthMeter"),this.PasswordStrengthMeterId=n,this.PasswordTextBox=document.getElementById(t),this.PasswordTextBox!=null)&&(this.PropertySheetId=i,this.PasswordTextBox.PasswordStrengthManager=this,this.PasswordTextBox.onchange=this.TextChangedHandler,this.PasswordTextBox.onkeyup=this.TextChangedHandler,this.PasswordTextBox.PasswordStrengthManager.EvaluatePassword(!1),this.PasswordStrengthMeterDisplayed=!1)}return n.prototype.EvaluatePassword=function(t){var i='weak',r;this.SetMeterLevel(this.PasswordStrengthMeterId,n.METERLEVEL_URGENT),r=this.PasswordTextBox.value,n.ClientSideStrongPassword(r)?(i='strong',this.SetMeterLevel(this.PasswordStrengthMeterId,n.METERLEVEL_HEALTHY)):n.ClientSideMediumPassword(r)?(i='medium',this.SetMeterLevel(this.PasswordStrengthMeterId,n.METERLEVEL_CAUTION)):n.ClientSideWeakPassword(r)&&(i='weak'),this.PasswordMeterDiv.innerText=i,this.PropertySheetId!=''&&t&&(PropertySheet.ShowRow(this.PropertySheetId),this.PasswordStrengthMeterDisplayed||(window.PageLayout.ResizePanels(),this.PasswordStrengthMeterDisplayed=!0))},n.prototype.SetMeterLevel=function(t,i){if(this.PasswordMeterDiv!=null&&i!=null){switch(i){case n.METERLEVEL_URGENT:this.PasswordMeterDiv.className="o365-err-c";break;case n.METERLEVEL_CAUTION:this.PasswordMeterDiv.className="o365-wrn-c";break;case n.METERLEVEL_HEALTHY:this.PasswordMeterDiv.className="o365-succ-c"}var r=document.getElementById(t+n.METERLEVEL_CONTROLSUFFIX);r!=null&&(r.value=i)}},n.prototype.TextChangedHandler=function(){var n=this.PasswordStrengthManager;typeof this.PasswordStrengthManager!='undefined'&&n.EvaluatePassword(!0)},n.ClientSideStrongPassword=function(t){return n.IsLongEnough(t,8)&&n.SpansEnoughCharacterSets(t,3)},n.ClientSideMediumPassword=function(t){return n.IsLongEnough(t,8)&&n.SpansEnoughCharacterSets(t,2)},n.ClientSideWeakPassword=function(t){return n.IsLongEnough(t,8)},n.IsLongEnough=function(n,t){return n==null||isNaN(t)?!1:n.length<t?!1:!0},n.SpansEnoughCharacterSets=function(t,i){var e=0,u=[n.CharacterSetChecks("kCapitalLetter",!1),n.CharacterSetChecks("kSmallLetter",!1),n.CharacterSetChecks("kDigit",!1),n.CharacterSetChecks("kPunctuation",!1)],r,f;if(t==null||isNaN(i))return!1;for(f=0;f<t.length;f++)for(r=0;r<u.length;r++)if(!u[r].fResult&&n.isctype(t.charAt(f),u[r].type)){u[r].fResult=!0;break}for(r=0;r<u.length;r++)u[r].fResult&&e++;return e<i?!1:!0},n.isctype=function(t,i){var r=!1;switch(i){case"kCapitalLetter":t>='A'&&t<='Z'&&(r=!0);break;case"kSmallLetter":t>='a'&&t<='z'&&(r=!0);break;case"kDigit":t>='0'&&t<='9'&&(r=!0);break;case"kPunctuation":"!@#$%^&*()_+-='\";:[{]}\\|.>,</?`~".indexOf(t)>=0&&(r=!0);break;case"kAlpha":(n.isctype(t,'kCapitalLetter')||n.isctype(t,'kSmallLetter'))&&(r=!0)}return r},n.METERLEVEL_HEALTHY="Healthy",n.METERLEVEL_CAUTION="Caution",n.METERLEVEL_URGENT="Urgent",n.METERLEVEL_CONTROLSUFFIX="_MeterLevel",n.CharacterSetChecks=function(n,t){return{type:n,fResult:t}},n}()