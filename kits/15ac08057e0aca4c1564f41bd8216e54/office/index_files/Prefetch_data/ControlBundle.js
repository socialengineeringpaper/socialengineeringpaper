var TextBox=window.TextBox||function(){var r=function(i){var u=t(i),r=n(i),f=i.value;return r&&f.length-u.length>=r?!1:!0},u=function(t){var i=n(t);return i?!1:!0},f=function(r){var u;if(window.clipboardData&&(u=n(r),u)){var f=r.value,e=t(r),o=u-f.length+e.length,s=window.clipboardData.getData("Text").substr(0,o);return i(r,s),!1}return!0},e=function(t){var i=n(t),r=t.value;i&&r.length>i&&(t.value=r.substring(0,i))},n=function(n){var t=n.attributes.multilineMaxLength;return t?parseInt(t.value):null},t=function(n){var t,i;return n.document?(i=n.document.selection.createRange(),t=i.text):t=n.value.substring(n.selectionStart,n.selectionEnd),t},i=function(n,t){var r,i;n.document?(i=n.document.selection.createRange(),i.text=t):n.value=n.value.substring(0,n.selectionStart)+t+n.value.substring(n.selectionEnd)};return{OnKeypressHandler:r,OnBeforePasteHandler:u,OnPasteHandler:f,OnBlurHandler:e,GetMultilineMaxLength:n,GetSelectedText:t,SetSelectedText:i}}();var HelpCallout=window.HelpCallout||function(){var t=!1,o="_help",s="_helpMessage",h="_helpLink",c=[],l=!1,i=function(t){var i=t.target.helpPanelID;n(i)},r=function(){var u=Sys.Application.getComponents(),a=!1,i,n,w,e,t;if(Shared.IsTextRightToLeft)switch(this._position){case Sys.Extended.UI.PopupControlPopupPosition.Right:this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Right);break;case Sys.Extended.UI.PopupControlPopupPosition.Left:this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Left);break;case Sys.Extended.UI.PopupControlPopupPosition.Top:this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Top);break;case Sys.Extended.UI.PopupControlPopupPosition.Bottom:this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Bottom)}for(n=0;n<u.length;n++)if(u[n].get_name&&u[n].get_name()=="ValidatorCalloutBehavior"&&u[n].get_isOpen()){a=!0;break}if(!a){var r=document.getElementById(this.get_element().id+o),c=document.getElementById(this.get_element().id+s),v=document.getElementById(this.get_element().id+h),f="",l="",y="300px",p=!1;for(r!=null&&(c!=null&&(f=c.innerHTML,l=c.innerText),v!=null&&(f=f+"<br /><br />"+v.innerHTML),r.style.width!=null&&r.style.width!=""&&(y=r.style.width),r.getAttribute("hideCloseButton")=="true"&&(p=!0)),this._popupElement.style.width=y,i=this._popupElement.getElementsByTagName("td"),n=0;n<i.length;n++)i[n].className.indexOf("ErrorMessage")>=0&&(i[n].innerHTML=f);for(n=0;n<i.length;n++)i[n].className==="Close"&&i[n].firstChild&&(i[n].firstChild.style.display=p?"none":"block");this._element.hideTitle||(this._element.title=this._element.originalTitle?this._element.originalTitle+" \n"+l:l),w=this._popupBehavior._verifyPosition,e=!0,this._popupBehavior._verifyPosition=function(n,t){var r=n,i=w.call(this,n,t);return(n.x!=i.x||n.y!=i.y)&&(e=!1),i},this.oldShowPopup(),Shared.IsTextRightToLeft&&(t=this._popupElement.style.left,HelpCallout.IsGeminiUI?(this._position==Sys.Extended.UI.PopupControlPopupPosition.Right||this._position==Sys.Extended.UI.PopupControlPopupPosition.Left)&&(this._popupElement.style.left=e?parseInt(t.substring(0,t.length-2))+this._element.offsetWidth+"px":parseInt(t.substring(0,t.length-2))-this._popupElement.offsetWidth+"px"):(this._position==Sys.Extended.UI.PopupControlPopupPosition.Right||this._position==Sys.Extended.UI.PopupControlPopupPosition.Left)&&(this._popupElement.style.left=e?parseInt(t.substring(0,t.length-2))+this._element.offsetWidth+"px":parseInt(t.substring(0,t.length-2))-this._element.offsetWidth+"px"))}},u=function(){this._element.title=this._element.originalTitle,this.oldHidePopup()},n=function(n){for(var i=Sys.Application.getComponents(),t=0;t<i.length;t++)i[t]._popupControlID&&i[t]._popupControlID==n&&i[t].hidePopup()},a=function(){for(var i=["Right","Left","Bottom","Top","Center"],n,t=0;t<i.length;t++)n=document.getElementById('HelpCallout'+i[t]),n&&(n.parentNode.removeChild(n),document.body.appendChild(n))},f=function(){var e,f,n;if(!t){for(e=Sys.Application.getComponents(),f=0;f<e.length;f++)n=e[f],n.get_name&&n.get_name()=="PopupControlBehavior"&&(Sys.UI.DomEvent.addHandler(n._element,"blur",i),Sys.UI.DomEvent.addHandler(n._element,"mouseover",function(){this.hideTitle=!0}),Sys.UI.DomEvent.addHandler(n._element,"mouseout",function(){this.hideTitle=!1}),n._element.helpPanelID=n._popupControlID,n._element.originalTitle=n._element.title,n.oldShowPopup=n.showPopup,n.showPopup=r,n.oldHidePopup=n.hidePopup,n.hidePopup=u);t=!0}},v=function(t,i){Sys.Application.add_load(function(){var r=$("#"+t),f=$("#"+i),u;r.mouseenter(function(){u&&clearTimeout(u),r.hideTitle=!0,e(t)}),r.mouseleave(function(){u=window.setTimeout(function(){r.hideTitle=!1,n(i)},1e3)}),-1===$.inArray(i,HelpCallout.InitializedHelpCalloutIds)&&(f.mouseenter(function(){u&&clearTimeout(u)}),f.mouseleave(function(){r.hideTitle=!1,n(i)}),HelpCallout.InitializedHelpCalloutIds.push(HelpCallout.InitializedHelpCalloutIds))})},e=function(n){var i,t;for(f(),i=Sys.Application.getComponents(),t=0;t<i.length;t++)if(i[t].get_name&&i[t].get_name()=="PopupControlBehavior"&&i[t]._element.id===n){i[t].showPopup();break}};return{CloseOnBlur:i,ShowPopup:r,HidePopup:u,Close:n,PreInitialize:a,Initialize:f,InitializePopupOnHover:v,TriggerFlyout:e,InitializedHelpCalloutIds:c,IsGeminiUI:l}}();var Button={};Button.ActiveButton=null,Button.FocusButton=null,Button.DefaultButton=null,Button.CancelButton=null,Button.ActivatedButtonID=null,Button.Groups={},Button.SetText=function(n,t){var f=document.getElementById(n),u,i,r;if(f!=null)for(i=0;i<f.children.length;i++)if(r=f.children[i],r.tagName.toLowerCase()=='span'){r.innerHTML=t;break}if(u=document.getElementById(n+'_disabled'),u!=null)for(i=0;i<u.children.length;i++)if(r=u.children[i],r.tagName.toLowerCase()=='span'){r.innerHTML=t;break}Button.ResizeButtons()},Button.Click=function(n){var t=document.getElementById(n);t!=null&&Button.SimulateClick(t)},Button.IsEnabled=function(n){var t=document.getElementById(n);return t.style.display!='none'},Button.Enable=function(n){var t=document.getElementById(n),i=document.getElementById(n+'_disabled');t!=null&&i!=null&&(t.disable=!1,(t.style.display=='inline-block'||i.style.display=='inline-block')&&(i.style.display='none',t.style.display='inline-block'))},Button.Disable=function(n){var t=document.getElementById(n),i=document.getElementById(n+'_disabled');t!=null&&i!=null&&((t.style.display=='inline-block'||i.style.display=='inline-block')&&(t.style.display='none',i.style.display='inline-block'),t.disable=!0)},Button.SetEnabled=function(n,t){(t?Button.Enable:Button.Disable)(n)},Button.Show=function(n){var t=document.getElementById(n),i=document.getElementById(n+'_disabled');t!=null&&i!=null&&(t.disable?(t.style.display='none',t.style.visibility='visible',i.style.visibility='visible',i.style.display='inline-block'):(i.style.display='none',i.style.visibility='visible',t.style.visibility='visible',t.style.display='inline-block'))},Button.Hide=function(n,t){var i=document.getElementById(n),r=document.getElementById(n+'_disabled');i!=null&&r!=null&&(t?(r.style.display='none',r.style.visibility='hidden',i.style.display='inline-block',i.style.visibility='hidden'):(r.style.display='none',i.style.display='none'))},Button.AddGroup=function(n,t){var i=Button.Groups[t];i?i[i.length]=n:Button.Groups[t]=[n]},Button.ResizeButtons=function(){var t,r,u,n,f,i;for(groupName in Button.Groups)if(t=Button.Groups[groupName],t){for(r=0,n=0;n<t.length;n++)i=document.getElementById(t[n]),i!=null&&(u=Button.GetWidth(i),u>r&&(r=u));for(n=0;n<t.length;n++)f=document.getElementById(t[n]+'_disabled'),f!=null&&(f.style.width=r+'px'),i=document.getElementById(t[n]),i!=null&&(i.style.width=r+1+'px')}},Button.GetWidth=function(n){var r=0,t,i;return n.style.width='auto',n.style.display=='none'||n.clientWidth==0?(t=n.cloneNode(!0),t.style.position='absolute',t.style.left='-10000px',t.style.display='inline-block',i=document.body.appendChild(t),r=i.clientWidth,i.style.display='none',document.body.removeChild(i)):r=n.clientWidth,r},Button.MouseOver=function(n){Button.ActiveButton==n?Button.SetActiveState(n):Button.SetHoverState(n)},Button.MouseOut=function(n){Button.FocusButton==n||Button.FocusButton==null&&Button.DefaultButton==n?Button.SetFocusedState(n):Button.SetRestState(n)},Button.MouseDown=function(n){Button.ActiveButton=n,Button.SetActiveState(n)},Button.Focus=function(n){Button.FocusButton=n,Button.ActiveButton==n?Button.SetActiveState(n):Button.SetFocusedState(n)},Button.Blur=function(n){Button.FocusButton=null,Button.SetRestState(n),Button.DefaultButton!=null&&Button.DefaultButton!=''&&Button.SetFocusedState(Button.DefaultButton)},Button.MouseUp=function(){Button.ActiveButton!=null&&(Button.SetFocusedState(Button.ActiveButton),Button.ActiveButton=null)},Button.AttachDefaultButtonHandlers=function(){var t,n;for(Button.AddHandler(window.document.getElementsByTagName('a')),Button.AddHandler(window.document.getElementsByTagName('textarea')),Button.AddHandler(window.document.getElementsByTagName('select')),Button.AddHandler(window.document.getElementsByTagName('input')),t=window.document.getElementsByTagName('form'),n=0;n<t.length;n++)$addHandler(t[n],'keypress',Button.SuppressionDefaultKeyHandling)},Button.AddHandler=function(n){for(var t=0;t<n.length;t++)$addHandler(n[t],'blur',Button.OnBlurEnableDefaultButtonHandler),$addHandler(n[t],'focus',Button.OnFocusDisableDefaultButtonHandler)},Button.OnBlurEnableDefaultButtonHandler=function(){Button.DefaultButton!=null&&Button.DefaultButton!=''&&Button.SetFocusedState(Button.DefaultButton)},Button.OnFocusDisableDefaultButtonHandler=function(n){n.target.getAttribute('data-ignoreDefaultButton')==='true'||n.target.tagName.toLowerCase()!='input'?Button.DefaultButton!=null&&Button.DefaultButton!=n.target.id&&Button.SetRestState(Button.DefaultButton):Button.SetFocusedState(Button.DefaultButton)},Button.DefaultButtonKeyDownHandler=function(n){var r=n.target||n.srcElement,t=r.tagName,i=r.getAttribute('data-ignoreDefaultButton');return(n.charCode==13||n.keyCode==13)&&Button.DefaultButton!=null&&Button.DefaultButton!=''&&t.toUpperCase()!='A'&&t.toUpperCase()!='TEXTAREA'&&t.toUpperCase()!='SELECT'&&(!i||i&&i==='true')&&(Button.ActivatedButtonID=Button.DefaultButton),(n.charCode==27||n.keyCode==27)&&Button.CancelButton!=null&&Button.CancelButton!=''&&t.toUpperCase()!='SELECT'&&(Button.ActivatedButtonID=Button.CancelButton),!0},Button.DefaultButtonKeyUpHandler=function(){if(Button.ActivatedButtonID!=null){var t=document.getElementById(Button.ActivatedButtonID);Button.ActivatedButtonID=null,t!=null&&t.style.display.toLowerCase()!='none'&&Button.SimulateClick(t)}return!0},Button.SuppressionDefaultKeyHandling=function(n){return Button.ActivatedButtonID!=null?(n.preventDefault?n.preventDefault():(n.keyCode=0,n.cancelBubble=!0,n.returnValue=!1),!1):!0},Button.SimulateClick=function(n){if(!n.click||Sys.Browser.agent==Sys.Browser.Firefox){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(t)&&Sys.Browser.agent==Sys.Browser.Firefox&&typeof n.href!="undefined"&&n.href!==""&&(window.location.href=n.href)}else n.click()},Button.SetDefaultButton=function(n){Button.DefaultButton!=null&&Button.DefaultButton!=''&&Button.SetRestState(Button.DefaultButton),Button.DefaultButton=n,Button.SetFocusedState(n)},Button.SetCancelButton=function(n){Button.CancelButton=n},Button.SetRestState=function(n){Button.SetCssClass(n,'')},Button.SetHoverState=function(n){Button.SetCssClass(n,'hover')},Button.SetActiveState=function(n){Button.SetCssClass(n,'active')},Button.SetFocusedState=function(n){Button.SetCssClass(n,'focus')},Button.SetCssClass=function(n,t){var u=document.getElementById(n),r,f,i;if(u!=null){if(r=u.attributes.boxtype.value,f=r==="CancelButton",t=t==null||t==''?r:r+'-'+t,i=u.className.split(' '),i.length>0){if(i[0]=t,i.length>=4&&!1==f)switch(t){case r+"-hover":i[1]="ms-fcl-nd",i[2]="ms-bgc-tl",i[3]="ms-bcl-tt";break;case r+"-active":i[1]="ms-fcl-tt",i[2]="ms-bgc-tp",i[3]="ms-bcl-tp";break;case r+"-focus":i[1]="ms-fcl-w",i[2]="ms-bgc-tp",i[3]="ms-bcl-tp";break;case r:i[1]="ms-fcl-np",i[2]="ms-bgc-nlr",i[3]="ms-bcl-tt"}else i.length>=2&&f&&(i[1]="ms-fcl-tp");t=i.join(' ')}u.className=t}};var DropDownList=window.DropDownList||function(){var t=" disabled",i=" DropdownList-disabled",r=function(t){n(t,!0)},u=function(t){n(t,!1)},n=function(n,r){var h=document.getElementById(n),f,e,u,s;if(h&&(f=h.getElementsByTagName("select"),f&&f.length>0))for(e=0;e<f.length;e++)if(u=f[e],s=u.className.lastIndexOf(t),r)u.removeAttribute("disabled"),s!=-1&&(u.className=u.className.substr(0,e));else if(u.setAttribute("disabled","disabled"),s==-1){u.className=u.className+t;var c=u.className.lastIndexOf(i),o=new Microsoft.Online.BOX.JS.Shared.BrowserIdentifier,l=o&&o!=null&&o.win&&(o.ie||o.firefox);c==-1&&l&&(u.className=u.className+i)}};return{Enable:r,Disable:u,SetEnabledState:n}}();var PageLayout=function(){};PageLayout.Layouts=[],PageLayout.ResizeInProgress=!1,PageLayout.WindowResizeEvent=function(){PageLayout.ResizePanels()},PageLayout.ResizePanels=function(n){var t=0,c=0,h,b,i,v,k,y,r,u,f,e,a,p;if(typeof n=="undefined"){if(!PageLayout.ResizeInProgress){for(PageLayout.ResizeInProgress=!0,h=0;h<PageLayout.Layouts.length;h++)PageLayout.ResizePanels(PageLayout.Layouts[h]);PageLayout.ResizeInProgress=!1}return}var w=document.getElementById("GeminiShellHeader"),l=document.getElementById("ShellBodyAndFooterContainer"),o=document.getElementById("ShellBody"),s=document.getElementById("ShellFooter");if(l!=null)b=document.documentElement.clientWidth+"px",l.style.width=b,i=document.documentElement.clientHeight,w!=null&&(i=i-w.offsetHeight),s!=null&&(s.style.width="auto"),l.style.height=i+"px",o!=null&&(o.style.height="auto",v=0,s!=null&&(v=s.offsetHeight),k=o.offsetHeight,y=i-v,k<y&&(o.style.height=y+"px"));else{r=document.getElementById(n+'_Nav'),r!=null&&(r.style.height="auto",t<r.scrollHeight&&(t=r.scrollHeight)),u=document.getElementById(n+'_Content'),u!=null&&(u.style.height="auto",t<u.scrollHeight&&(t=u.scrollHeight)),f=document.getElementById(n+'_SideBar'),f!=null&&(f.style.height="auto",t<f.scrollHeight&&(t=f.scrollHeight)),e=document.getElementById(n+'_HomeInfoMain'),e!=null&&(e.style.height="auto",a=document.getElementById(n+'_HomeInfoTop'),a!=null&&(c=a.clientHeight),t<e.scrollHeight+c&&(t=e.scrollHeight+c));var i=document.body.clientHeight,o=document.getElementById("ShellBody"),s=document.getElementById("ShellFooter");o!=null&&(s!=null&&(i=i-s.clientHeight),p=o.clientHeight-t,p>0&&(i=i-p),i>t&&(t=i)),r!=null&&(r.style.height=t+'px'),u!=null&&(u.style.height=t+'px'),f!=null&&(f.style.height=t+'px'),e!=null&&(e.style.height=t-c+'px')}},PageLayout.OpenWindow=function(n,t){n==!0?window.top.location=t:window.location=t},PageLayout.IsEmbeddedInDefaultPage=function(){var n=!1;try{window!=window.parent&&window.parent.document.getElementById('mainFrame')&&(n=!0)}catch(t){}return n};typeof Namespace!="undefined"&&Namespace!=null?Namespace.Register("Microsoft.Online.BOX.JS.Shell"):(Microsoft=window.Microsoft||{},Microsoft.Online=Microsoft.Online||{},Microsoft.Online.BOX=Microsoft.Online.BOX||{},Microsoft.Online.BOX.JS=Microsoft.Online.BOX.JS||{},Microsoft.Online.BOX.JS.Shell=Microsoft.Online.BOX.JS.Shell||{}),Microsoft.Online.BOX.JS.Shell=new function(){this.OpenFeedBackLink=function(n){document.getElementById('BOXPageIDField')!=null&&(n=n+escape(document.getElementById('BOXPageIDField').value)),window.open(n,'_blank','scrollbars=yes,menubar=no,titlebar=no,location=no,width=600,height=800,resizable=yes')},this.NavigateToHrefCallback=function(n){n!=null&&document.getElementById(n.ReturnString)!=null&&(window.location=document.getElementById(n.ReturnString).href)},this.NavigateToHrefErrorCallback=function(n){n.ErrorType=='AuthFailed'||n.ErrorType=='SessionExpired'?window.location.href=window.location.href:document.location=document.location.protocol+"//"+document.location.host+"/boxerror.aspx?"+Microsoft.Online.BOX.JS.XmlHttpRequestService.ErrorCodeLinePrefix+n.ErrorCode+"&"+Microsoft.Online.BOX.JS.XmlHttpRequestService.PartnerErrorCodeLinePrefix+n.PartnerErrorCode+"&"+Microsoft.Online.BOX.JS.XmlHttpRequestService.CorrelationIDPrefix+n.CorrelationID}};var PropertySheet=window.PropertySheet||function(){var n=function(n,t){n.style.display=t},i=function(t){var r=document.getElementById(t+'_Body'),s=document.getElementById(t+'_Collapsed'),f=document.getElementById(t+'_ArrowCollapsed'),e=document.getElementById(t+'_ArrowExpanded'),u=document.getElementById(t+'_ArrowImage'),o=!1,h,c;r.style.display=='none'?(r.style.display='block',n(f,'none'),n(e,''),s.value='0',u.parentElement.title=e.title,h='Close ',u.previousElementSibling.innerText=h):(typeof BaseValidator!="undefined"&&(o=BaseValidator.IsCalloutOpenInContainer(r)),o||(r.style.display='none',n(f,''),n(e,'none'),s.value='1',u.parentElement.title=f.title,c='Open ',u.previousElementSibling.innerText=c)),typeof PageLayout=='undefined'||o||PageLayout.ResizePanels()},r=function(n){var t=document.getElementById(n+'_Collapsed');return t.value==='1'?!0:!1},u=function(n){t(n,!0)},f=function(n){t(n,!1)},t=function(n,t){var u=window.document.getElementById(n),i,r;if(u!=null&&(u.parentNode.style.display=t?'':'none',i=u.children,null!=i))for(r=0;r<i.length;r++)i[r].controltovalidate&&(i[r].enabled=t)};return{OnClick:i,IsCollapsed:r,ShowRow:u,HideRow:f,ShowHideRow:t}}();var BaseValidator=window.BaseValidator||function(){var p=!1,y='Close',n="ValidatorCalloutBehavior",r="PopupControlBehavior",v="ValCallout",a,l,t="ValFieldError",c=!1,it=function(n,t,i){a=n,l=t,c=i,Sys.Extended.UI.ValidatorCalloutBehavior.prototype._ensureCallout=function(){var w,f,o,r,t;if(!this._isBuilt){var ut=this.get_element(),ft=this._elementToValidate=$get(ut.controltovalidate),d=document.createElement("tbody"),n=document.createElement("tr"),g=document.createElement("td"),p=document.createElement("table"),rt=document.createElement("tbody"),it=document.createElement("tr"),s=document.createElement("td"),h=document.createElement("td"),tt=this._closeCellInnerDiv=document.createElement("div"),e=this._popupTable=document.createElement("table"),u=this._calloutArrowCell=document.createElement("td"),nt=this._closeImage=document.createElement("img"),k=document.createElement("a"),b=this._errorMessageCell=document.createElement("td");if(e.id=this.get_id()+"_popupTable",e.cellPadding=0,e.cellSpacing=0,e.border=0,e.width=this.get_width(),e.setAttribute('role','alert'),e.className=v+" ajax__validatorcallout_popup_table",n.className="ajax__validatorcallout_popup_table_row",g.className="ajax__validatorcallout_callout_cell",p.cellPadding=0,p.cellSpacing=0,p.border=0,p.className="ajax__validatorcallout_callout_table",it.className="ajax__validatorcallout_callout_table_row",u.className=this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomLeft?"ajax__validatorcallout_callout_arrow_cell_bottomleftpos":this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomRight?"ajax__validatorcallout_callout_arrow_cell_bottomrightpos":this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopLeft?"ajax__validatorcallout_callout_arrow_cell_topleftpos":this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopRight?"ajax__validatorcallout_callout_arrow_cell_toprightpos":this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.Left?"ajax__validatorcallout_callout_arrow_cell_leftpos":"ajax__validatorcallout_callout_arrow_cell",s.className="ajax__validatorcallout_icon_cell ms-bgc-w",s.innerHTML="&nbsp;",b.className="ajax__validatorcallout_error_message_cell ms-bgc-w",b.innerHTML=this._getErrorMessage(),h.className="ajax__validatorcallout_close_button_cell ms-bgc-w",Shared.IsTextRightToLeft&&(s.className+=" ajax__validatorcallout_icon_cell_rtl",h.className+=" ajax__validatorcallout_close_button_cell_rtl"),k.setAttribute("href","#"),k.setAttribute("title",y),k.setAttribute("onclick","return false;"),tt.className="ajax__validatorcallout_innerdiv",nt.src=a,nt.setAttribute("style",l),nt.setAttribute("alt",y),ut.parentNode.appendChild(e),e.appendChild(d),d.appendChild(n),n.appendChild(g),g.appendChild(p),p.appendChild(rt),rt.appendChild(it),it.appendChild(u),n.appendChild(s),n.appendChild(b),n.appendChild(h),k.appendChild(nt),tt.appendChild(k),h.appendChild(tt),this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomLeft||this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomRight?(w=document.createElement("tr"),d.insertBefore(w,n),u.colSpan=3,w.appendChild(u),n.appendChild(s),n.appendChild(b),n.appendChild(h)):this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopLeft||this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopRight?(w=document.createElement("tr"),d.appendChild(w),u.colSpan=3,w.appendChild(u),n.appendChild(s),n.appendChild(b),n.appendChild(h)):(n.appendChild(g),n.appendChild(s),n.appendChild(b),n.appendChild(h)),f=document.createElement("div"),f.className="ajax__validatorcallout_innerdiv",i&&(f.className="ajax__validatorcallout_innerdiv NoTopBorder"),u.appendChild(f),this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomLeft||this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomRight)for(o=document.createElement("div"),o.style.width="1px",o.className="arrowpixel",f.appendChild(o),r=1;r<22;r+=2)t=document.createElement("div"),t.style.width=r.toString()+"px",t.className="ms-bgc-w",f.appendChild(t);else if(this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopLeft||this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopRight){for(r=23;r>0;r-=2)t=document.createElement("div"),t.style.width=r.toString()+"px",t.className="ms-bgc-w",f.appendChild(t);o=document.createElement("div"),o.style.width="1px",o.className="arrowpixel",f.appendChild(o)}else{if(c)for(r=1;r<14;r++)t=document.createElement("div"),t.style.width=r.toString()+"px",t.className="ms-bgc-w",f.appendChild(t);for(r=14;r>0;r--)t=document.createElement("div"),t.style.width=r.toString()+"px",t.className="ms-bgc-w",f.appendChild(t)}this._popupBehavior=$create(Sys.Extended.UI.PopupBehavior,{parentElement:ft},{},null,this._popupTable),this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopLeft?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.TopLeft):this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.TopRight?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.TopRight):this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomLeft?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.BottomLeft):this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.BottomRight?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.BottomRight):this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.Right?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Right):this._popupPosition==Sys.Extended.UI.ValidatorCalloutPosition.Left?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Left):this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Right),this._onShowJson&&this._popupBehavior.set_onShow(this._onShowJson),this._onHideJson&&this._popupBehavior.set_onHide(this._onHideJson),$addHandler(this._closeCellInnerDiv,"click",this._closeClickHandler),this._isBuilt=!0}}},w=function(){var f,e,s,u;if(!p){for(f=Sys.Application.getComponents(),u=0;u<f.length;u++)f[u].get_name&&f[u].get_name()===n&&(f[u].set_highlightCssClass(t),f[u].set_cssClass(v),f[u]._ensureCallout(),f[u].oldShow=f[u].show,f[u].show=o,f[u].oldHide=f[u].hide,f[u].hide=h,f[u]._elementToValidate.originalTitle=f[u]._elementToValidate.title,f[u]._popupBehavior._verifyPosition=i,f[u]._popupBehavior.adjustPopupPosition=i,f[u].get_isOpen()&&(f[u].hide(),f[u].show()));p=!0}},h=function(){this.oldHide(),this._popupBehavior.get_visible()||(this._elementToValidate.title=this._elementToValidate.originalTitle)},k=function(t){for(var r=Sys.Application.getComponents(),f=!1,u,i=0;i<r.length&&!f;i++)if(typeof r[i].get_name=="function"&&r[i].get_name()===n&&typeof r[i].get_isOpen=="function"&&r[i].get_isOpen())for(u=r[i]._elementToValidate.parentElement;u!==null&&u!==document.body;)if(u===t){f=!0;break}else u=u.parentElement;return f},d=function(n){f(n,null)},f=function(t,i){for(var e=Sys.Application.getComponents(),f=0;f<e.length;f++)e[f].get_name&&(e[f].get_name()===r?e[f].get_PopupVisible()&&e[f].hidePopup():e[f].get_name()===n&&i!==e[f]&&e[f].get_isOpen()&&e[f]._popupBehavior&&(e[f].hide(),t&&u(e[f]._elementToValidate)))},s=function(){for(var i=Sys.Application.getComponents(),t=0;t<i.length;t++)if(i[t].get_name()===r){if(i[t].get_PopupVisible())return i[t]}else if(i[t].get_name()===n&&i[t].get_isOpen())return i[t];return null},g=function(){var t=s();t&&(t.get_name()===r?(t.hidePopup(),t.showPopup()):t.get_name()===n&&(t.hide(),t.show()))},u=function(n){var i=n.className;i.indexOf(t)!=-1&&(i=i.replace(t,""),n.className=i)},nt=function(t){for(var r=Sys.Application.getComponents(),i=0;i<r.length;i++)r[i].get_name&&r[i].get_name()===n&&r[i]._elementToValidate===t&&(r[i].hide(),u(r[i]._elementToValidate))},o=function(){var t,n,i,r;f(!1,this),this.oldShow(),this._popupBehavior.get_visible()&&(t=this._getErrorMessage(),this._element.innerHTML=t,t=this._element.innerText,n=this._elementToValidate,n.title=n.originalTitle?n.originalTitle+" \n"+t:t,this._highlightCssClass&&Sys.UI.DomElement.addCssClass(n,this._highlightCssClass),e(n),window!==window.top&&window.top.DialogManager!==null&&(i=window.top.DialogManager.getTopDialogInstance(),i!=null&&(r=this._popupBehavior.getBounds(),i.resizeContentFrame(r))))},e=function(n){for(var t=n.parentElement;t!==null&&t!==document.body;)if(typeof t.attributes.boxtype!="undefined")switch(t.attributes.boxtype.value){case"CollapsibleControl":CollapsibleControl.IsCollapsed(t.id)&&CollapsibleControl.SetCollapsedState(t.id,!1),t=null;break;case"PropertySheet":PropertySheet.IsCollapsed(t.id)&&PropertySheet.OnClick(t.id,null),t=null;break;default:t=t.parentElement}else t=t.parentElement},tt=function(t){for(var u=Sys.Application.getComponents(),r,i=0;i<u.length;i++)u[i].get_name&&(r=u[i],r.get_name()===n&&r._elementToValidate&&r._elementToValidate.id===t&&(r._element.enabled=!0))},b=function(t){for(var u=Sys.Application.getComponents(),i,r=0;r<u.length;r++)u[r].get_name&&(i=u[r],i.get_name()===n&&i._elementToValidate&&i._elementToValidate.id===t&&(ValidatorEnable(i._element,!1),i._highlightCssClass&&Sys.UI.DomElement.removeCssClass(i._elementToValidate,i._highlightCssClass),i._invalid=!1,i.hide(),i._focusAttached&&($removeHandler(i._elementToValidate,"focus",i._focusHandler),i._focusAttached=!1)))},i=function(n){return n};return{HighlightCssClass:t,Init:it,UpdateValidatorUX:w,Hide:h,IsCalloutOpenInContainer:k,HideAllCallouts:d,HideOtherCallouts:f,GetActiveCallout:s,RefreshActiveCallout:g,RemoveHighlight:u,HideCalloutByTargetControl:nt,Show:o,OpenContractedContainer:e,EnableValidtorsForCtrl:tt,DisableValidtorsForCtrl:b,DoNothing:i}}();var O365;(function(n){var t=function(){function n(n,t,i){this.element=n,this.indexValue=t,this.disabled=i}return n}(),i=function(){function n(n){this._tagsSupportingTabIndex=['A','ABBR','ACRONYM','ADDRESS','APPLET','AREA','B','BDO','BIG','BLOCKQUOTE','BODY','BUTTON','CAPTION','CENTER','CITE','CUSTOM','DD','DEL','DFN','DIR','DIV','DL','DT','EM','FIELDSET','FONT','FORM','FRAME','FRAMESET','hn','HR','I','IFRAME','IMG','INPUT','INS','ISINDEX','KBD','LABEL','LEGEND','LI','LISTING','MARQUEE','MENU','OBJECT','OL','P','PLAINTEXT','PRE','Q','RT','RUBY','S','SAMP','SELECT','SMALL','SPAN','STRIKE','STRONG','SUB','SUP','TABLE','TBODY','TD','TEXTAREA','TFOOT','TH','THEAD','TR','TT','U','UL','VAR','XMP'],this._savedTabIndexes=null,this._element=n}return n.prototype.DisableTab=function(){var e,o,r,i,h,n,f,u;for(this._savedTabIndexes=[],e=[],o=0;o<this._tagsSupportingTabIndex.length;o++)for(r=this._element.getElementsByTagName(this._tagsSupportingTabIndex[o]),i=0;i<r.length;i++){var f=r[i].getAttributeNode('tabindex'),c=f!=null&&f.specified,l=c?r[i].tabIndex:Number.NaN,s=null;this._requireSpecialDisabling(r[i])&&(u=r[i].getAttributeNode('disabled'),h=u!=null&&u.specified,s=h?r[i].disabled.toString():null),e.push(new t(r[i],l,s))}this._forbiddenTab(document);do n=e.shift(),isNaN(n.indexValue)?(f=n.element.getAttributeNode('tabindex'),f!=null&&f.specified&&n.element.removeAttributeNode(f)):n.element.tabIndex=n.indexValue,n.disabled!=null?n.element.disabled=n.disabled.trim().toLowerCase()==="true":(u=n.element.getAttributeNode('disabled'),u!=null&&u.specified&&n.element.removeAttributeNode(u));while(e.length>0)},n.prototype.DisableTabOnlyInElement=function(){this._savedTabIndexes=[],this._forbiddenTab(this._element)},n.prototype.RestoreTab=function(){var n,t,i;if(this._savedTabIndexes!==null){do n=this._savedTabIndexes.shift(),isNaN(n.indexValue)?(t=n.element.getAttributeNode('tabindex'),t!=null&&t.specified&&n.element.removeAttributeNode(t)):n.element.setAttribute('tabindex',n.indexValue),this._requireSpecialDisabling(n.element)&&(n.disabled!=null?n.element.disabled=n.disabled.trim().toLowerCase()==="true":(i=n.element.getAttributeNode('disabled'),i!=null&&i.specified&&n.element.removeAttributeNode(i)));while(this._savedTabIndexes.length>0);this._savedTabIndexes=null}},n.prototype._requireSpecialDisabling=function(n){var i=!1,t;return n.tagName.toLowerCase()==='input'&&(t=n.attributes.getNamedItem('type'),t!=null&&t.specified&&t.value.toLowerCase()==='radio'&&(i=!0)),i},n.prototype._forbiddenTab=function(n){var u,r,i,f,s;if(n!=null)for(u=0;u<this._tagsSupportingTabIndex.length;u++)for(r=n.getElementsByTagName(this._tagsSupportingTabIndex[u]),i=0;i<r.length;i++){var e=r[i].getAttributeNode('tabindex'),h=e!=null&&e.specified,c=h?r[i].tabIndex:Number.NaN,o=null;r[i].tabIndex=-1,this._requireSpecialDisabling(r[i])&&(f=r[i].getAttributeNode('disabled'),s=f!=null&&f.specified,o=s?r[i].disabled.toString():null,r[i].disabled=!0),this._savedTabIndexes.push(new t(r[i],c,o))}},n}();n.TabSaver=i})(O365||(O365={}));var BOX;(function(n){var t;(function(t){var i=window.Button,f=function(){function n(n,t,i,r){this.x=n,this.y=t,this.width=i,this.height=r}return n}(),r,s,h,o,e,u;t.Bounds=f,r=function(n){return n+'px'},function(n){n[n.none=0]="none",n[n.info=1]="info",n[n.warn=2]="warn",n[n.error=3]="error",n[n.custom=4]="custom"}(t.IconType||(t.IconType={})),s=t.IconType,function(n){n[n.alert=0]="alert",n[n.confirm=1]="confirm",n[n.freeFormUrl=2]="freeFormUrl",n[n.freeFormHtml=3]="freeFormHtml"}(t.DialogType||(t.DialogType={})),h=t.DialogType,o=function(){function t(n,t,i,r,u){var f=this;this._dialogID=0,this._dialogType=0,this._zIndex=0,this._ignoredEventHandler=null,this._startDragDropHandler=null,this._dragMoveHandler=null,this._endDragDropHandler=null,this._isIFrameMode=!1,this._learnMoreEnabled=!1,this._footerEnabled=!1,this._previousElementInFocus=null,this._originalDefaultButton=null,this._originalCancelButton=null,this._isDragging=!1,this._dragStartX=0,this._dragStartY=0,this._originalHtmlOverflowValue='',this._originalBodyOverflowValue='',this._parent=null,this._settings=null,this._element=null,this._shieldElement=null,this._frameElement=null,this._foregroundElement=null,this._topRegionElement=null,this._dialogBodyElement=null,this._dialogContentAreaElement=null,this._acceptButtonElement=null,this._dismissButtonElement=null,this._dismissAction=null,this._freezerDiv=null,this.set_parent(n),this._dialogID=t,this._dialogType=u,this._zIndex=1e4+t*3,this.set_settings(i),this.set_dismissAction(r),this._ignoredEventHandler=function(){f._ignoreEvent()},this._startDragDropHandler=function(){f._startDragDrop()},this._dragMoveHandler=function(){f._onDragMove()},this._endDragDropHandler=function(){f._endDragDrop()},this._initialize()}return t.prototype.get_originalDefaultButton=function(){return this._originalDefaultButton},t.prototype.get_originalCancelButton=function(){return this._originalCancelButton},t.prototype.get_parent=function(){return this._parent},t.prototype.set_parent=function(n){return this._parent=n,n},t.prototype.get_settings=function(){return this._settings},t.prototype.set_settings=function(n){return this._settings=n,n},t.prototype.get_element=function(){return this._element},t.prototype.set_element=function(n){return this._element=n,n},t.prototype.get_shieldElement=function(){return this._shieldElement==null&&(this._shieldElement=t._findElement(this.get_element(),this.get_parent().get_dialogShieldID())),this._shieldElement},t.prototype.get_frameElement=function(){return this._frameElement==null&&(this._frameElement=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFrameID())),this._frameElement},t.prototype.get_foregroundElement=function(){return this._foregroundElement==null&&(this._foregroundElement=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogForegroundID())),this._foregroundElement},t.prototype.get_topRegionElement=function(){return this._topRegionElement==null&&(this._topRegionElement=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogTopRegionID())),this._topRegionElement},t.prototype.get_dialogBodyElement=function(){return this._dialogBodyElement==null&&(this._dialogBodyElement=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogBodyAreaID())),this._dialogBodyElement},t.prototype.get_dialogContentAreaElement=function(){return this._dialogContentAreaElement==null&&(this._dialogContentAreaElement=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogContentAreaID())),this._dialogContentAreaElement},t.prototype.get_acceptButtonElement=function(){return this._acceptButtonElement==null&&(this._acceptButtonElement=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedAcceptButtonID())),this._acceptButtonElement},t.prototype.get_dismissButtonElement=function(){return this._dismissButtonElement==null&&(this._dismissButtonElement=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedDismissButtonID())),this._dismissButtonElement},t.prototype.get_dismissAction=function(){return this._dismissAction},t.prototype.set_dismissAction=function(n){return this._dismissAction=n,n},t.prototype.updateHeader=function(t,i,u,f){var o=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogIconAreaID()),k,b,w,d,e,p,a,c,g;if(o!=null){o.style.display='inline';switch(t){case 1:k=document.getElementById(this.get_parent().get_infoIconAreaID()),k!=null&&(o.innerHTML=k.innerHTML);break;case 2:b=document.getElementById(this.get_parent().get_warningIconAreaID()),b!=null&&(o.innerHTML=b.innerHTML);break;case 3:w=document.getElementById(this.get_parent().get_errorIconAreaID()),w!=null&&(o.innerHTML=w.innerHTML);break;case 4:d=document.createElement('img'),d.setAttribute('src',f),o.innerHTML='',o.appendChild(d);break;default:o.style.display='none'}}e=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogTitleAreaID()),p='DialogManager-FreeFormTitle',(this._dialogType===3||this._dialogType===2)&&(e.className=e.className+' '+p,t!==0&&(e.className=e.className.replace(new RegExp(p+'.*'),''))),i!=null&&i.length>0?(e.style.display='block',e.innerHTML=i):e.style.display='none',a=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogSubTitleAreaID()),u!=null&&u.length>0?(a.style.display='block',a.innerHTML=u):a.style.display='none',this.get_settings().get_isFullScreen()||(this.get_settings().get_width()>0&&this.setDialogWidth(),this.get_settings().get_height()>0&&this.setDialogHeight());var h=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogHeaderAreaID()),y=0,v=0,s;if(s=h.currentStyle!=null?h.currentStyle:window.getComputedStyle(h,null),s!=null&&(y=s.paddingLeft.substr(0,s.paddingLeft.length-2),v=s.paddingRight.substr(0,s.paddingRight.length-2)),c=h.getElementsByTagName('table'),c.length>0){var nt=c[0].offsetWidth+y+v,tt=c[0].offsetWidth-e.offsetWidth,l=h.offsetWidth;l>this.get_settings().get_width()&&(l=this.get_settings().get_width()),nt>l&&(g=l-y-v-tt,e.style.width=g<0?"":r(g))}},t.prototype.freezeUserInteraction=function(){this.get_frameElement().disabled=!0,this._freezerDiv=document.createElement('div'),this._freezerDiv.className='DialogManager-ForegroundFreezer',this.get_frameElement().appendChild(this._freezerDiv),this._freezerDiv.style.zIndex=(this._zIndex+2).toString()},t.prototype.thawUserInteraction=function(){this.get_frameElement().disabled=!1,this._freezerDiv!=null&&(this._freezerDiv.parentNode.removeChild(this._freezerDiv),this._freezerDiv=null)},t.prototype._setContentHtml=function(t,r,u){var e,f,o;this.get_dialogBodyElement().innerHTML=t,e=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedAcceptButtonID()),f=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedDismissButtonID()),(r!=null||u!=null)&&(o=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFooterAreaID()),o.style.display='block',this._footerEnabled=!0),r!=null&&u==null?(i.SetText(e.id,r),f.parentNode.removeChild(f)):r!=null&&u!=null&&(i.SetText(e.id,r),i.SetText(f.id,u))},t.prototype._setDialogHtml=function(n){this.get_dialogContentAreaElement().innerHTML=n},t.prototype._setContentUrl=function(t,i){var l=this,u,s,h,c,r,e,o,f;this._isIFrameMode=!0,u=this._createIFrame(),s=document.createAttribute('src'),s.value=i,u.attributes.setNamedItem(s),u.style.height='0px',u.style.width='100%',h=!0,(!1==n.JS.DialogManager.get_isBrowserIE()||n.JS.DialogManager.get_isBrowserIE9PlusDocumentMode())&&(h=!1,c=document.createAttribute('onload'),c.value='BOX.JS.DialogInstance.onIFrameReady(\"'+this.get_element().id+'", \"'+this.get_frameElement().id+'\", \"'+this.getContentIFrameID()+'\");',u.attributes.setNamedItem(c)),r=document.createElement('div'),r.setAttribute('id','waitSpinner'),r.setAttribute('class','Loading-Horizontal AdminWait'),r.setAttribute('style','top: 30%; left: 50%;'),e=document.createElement('img'),e.setAttribute('style','border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; vertical-align: middle; border-left-width: 0px'),e.setAttribute('src',this.get_parent().get_spinnerIconUrl()),r.appendChild(e),o=document.createElement('div'),o.setAttribute('id','frameContainer'),o.appendChild(u),r.style.display='block',f=this.get_dialogBodyElement(),f.style.paddingLeft='0px',f.style.paddingRight='0px',f.setAttribute("tabIndex","-1"),f.appendChild(r),f.appendChild(o),n.JS.DialogManager.get_isBrowserIE()&&h&&window.setTimeout(function(){l._resizeContentFrameOnIEReady()},0)},t.prototype._resizeContentFrameOnIEReady=function(){var i=this,t,r;try{if(t=document.getElementById(this.getContentIFrameID()),t!=null&&t.contentWindow!=null&&t.contentWindow.document!=null&&t.contentWindow.document.body!=null)if(r=t.contentWindow.document.readyState,r==='complete')n.JS.DialogInstance.onIFrameReady(this.get_element().id,this.get_parent().get_dialogFrameID(),t.id);else window.setTimeout(function(){i._resizeContentFrameOnIEReady()},5);else window.setTimeout(function(){i._resizeContentFrameOnIEReady()},5)}catch(u){window.setTimeout(function(){i._resizeContentFrameOnIEReady()},5)}},t.prototype.resizeContentFrame=function(n){t.resizeByVisibiltyRestrictions(this.get_element().id,this.get_parent().get_dialogFrameID(),this.getContentIFrameID(),n)},t.prototype._createIFrame=function(){var n=document.createElement('iframe'),t,i;return n.id=this.getContentIFrameID(),n.frameBorder='0',t=document.createAttribute('allowTransparency'),t.value='false',n.attributes.setNamedItem(t),i='no',this.get_settings()!=null&&this.get_settings().get_scrollContent()&&(i='yes'),n.scrolling=i,n},t.prototype.dismiss=function(n){var t=this;this.get_settings().get_isFullScreen()&&(document.body.style.overflow=this._originalBodyOverflowValue,document.body.parentNode.style.overflow=this._originalHtmlOverflowValue),Microsoft.Online.BOX.JS.Shared.RemoveEventListener(window,'resize',function(){t.repositionAndResizeDialog()}),this.get_settings().get_canDrag()&&(Microsoft.Online.BOX.JS.Shared.RemoveEventListener(document.body,'selectstart',this._ignoredEventHandler),Microsoft.Online.BOX.JS.Shared.RemoveEventListener(document.body,'dragstart',this._ignoredEventHandler)),this.get_settings().get_hasShield()&&this._tabSaver.RestoreTab(),this.get_dismissAction()!=null&&this.get_dismissAction().call(this,n),i.DefaultButton=this._originalDefaultButton,i.CancelButton=this._originalCancelButton,this._previousElementInFocus!=null&&this._previousElementInFocus.length>0&&(u.get_isBrowserIE7Compatible()?window.setTimeout(function(){t._focusPreviousElement()},0):this._focusPreviousElement())},t.prototype.center=function(){u.centerDialog(this.get_element(),this.get_frameElement(),this._isIFrameMode)},t.prototype.repositionAndResizeDialog=function(){this.get_settings().get_isFullScreen()?(this._setDialogFrameToFullScreen(),this.center()):(this.setDialogWidth(),this.setDialogHeight(),this.center(),this.setDialogWidth(),this.setDialogHeight())},t.prototype._initialize=function(){var o=this,t,r,u,e,f;if(document.activeElement!=null)try{this._previousElementInFocus=document.activeElement.id}catch(s){}this._cloneDialog(),t=document.body.getElementsByTagName('form'),t!=null&&t.length===1&&t[0].name!="adminFeedbackForm"?t[0].appendChild(this.get_element()):document.body.appendChild(this.get_element()),this.get_settings()!=null&&(this.get_settings().get_helpUrl()!=null&&this.get_settings().get_helpUrl().length>0&&(r=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedHelpButtonID()),r!=null?(r.style.display='inline',r.setAttribute('href',this.get_settings().get_helpUrl())):(u=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedLearnMoreLinkID()),e=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedLearnMoreAreaID()),u!=null&&(e.style.display='block',u.setAttribute('href',this.get_settings().get_helpUrl()),this._learnMoreEnabled=!0))),this.get_settings().get_showX()||(f=n.JS.DialogInstance._findElement(this.get_element(),this._getClonedCloseButtonID()),f!=null&&(f.style.visibility='hidden')),(!this.get_settings().get_showDecoration()||this.get_settings().get_isFullScreen())&&this._hideDecoration(),this._originalDefaultButton=i.DefaultButton,this._originalCancelButton=i.CancelButton,this.get_settings().get_hasShield()?(this._tabSaver=new O365.TabSaver(this.get_element()),this._tabSaver.DisableTab(),i.DefaultButton=this.get_settings().get_defaultActionControlID(),i.CancelButton=this.get_settings().get_cancelActionControlID()):this._hideShield(),this.get_settings().get_isFullScreen()?(this._originalBodyOverflowValue=document.body.style.overflow,this._originalHtmlOverflowValue=document.body.parentNode.style.overflow,document.body.style.overflow='hidden',document.body.parentNode.style.overflow='hidden',this._setDialogFrameToFullScreen()):(this.get_settings().get_width()>0&&this.setDialogWidth(),this.get_settings().get_height()>0&&this.setDialogHeight()),Microsoft.Online.BOX.JS.Shared.AddEventListener(window,'resize',function(){o.repositionAndResizeDialog()}),this.get_settings().get_canDrag()&&(this.get_topRegionElement().style.cursor='move',Microsoft.Online.BOX.JS.Shared.AddEventListener(document.body,'selectstart',this._ignoredEventHandler),Microsoft.Online.BOX.JS.Shared.AddEventListener(document.body,'dragstart',this._ignoredEventHandler),Microsoft.Online.BOX.JS.Shared.AddEventListener(this.get_topRegionElement(),'mousedown',this._startDragDropHandler)))},t.prototype._cloneDialog=function(){var h=document.getElementById(this.get_parent().get_dialogAreaID()),r,t,u,i,f,e,o,s,c,l,a,v;this.set_element(h.cloneNode(!0)),this.get_element().id=this._getClonedControlID(this.get_parent().get_dialogAreaID()),this.get_element().style.zIndex=this._zIndex.toString(),r=new RegExp(this.get_parent().get_acceptButtonID(),'gi'),t=this._getClonedAcceptButtonID(),this.get_element().innerHTML=this.get_element().innerHTML.replace(r,t),u=new RegExp(this.get_parent().get_dismissButtonID(),'gi'),i=this._getClonedDismissButtonID(),O365&&O365.Button&&O365.Button.Initialize&&(O365.Button.Initialize(t),O365.Button.Initialize(i)),this.get_element().innerHTML=this.get_element().innerHTML.replace(u,i),f=new RegExp(this.get_parent().get_helpLinkID(),'gi'),e=this._getClonedHelpButtonID(),this.get_element().innerHTML=this.get_element().innerHTML.replace(f,e),o=new RegExp(this.get_parent().get_closeIconID(),'gi'),s=this._getClonedCloseButtonID(),this.get_element().innerHTML=this.get_element().innerHTML.replace(o,s),c=new RegExp(this.get_parent().get_learnMoreLinkID(),'gi'),l=this._getClonedLearnMoreLinkID(),this.get_element().innerHTML=this.get_element().innerHTML.replace(c,l),a=new RegExp(this.get_parent().get_learnMoreAreaID(),'gi'),v=this._getClonedLearnMoreAreaID(),this.get_element().innerHTML=this.get_element().innerHTML.replace(a,v),this.get_shieldElement().style.zIndex=this._zIndex.toString(),this.get_foregroundElement().style.zIndex=(this._zIndex+1).toString(),n.JS.DialogInstance._evaluateClonedScriptTags(h,this.get_element(),[r,u,f,o],[t,i,e,s])},t.prototype._getClonedControlID=function(n){return n+'_'+this._dialogID},t.prototype._getClonedAcceptButtonID=function(){return this._getClonedControlID(this.get_parent().get_acceptButtonID())},t.prototype._getClonedDismissButtonID=function(){return this._getClonedControlID(this.get_parent().get_dismissButtonID())},t.prototype._getClonedHelpButtonID=function(){return this._getClonedControlID(this.get_parent().get_helpLinkID())},t.prototype._getClonedLearnMoreLinkID=function(){return this._getClonedControlID(this.get_parent().get_learnMoreLinkID())},t.prototype._getClonedLearnMoreAreaID=function(){return this._getClonedControlID(this.get_parent().get_learnMoreAreaID())},t.prototype._getClonedCloseButtonID=function(){return this._getClonedControlID(this.get_parent().get_closeIconID())},t.prototype.getContentIFrameID=function(){return this._getClonedControlID('ContentIFrame')},t.prototype._hideDecoration=function(){var t,i,r,u;this.get_topRegionElement().style.display='none',t=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogBottomRegionID()),t.style.display='none',i=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogMiddleRegionID()),i.style.borderWidth='0px',r=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogHeaderAreaID()),r.style.display='none',u=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFooterAreaID()),u.style.display='none'},t.prototype._hideShield=function(){this.get_shieldElement().style.display='none'},t.prototype._setDialogFrameToFullScreen=function(){var t=this.get_frameElement(),i,f,e;t.style.left='0px',t.style.top='0px',t.style.position='fixed',i=u.getBrowserDimensions(),t.style.width=r(i.width),t.style.height=r(i.height),f=n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogMiddleRegionID()),f.style.width='100%',f.style.height='100%',this.get_dialogContentAreaElement().style.width='100%',this.get_dialogContentAreaElement().style.height='100%',e=this.get_dialogBodyElement(),e.style.width=r(i.width-20),e.style.height='100%'},t.prototype._startDragDrop=function(){var t=window.event,n=t.srcElement;if(!this._isDragging&&n.tagName.toLowerCase()!="img"){for(this._isDragging=!0,this._dragStartX=t.offsetX,this._dragStartY=t.offsetY;n.id!==this.get_parent().get_dialogFrameID()&&n!=null;)this._dragStartX+=n.offsetLeft,this._dragStartY+=n.offsetTop,n=n.offsetParent;Microsoft.Online.BOX.JS.Shared.RemoveEventListener(this.get_topRegionElement(),'mousedown',this._startDragDropHandler),Microsoft.Online.BOX.JS.Shared.AddEventListener(document,'mousemove',this._dragMoveHandler),Microsoft.Online.BOX.JS.Shared.AddEventListener(document,'mouseup',this._endDragDropHandler)}},t.prototype._endDragDrop=function(){var n=window.event,t,i;this._isDragging&&(this._isDragging=!1,t=n.clientX,i=n.clientY,this.get_element().style.left=r(t-this._dragStartX),this.get_element().style.top=r(i-this._dragStartY),Microsoft.Online.BOX.JS.Shared.RemoveEventListener(document,'mousemove',this._dragMoveHandler),Microsoft.Online.BOX.JS.Shared.RemoveEventListener(document,'mouseup',this._endDragDropHandler),Microsoft.Online.BOX.JS.Shared.AddEventListener(this.get_topRegionElement(),'mousedown',this._startDragDropHandler))},t.prototype._onDragMove=function(){var t=window.event,i,u,n;this._isDragging&&(i=t.clientX,u=t.clientY,this.get_element().style.left=r(i-this._dragStartX),this.get_element().style.top=r(u-this._dragStartY),document.selection?document.selection.clear():document.getSelection&&(n=document.getSelection(),n.empty?n.empty():n.removeAllRanges&&n.removeAllRanges()))},t.prototype.setDialogWidth=function(t){var f=typeof t=='undefined'||t==-1,u,i;f?t=this.get_settings().get_width():this.get_settings().set_width(t),u=n.JS.DialogManager.getBrowserDimensions(),i=n.JS.DialogInstance._findElement(this.get_frameElement(),this.get_parent().get_dialogBodyAreaID()),i&&(t>u.width?(t=u.width-20,i.style.overflowX='auto'):i.style.overflowX='hidden'),this.get_frameElement().style.width=r(t)},t.prototype.setDialogHeight=function(t){var f=typeof t=='undefined'||t==-1;f?t=this.get_settings().get_height():this.get_settings().set_height(t);var e=this.get_topRegionElement().offsetHeight,o=n.JS.DialogInstance._findElement(this.get_frameElement(),this.get_parent().get_dialogBottomRegionID()).offsetHeight,s=n.JS.DialogInstance._findElement(this.get_frameElement(),this.get_parent().get_dialogHeaderAreaID()).offsetHeight,h=this._learnMoreEnabled?n.JS.DialogInstance._findElement(this.get_element(),this._getClonedLearnMoreLinkID()).offsetHeight:0,c=this._footerEnabled?n.JS.DialogInstance._findElement(this.get_element(),this.get_parent().get_dialogFooterAreaID()).offsetHeight:0,i=n.JS.DialogManager.getBrowserDimensions(),u=e+o+s+h+c,l=this.get_dialogContentAreaElement();u+l.scrollHeight>i.height?(this.get_dialogContentAreaElement().style.height=r(i.height-u),this.get_dialogContentAreaElement().style.overflowY='auto'):(this.get_dialogContentAreaElement().style.height='',this.get_dialogContentAreaElement().style.overflowY='hidden')},t.prototype._getElementBounds=function(n){for(var t=new f(n.offsetLeft,n.offsetTop,n.offsetWidth,n.offsetHeight);n.parentNode!=null;)t.x+=n.parentNode.offsetLeft,t.y+=n.parentNode.offsetTop,n=n.parentNode;return t},t.prototype._ignoreEvent=function(){var n=window.event;n.returnValue=!1,n.cancelBubble=!0},t.prototype._focusPreviousElement=function(){var n=document.getElementById(this._previousElementInFocus);if(n!=null)try{n.focus()}catch(t){}},t.onIFrameReady=function(t,i,r){var e=document.getElementById('waitSpinner'),u,f;e!=null&&(e.style.display='none'),n.JS.DialogInstance.resizeByVisibiltyRestrictions(t,i,r,null);try{u=document.getElementById(r),f=null,u!=null&&(n.JS.DialogManager.get_isBrowserIE()?u.contentWindow!=null&&(f=u.contentWindow.document):f=u.contentDocument,f!=null&&f.body!=null&&(u.contentWindow.Button.ResizeButtons(),f.body.focus()))}catch(o){}},t.resizeByVisibiltyRestrictions=function(i,u,f,e){var h=document.getElementById(f),o,s,c,l;h!=null&&(h.style.height='0px',!1==n.JS.DialogManager.get_isBrowserIE()?(o=h.contentDocument,o!=null&&o.body!=null&&o.body.style.height!=='auto'&&(o.body.style.height='auto')):o=h.contentWindow.document,s=o.body.scrollHeight,e!=null&&(s=Math.max(s,e.y+e.height)),s=s+t._iFrameBodyMarginCompensation,h.style.height=r(s),c=document.getElementById(i),l=n.JS.DialogInstance._findElement(c,u),n.JS.DialogManager.centerDialog(c,l,!0))},t._findElement=function(n,i){var f=null,r,u;if(n!=null)if(n.id!=null&&n.id.localeCompare(i)===0)f=n;else{for(r=null,u=0;u<n.childNodes.length;u++)if(r=t._findElement(n.childNodes[u],i),r!=null)break;f=r}return f},t._evaluateClonedScriptTags=function(n,t,i,r){var e=n.getElementsByTagName('script'),o=t.getElementsByTagName('script'),u,f;if(o!=null&&e!=null&&o.length===e.length)for(u=0;u<e.length;u++){var h=o[u],c=e[u],s=c.text;if(i!=null&&r!=null&&i.length===r.length)for(f=0;f<i.length;f++)s=s.replace(i[f],r[f]);try{eval(s),h.text=''}catch(l){}}},t._iFrameBodyMarginCompensation=10,t}(),t.DialogInstance=o,e=function(){function n(n){var i,r,t;if(this._dialogTemplateID=null,this._isFullSceen=!1,this._width=0,this._height=0,this._scrollContent=!1,this._canDrag=!1,this._hasShield=!1,this._showDecoration=!1,this._helpUrl=null,this._defaultActionControlID=null,this._cancelActionControlID=null,this._showX=!1,this._reloadElement=!1,this._dialogIconType=0,this.set_isFullScreen(!1),this.set_height(-1),this.set_width(u.get_isModernUI()?666:400),this.set_scrollContent(!1),this.set_helpUrl(''),this.set_canDrag(!0),this.set_hasShield(!0),this.set_showDecoration(!0),this.set_defaultActionControlID(null),this.set_cancelActionControlID(null),this.set_showX(u.get_isModernUI()?!1:!0),n!=null&&(i=n.split(','),i!=null))for(r=0;r<i.length;r++)if(t=i[r].split(':'),t!=null&&t.length>=2)switch(t[0].toLowerCase()){case'fullscreen':this.set_isFullScreen(t[1].trim().toLowerCase()==="true");break;case'width':this.set_width(parseInt(t[1].trim().toLowerCase()));break;case'height':this.set_height(parseInt(t[1].trim().toLowerCase()));break;case'scrolling':this.set_scrollContent(t[1].trim().toLowerCase()==="true");break;case'drag':this.set_canDrag(t[1].trim().toLowerCase()==="true");break;case'hasshield':this.set_hasShield(t[1].trim().toLowerCase()==="true");break;case'showdecoration':this.set_showDecoration(t[1].trim().toLowerCase()==="true");break;case'helpurl':this.set_helpUrl(i[r].substr(t[0].length+1));break;case'defaultaction':this.set_defaultActionControlID(t[1]);break;case'cancelaction':this.set_cancelActionControlID(t[1]);break;case'showx':this.set_showX(t[1].trim().toLowerCase()==="true");break;case'reloadelement':this.set_reloadElement(t[1].trim().toLowerCase()==="true");break;case'dialogicontype':this.set_dialogIconType(parseInt(t[1]))}}return n.prototype.get_isFullScreen=function(){return this._isFullSceen},n.prototype.set_isFullScreen=function(n){return this._isFullSceen=n,n},n.prototype.get_width=function(){return this._width},n.prototype.set_width=function(n){return this._width=n,n},n.prototype.get_height=function(){return this._height},n.prototype.set_height=function(n){return this._height=n,n},n.prototype.get_scrollContent=function(){return this._scrollContent},n.prototype.set_scrollContent=function(n){return this._scrollContent=n,n},n.prototype.get_canDrag=function(){return this._canDrag},n.prototype.set_canDrag=function(n){return this._canDrag=n,n},n.prototype.get_hasShield=function(){return this._hasShield},n.prototype.set_hasShield=function(n){return this._hasShield=n,n},n.prototype.get_showDecoration=function(){return this._showDecoration},n.prototype.set_showDecoration=function(n){return this._showDecoration=n,n},n.prototype.get_helpUrl=function(){return this._helpUrl},n.prototype.set_helpUrl=function(n){return this._helpUrl=n,n},n.prototype.get_defaultActionControlID=function(){return this._defaultActionControlID},n.prototype.set_defaultActionControlID=function(n){return this._defaultActionControlID=n,n},n.prototype.get_cancelActionControlID=function(){return this._cancelActionControlID},n.prototype.set_cancelActionControlID=function(n){return this._cancelActionControlID=n,n},n.prototype.get_showX=function(){return this._showX},n.prototype.set_showX=function(n){return this._showX=n,n},n.prototype.get_reloadElement=function(){return this._reloadElement},n.prototype.set_reloadElement=function(n){return this._reloadElement=n,n},n.prototype.get_dialogIconType=function(){return this._dialogIconType},n.prototype.set_dialogIconType=function(n){return this._dialogIconType=n,n},n}(),t.DialogSettings=e,u=function(){function t(n){this._dialogTemplateID=null,this._dialogStack=null,this.positiveConfirmation='YES',this.negativeConfirmation='NO',this._acceptButtonID=null,this._dismissButtonID=null,this._dialogAreaID=null,this._dialogShieldID=null,this._dialogForegroundID=null,this._dialogFrameID=null,this._dialogTopRegionID=null,this._dialogMiddleRegionID=null,this._dialogBottomRegionID=null,this._dialogContentAreaID=null,this._dialogHeaderAreaID=null,this._dialogIconAreaID=null,this._dialogTitleAreaID=null,this._dialogSubTitleAreaID=null,this._dialogBodyAreaID=null,this._dialogFooterAreaID=null,this._helpLinkID=null,this._learnMoreLinkID=null,this._learnMoreAreaID=null,this._closeIconID=null,this._acceptButtonDefaultText=null,this._declineButtonDefaultText=null,this._dismissButtonDefaultText=null,this._infoIconAltText=null,this._infoIconUrl=null,this._warningIconAltText=null,this._warningIconUrl=null,this._errorIconAltText=null,this._errorIconUrl=null,this._spinnerIconUrl=null,this._infoIconID=null,this._warningIconID=null,this._errorIconID=null,this._infoIconAreaID=null,this._warningIconAreaID=null,this._errorIconAreaID=null,this._contentCache={},n&&(i=O365.Button)}return t.prototype.get_isDialogShown=function(){return this._dialogStack!=null?this._dialogStack.length>0:!1},t.prototype.get_dialogTemplateID=function(){return this._dialogTemplateID},t.prototype.set_dialogTemplateID=function(n){return this._dialogTemplateID=n,n},t.prototype.get_acceptButtonID=function(){return this._acceptButtonID},t.prototype.set_acceptButtonID=function(n){return this._acceptButtonID=n,n},t.prototype.get_dismissButtonID=function(){return this._dismissButtonID},t.prototype.set_dismissButtonID=function(n){return this._dismissButtonID=n,n},t.prototype.get_dialogAreaID=function(){return this._dialogAreaID},t.prototype.set_dialogAreaID=function(n){return this._dialogAreaID=n,n},t.prototype.get_dialogShieldID=function(){return this._dialogShieldID},t.prototype.set_dialogShieldID=function(n){return this._dialogShieldID=n,n},t.prototype.get_dialogForegroundID=function(){return this._dialogForegroundID},t.prototype.set_dialogForegroundID=function(n){return this._dialogForegroundID=n,n},t.prototype.get_dialogFrameID=function(){return this._dialogFrameID},t.prototype.set_dialogFrameID=function(n){return this._dialogFrameID=n,n},t.prototype.get_dialogTopRegionID=function(){return this._dialogTopRegionID},t.prototype.set_dialogTopRegionID=function(n){return this._dialogTopRegionID=n,n},t.prototype.get_dialogMiddleRegionID=function(){return this._dialogMiddleRegionID},t.prototype.set_dialogMiddleRegionID=function(n){return this._dialogMiddleRegionID=n,n},t.prototype.get_dialogBottomRegionID=function(){return this._dialogBottomRegionID},t.prototype.set_dialogBottomRegionID=function(n){return this._dialogBottomRegionID=n,n},t.prototype.get_dialogContentAreaID=function(){return this._dialogContentAreaID},t.prototype.set_dialogContentAreaID=function(n){return this._dialogContentAreaID=n,n},t.prototype.get_dialogHeaderAreaID=function(){return this._dialogHeaderAreaID},t.prototype.set_dialogHeaderAreaID=function(n){return this._dialogHeaderAreaID=n,n},t.prototype.get_dialogIconAreaID=function(){return this._dialogIconAreaID},t.prototype.set_dialogIconAreaID=function(n){return this._dialogIconAreaID=n,n},t.prototype.get_dialogTitleAreaID=function(){return this._dialogTitleAreaID},t.prototype.set_dialogTitleAreaID=function(n){return this._dialogTitleAreaID=n,n},t.prototype.get_dialogSubTitleAreaID=function(){return this._dialogSubTitleAreaID},t.prototype.set_dialogSubTitleAreaID=function(n){return this._dialogSubTitleAreaID=n,n},t.prototype.get_dialogBodyAreaID=function(){return this._dialogBodyAreaID},t.prototype.set_dialogBodyAreaID=function(n){return this._dialogBodyAreaID=n,n},t.prototype.get_dialogFooterAreaID=function(){return this._dialogFooterAreaID},t.prototype.set_dialogFooterAreaID=function(n){return this._dialogFooterAreaID=n,n},t.prototype.get_helpLinkID=function(){return this._helpLinkID},t.prototype.set_helpLinkID=function(n){return this._helpLinkID=n,n},t.prototype.get_learnMoreLinkID=function(){return this._learnMoreLinkID},t.prototype.set_learnMoreLinkID=function(n){return this._learnMoreLinkID=n,n},t.prototype.get_learnMoreAreaID=function(){return this._learnMoreAreaID},t.prototype.set_learnMoreAreaID=function(n){return this._learnMoreAreaID=n,n},t.prototype.get_closeIconID=function(){return this._closeIconID},t.prototype.set_closeIconID=function(n){return this._closeIconID=n,n},t.prototype.get_acceptButtonDefaultText=function(){return this._acceptButtonDefaultText},t.prototype.set_acceptButtonDefaultText=function(n){return this._acceptButtonDefaultText=n,n},t.prototype.get_declineButtonDefaultText=function(){return this._declineButtonDefaultText},t.prototype.set_declineButtonDefaultText=function(n){return this._declineButtonDefaultText=n,n},t.prototype.get_dismissButtonDefaultText=function(){return this._dismissButtonDefaultText},t.prototype.set_dismissButtonDefaultText=function(n){return this._dismissButtonDefaultText=n,n},t.prototype.get_infoIconAltText=function(){return this._infoIconAltText},t.prototype.set_infoIconAltText=function(n){return this._infoIconAltText=n,n},t.prototype.get_infoIconUrl=function(){return this._infoIconUrl},t.prototype.set_infoIconUrl=function(n){return this._infoIconUrl=n,n},t.prototype.get_warningIconAltText=function(){return this._warningIconAltText},t.prototype.set_warningIconAltText=function(n){return this._warningIconAltText=n,n},t.prototype.get_warningIconUrl=function(){return this._warningIconUrl},t.prototype.set_warningIconUrl=function(n){return this._warningIconUrl=n,n},t.prototype.get_errorIconAltText=function(){return this._errorIconAltText},t.prototype.set_errorIconAltText=function(n){return this._errorIconAltText=n,n},t.prototype.get_errorIconUrl=function(){return this._errorIconUrl},t.prototype.set_errorIconUrl=function(n){return this._errorIconUrl=n,n},t.prototype.get_spinnerIconUrl=function(){return this._spinnerIconUrl},t.prototype.set_spinnerIconUrl=function(n){return this._spinnerIconUrl=n,n},t.prototype.get_infoIconID=function(){return this._infoIconID},t.prototype.set_infoIconID=function(n){return this._infoIconID=n,n},t.prototype.get_warningIconID=function(){return this._warningIconID},t.prototype.set_warningIconID=function(n){return this._warningIconID=n,n},t.prototype.get_errorIconID=function(){return this._errorIconID},t.prototype.set_errorIconID=function(n){return this._errorIconID=n,n},t.prototype.get_infoIconAreaID=function(){return this._infoIconAreaID},t.prototype.set_infoIconAreaID=function(n){return this._infoIconAreaID=n,n},t.prototype.get_warningIconAreaID=function(){return this._warningIconAreaID},t.prototype.set_warningIconAreaID=function(n){return this._warningIconAreaID=n,n},t.prototype.get_errorIconAreaID=function(){return this._errorIconAreaID},t.prototype.set_errorIconAreaID=function(n){return this._errorIconAreaID=n,n},t.prototype.alertText=function(n,t,i,r,u){if(!1==this.get_isDialogShown()){var f=HtmlEncode(i);this.alertHtml(n,t,f,r,u,null,null)}},t.prototype.alertHtml=function(t,r,u,f,e,o,s){var c,l,h,a;!1==this.get_isDialogShown()&&((e==null||e.length===0)&&(e=this.get_dismissButtonDefaultText()),c=this._getStandardModalSettings(),l=typeof o!='undefined',l=l&&o!=null,l&&(c=typeof o=='string'?new n.JS.DialogSettings(o):o),h=this._createInstance(c,f,0),h._setContentHtml(u,e,null),i.SetCancelButton(h.get_acceptButtonElement().id),i.SetDefaultButton(h.get_acceptButtonElement().id),h.updateHeader(t,r,null,s),h.repositionAndResizeDialog(),a=document.getElementById(h.get_acceptButtonElement().id),a!=null&&a.focus(),i.AttachDefaultButtonHandlers())},t.prototype.confirmText=function(n,t,i,r,u,f,e){if(!1==this.get_isDialogShown()){var o=HtmlEncode(i);this.confirmHtml(n,t,o,r,u,f,e,null)}},t.prototype.confirmHtml=function(t,r,u,f,e,o,s,h){var l,a,c,v,y;!1==this.get_isDialogShown()&&((e==null||e.length===0)&&(e=this.get_acceptButtonDefaultText()),(o==null||o.length===0)&&(o=this.get_declineButtonDefaultText()),l=this._getStandardModalSettings(),a=typeof h!='undefined',a=a&&h!=null,a&&(l=typeof h=='string'?new n.JS.DialogSettings(h):h),c=this._createInstance(l,f,1),c._setContentHtml(u,e,o),i.SetCancelButton(c.get_dismissButtonElement().id),v=c.get_dismissButtonElement().id,s&&(v=c.get_acceptButtonElement().id),i.SetDefaultButton(v),c.updateHeader(t,r,null,null),c.repositionAndResizeDialog(),y=document.getElementById(v),y!=null&&y.focus(),i.ResizeButtons(),i.AttachDefaultButtonHandlers())},t.prototype.showUrl=function(t,i,r,u){if(!1==this.get_isDialogShown()){var f=this._getStandardModalSettings();f=typeof u=='string'?new n.JS.DialogSettings(u):u,this._showUrlInternal(t,i,r,f)}},t.prototype._showUrlInternal=function(n,t,i,r){var u=this._createInstance(r,i,2);u._setContentUrl(t,n),u.updateHeader(0,t,null,null),u.repositionAndResizeDialog()},t.prototype.showHtmlFromElement=function(n,t,r,u){if(!1==this.get_isDialogShown()){var f=this._contentCache[n],e=this._getDialogSettings(u);(f==null||e.get_reloadElement())&&(f=this.calcCachedElement(n)),this._showHtmlInternal(f.innerHTML,t,r,e),i.ResizeButtons()}},t.prototype.calcCachedElement=function(n){var t=this._getElementByIdRecursively(n),i;if(t==null)throw Error.create('cannot find element "'+n+'"');return i=t.cloneNode(!0),this._contentCache[n]=i,t.innerHTML='',i},t.prototype.showHtml=function(n,t,i,r){var u=this._getDialogSettings(r);this._showHtmlInternal(n,t,i,u)},t.prototype._getElementByIdRecursively=function(n){for(var i=null,r=window.frames,t=0;t<r.length;t++){try{i=r[t].document.getElementById(n)}catch(u){}if(i)return i}return document.getElementById(n)},t.prototype._getDialogSettings=function(t){var i=this._getStandardModalSettings();return i=typeof t=='string'?new n.JS.DialogSettings(t):t},t.prototype._showHtmlInternal=function(n,t,r,u){var f=this._createInstance(u,r,3),e;f._setDialogHtml(n),f.updateHeader(u.get_dialogIconType(),t,null,null),f.repositionAndResizeDialog(),u.get_defaultActionControlID()!=null&&u.get_defaultActionControlID().length>0&&(e=document.getElementById(u.get_defaultActionControlID()),e!=null&&e.focus()),i.AttachDefaultButtonHandlers()},t.prototype.dismiss=function(t){var i,r,u;this.get_isDialogShown()&&(i=this._dialogStack.pop(),r=document.getElementById(i.getContentIFrameID()),(n.JS.DialogManager.get_isBrowserIE()||n.JS.DialogManager.get_isBrowserIE11())&&r!=null&&(u=document.body.createTextRange(),u.moveToElementText(i.get_frameElement()),u.select()),n.JS.DialogManager.get_isBrowserIE9PlusDocumentMode()&&r!=null?(i.get_element().style.display='none',window.setTimeout(function(){i.get_element().parentNode.removeChild(i.get_element()),i.dismiss(t),i=null},300)):(i.get_element().parentNode.removeChild(i.get_element()),i.dismiss(t),i=null))},t.prototype.getTopDialogInstance=function(){var n=null;return this.get_isDialogShown()&&(n=this._dialogStack.pop(),this._dialogStack.push(n)),n},t.prototype._getStandardModalSettings=function(){return new e(null)},t.prototype._createInstance=function(t,i,r){var u,e,o,f;return this._dialogStack==null&&(this._dialogStack=[]),u=window.BaseValidator,e=window.Sys,typeof u!="undefined"&&typeof e!="undefined"&&u.HideAllCallouts(!1),o=this._dialogStack.length,f=new n.JS.DialogInstance(this,o,t,i,r),this._dialogStack.push(f),f},t.prototype.isCacheAccessible=function(n){var i=this._contentCache[n],t=!0;try{i.innerHTML.toString()}catch(r){t=!1}return t},t.get_isRightToLeft=function(){var n=document.getElementsByTagName('html');return n.length>0&&n[0].dir==='rtl'},t.get_isModernUI=function(){return document.getElementById('ShellBodyAndFooterContainer')?!0:!1},t.centerDialog=function(t,i){var o=n.JS.DialogManager.getBrowserDimensions(),e,f;t.style.display='',e=(o.width-i.clientWidth)/2,f=(o.height-i.clientHeight)/2,t.style.position='absolute',n.JS.DialogManager.get_isRightToLeft()?t.style.right=r(e):t.style.left=r(e),f=f<0?0:f,t.style.top=r(f),n.JS.DialogManager.forceRedraw(t)},t.forceRedraw=function(t){n.JS.DialogManager._tempTextNode!=null&&n.JS.DialogManager._redrawCallback(),n.JS.DialogManager._tempTextNode=document.createTextNode(' '),t.appendChild(n.JS.DialogManager._tempTextNode),window.setTimeout(function(){n.JS.DialogManager._redrawCallback()},0)},t.get_isBrowserIE=function(){return navigator.userAgent.indexOf("MSIE")!=-1},t.get_isBrowserIE11=function(){return navigator.userAgent.indexOf("Trident/7.0")!=-1},t.get_isBrowserIE9PlusDocumentMode=function(){return t.get_isBrowserIE()&&document.documentMode&&document.documentMode>=9},t.get_isBrowserIE7Compatible=function(){return navigator.userAgent.indexOf("MSIE 7.0")!=-1},t._redrawCallback=function(){n.JS.DialogManager._tempTextNode!=null&&(n.JS.DialogManager._tempTextNode.parentNode!=null&&n.JS.DialogManager._tempTextNode.parentNode.removeChild(n.JS.DialogManager._tempTextNode),n.JS.DialogManager._tempTextNode=null)},t.getBrowserDimensions=function(){return new f(0,0,document.documentElement.clientWidth,document.documentElement.clientHeight)},t._tempTextNode=null,t}(),t.DialogManager=u})(t=n.JS||(n.JS={}))})(BOX||(BOX={}));function __loadCompatLayer(n){var t,i,r,u;n.Debug=function(){},n.Debug._fail=function(n){throw new Error(n);},n.Debug.writeln=function(n){if(window.console){if(window.console.debug){window.console.debug(n);return}if(window.console.log){window.console.log(n);return}}else if(window.opera&&window.opera.postError){window.opera.postError(n);return}},n.__getNonTextNode=function(n){try{while(n&&n.nodeType!=1)n=n.parentNode}catch(t){n=null}return n},n.__getLocation=function(n){for(var t={x:0,y:0};n;)t.x+=n.offsetLeft,t.y+=n.offsetTop,n=n.offsetParent;return t},n.navigate=function(n){window.setTimeout('window.location = "'+n+'";',0)},t=function(n,t){t._mozillaEventHandler=function(n){return window.event=n,t(n),n.avoidReturn?void 0:n.returnValue},this.addEventListener(n.slice(2),t._mozillaEventHandler,!1)},i=function(n,t){if(t._mozillaEventHandler){var i=t._mozillaEventHandler;delete t._mozillaEventHandler,this.removeEventListener(n.slice(2),i,!1)}},n.attachEvent=t,n.detachEvent=i,n.HTMLDocument.prototype.attachEvent=t,n.HTMLDocument.prototype.detachEvent=i,n.HTMLElement.prototype.attachEvent=t,n.HTMLElement.prototype.detachEvent=i,n.Event.prototype.__defineGetter__('srcElement',function(){return __getNonTextNode(this.target)||this.currentTarget}),n.Event.prototype.__defineGetter__('cancelBubble',function(){return this._bubblingCanceled||!1}),n.Event.prototype.__defineSetter__('cancelBubble',function(n){n&&(this._bubblingCanceled=!0,this.stopPropagation())}),n.Event.prototype.__defineGetter__('returnValue',function(){return!this._cancelDefault}),n.Event.prototype.__defineSetter__('returnValue',function(n){n||(this._cancelDefault=!0,this.preventDefault())}),n.Event.prototype.__defineGetter__('fromElement',function(){var n;return this.type=='mouseover'?n=this.relatedTarget:this.type=='mouseout'&&(n=this.target),__getNonTextNode(n)}),n.Event.prototype.__defineGetter__('toElement',function(){var n;return this.type=='mouseout'?n=this.relatedTarget:this.type=='mouseover'&&(n=this.target),__getNonTextNode(n)}),n.Event.prototype.__defineGetter__('button',function(){return this.which==1?1:this.which==3?2:0}),n.Event.prototype.__defineGetter__('offsetX',function(){return window.pageXOffset+this.clientX-__getLocation(this.srcElement).x}),n.Event.prototype.__defineGetter__('offsetY',function(){return window.pageYOffset+this.clientY-__getLocation(this.srcElement).y}),n.HTMLElement.prototype.__defineGetter__('parentElement',function(){return this.parentNode}),n.HTMLElement.prototype.__defineGetter__('innerText',function(){var t,n;try{return this.textContent}catch(i){for(t='',n=0;n<this.childNodes.length;n++)this.childNodes[n].nodeType==3&&(t+=this.childNodes[n].textContent);return str}}),n.HTMLElement.prototype.__defineSetter__('innerText',function(n){var t=document.createTextNode(n);this.innerHTML='',this.appendChild(t)}),n.HTMLElement.prototype.__defineGetter__('currentStyle',function(){return window.getComputedStyle(this,null)}),n.HTMLElement.prototype.__defineGetter__('runtimeStyle',function(){return window.getOverrideStyle(this,null)}),n.HTMLElement.prototype.removeNode=function(){return this.parentNode.removeChild(this)},n.HTMLElement.prototype.contains=function(n){while(n!=null&&n!=this)n=n.parentNode;return n!=null},n.CSSStyleSheet.prototype.__defineGetter__('rules',function(){return this.cssRules}),n.CSSStyleSheet.prototype.addRule=function(n,t,i){this.insertRule(n+'{'+t+'}',i)},n.CSSStyleSheet.prototype.removeRule=function(n){this.deleteRule(n)},n.CSSStyleDeclaration.prototype.__defineGetter__('styleFloat',function(){return this.cssFloat}),n.CSSStyleDeclaration.prototype.__defineSetter__('styleFloat',function(n){this.cssFloat=n}),DocumentFragment.prototype.getElementById=function(n){for(var u=[],r=this.childNodes,t,i=0;i<r.length;i++)t=r[i],t.nodeType==1&&u.push(t);while(u.length){if(t=u.shift(),t.id==n)return t;if(r=t.childNodes,r.length!=0)for(i=0;i<r.length;i++)t=r[i],t.nodeType==1&&u.push(t)}return null},DocumentFragment.prototype.getElementsByTagName=function(n){for(var f=[],u=[],r=this.childNodes,t,i=0;i<r.length;i++)t=r[i],t.nodeType==1&&u.push(t);while(u.length)if(t=u.shift(),(n=='*'||t.tagName==n.toUpperCase())&&f.push(t),r=t.childNodes,r.length!=0)for(i=0;i<r.length;i++)t=r[i],t.nodeType==1&&u.push(t);return f},DocumentFragment.prototype.createElement=function(n){return document.createElement(n)},r=function(n,t,i){var r;if(!n.documentElement)return[];i=i?i:n;var e=new XPathEvaluator,u=e.evaluate(t,i,n.createNSResolver(n.documentElement),XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),f=new Array(u.snapshotLength);for(r=0;r<u.snapshotLength;r++)f[r]=u.snapshotItem(r);return f},u=function(n,t,i){var u,f;if(t+='[1]',u=r(n,t,i),u.length!=0)for(f=0;f<u.length;f++)if(u[f])return u[f];return null},n.XMLDocument.prototype.selectNodes=function(n,t){return r(this,n,t)},n.XMLDocument.prototype.selectSingleNode=function(n,t){return u(this,n,t)},n.XMLDocument.prototype.transformNode=function(n){var t=new XSLTProcessor,r,i;return t.importStylesheet(n),r=document.implementation.createDocument("","",null),i=t.transformToDocument(this),i.xml},Node.prototype.selectNodes=function(n){var t=this.ownerDocument;return t.selectNodes(n,this)},Node.prototype.selectSingleNode=function(n){var t=this.ownerDocument;return t.selectSingleNode(n,this)},Node.prototype.__defineGetter__('baseName',function(){return this.localName}),Node.prototype.__defineGetter__('text',function(){return this.textContent}),Node.prototype.__defineSetter__('text',function(n){this.textContent=n}),Node.prototype.__defineGetter__('xml',function(){return(new XMLSerializer).serializeToString(this)})}function __supportsCompatLayer(n){return n.indexOf('Gecko')>=0||n.indexOf('AppleWebKit')>=0||n.indexOf('Opera')>=0}if(__supportsCompatLayer(window.navigator.userAgent))try{__loadCompatLayer(window)}catch(e){};var ImageButton=window.ImageButton||function(){var n=function(n,i,r){var e=n.getAttribute(r),u,f;t(n,e),u=n.getAttribute(i),n.setAttribute('src',u),n.parentElement.className.indexOf("clipDiv")>-1&&(f=n.getAttribute(r),t(n,f))},t=function(n,t){n.style&&n.style.cssText?n.style.cssText=t:n.setAttribute('style',t)},i=function(t){n(t,"hoverSrc","hoverStyle")},r=function(t){n(t,"activeSrc","activeStyle")},u=function(t){var i=document.getElementById(t);i!==null&&i.disabled&&(i.disabled=!1,n(i,"enabledSrc","enabledStyle"))},f=function(n){var i=document.getElementById(n),r,u;i.disabled||(r=i.getAttribute("onclick"),(r!=null||r!="")&&(i.disabled=!0,u=i.getAttribute("disabledStyle"),t(i,u)))};return{HoverOver:i,HoverOut:r,Enable:u,Disable:f}}();Namespace.Register("Microsoft.Online.BOX.JS.WebControls.Alerts"),Microsoft.Online.BOX.JS.WebControls.Alerts.AlertList=new function(){this.UpArrowHtml="&#9650;",this.DownArrowHtml="&#9660;",this.IsExpandedCookieName="AlertList.IsExpanded",this.IsExpandedCookieExpireDays=100,this.mainDiv=null,this.alertsDiv=null,this.headerDiv=null,this.headerContainer=null,this.headerTable=null,this.ecLabel=null,this.ToggleState=function(){var n=Microsoft.Online.BOX.JS.WebControls.Alerts.AlertList;n.ExpandCollapse(!n.IsExpanded())},this.IsExpanded=function(){return this.alertsDiv.style.display!="none"},this.ExpandCollapse=function(n){this.alertsDiv.style.display=n?"block":"none",this.ecLabel.innerHTML=n?this.UpArrowHtml:this.DownArrowHtml,Microsoft.Online.BOX.JS.Shared.SetPersistentCookie(this.IsExpandedCookieName,n?"1":"0",this.IsExpandedCookieExpireDays)},this.Load=function(){var n,t;for(this.mainDiv=document.getElementById("alertListDiv"),this.headerDiv=this.GetChildByName(this.mainDiv,"headerDiv",!0),this.headerContainer=this.headerDiv.parentElement.parentElement,this.alertsDiv=this.GetChildByName(this.mainDiv,"alertsDiv"),this.headerTable=this.GetChildByName(this.headerDiv,"headerTable"),this.ecLabel=this.GetChildByName(this.headerTable.rows[0].cells[1],"expColLabel"),n=Microsoft.Online.BOX.JS.WebControls.Alerts.AlertPriority,t=n.Low;t<=n.High;t++)n.ImageStyles[t]=this.EnsureProtocol(n.ImageStyles[t]);Microsoft.Online.BOX.Admin.UI.Alert.GetAlerts(Microsoft.Online.BOX.JS.WebControls.Alerts.AlertList.GetAlertsCallback,Microsoft.Online.BOX.JS.WebControls.Alerts.AlertList.GetAlertsErrorCallback)},this.GetAlertsCallback=function(n){var r,t,e,c,h,f,i,u,o,s,l;if(ClientLogService.WriteLog(ClientLogService.Destinations.Server,ClientLogService.LogLevel.Info,"In GetAlertsCallback: alerts.length="+n.length),r=Microsoft.Online.BOX.JS.WebControls.Alerts.AlertPriority,t=Microsoft.Online.BOX.JS.WebControls.Alerts.AlertList,t.mainDiv.style.display="none",n.ErrorType==null&&n.length!=0){for(e=t.alertsDiv.childNodes,c=e[0];e.length>n.length;)t.alertsDiv.removeChild(t.alertsDiv.childNodes[t.alertsDiv.childNodes.length-1]);while(e.length<n.length)u=c.cloneNode(!0),t.alertsDiv.appendChild(u);for(h=function(n){var f,u;if(n.childNodes)for(f=0;f<n.childNodes.length;f++){u=n.childNodes[f],h(u);switch(t.GetName(u)){case"levelIcon":u.src=r.TransparentImageUrl,u.setAttribute("style",r.ImageStyles[i.Priority]),u.title=r.ToolTips[i.Priority];break;case"messageLabel":u.innerHTML=i.Message;break;case"actionLink":i.ActionText==null||i.ActionText.length==0?u.style.display="none":(u.href=i.ActionUrl,i.ActionTarget!=null&&i.ActionTarget.length!=0&&(u.target=i.ActionTarget),i.ActionClick!=null&&i.ActionClick.length!=0&&(u.onclick=new Function(i.ActionClick)),u.innerHTML=i.ActionText)}}},f=0;f<n.length;f++)i=n[f],u=t.GetChildByName(t.alertsDiv.childNodes[f],"alertDiv",!0),h(u),t.AddCssToChildren(u.parentElement.parentElement,r.CssClasses[i.Priority]);t.headerContainer.style.display=n.length>1?"block":"none",n.length>1&&(o=t.GetChildByName(t.headerTable.rows[0].cells[0],"numAlertsHyperLink"),o.innerHTML=o.innerHTML.Format(n.length),t.AddCssToChildren(t.headerContainer,r.CssClasses[n[0].Priority]),s=t.GetChildByName(t.headerContainer,"numAlertsImage",!0),s.alt=o.innerHTML,s.setAttribute("style",r.ImageStyles[n[0].Priority]),s.src=r.TransparentImageUrl,l=Microsoft.Online.BOX.JS.Shared.GetPersistentCookie(t.IsExpandedCookieName)!=0,t.ExpandCollapse(l)),ClientLogService.WriteLog(ClientLogService.Destinations.Server,ClientLogService.LogLevel.Info,"In GetAlertsCallback: done processing"),t.mainDiv.style.display="block"}},this.GetAlertsErrorCallback=function(n){var t,i,r;n!=null?(i=n.ErrorType==null?"NotSpecified":n.ErrorType,r=n.CorrelationID==null?"NotSpecified":n.CorrelationID,t="Unexpected error happened in GetAlerts.ajax. ErrorType = "+i+"; CID = "+r):t="Unknown error happened in GetAlerts.ajax.",t=String.format("{0}. ErrorResponse={1}",t,window.JSON.stringify(n)),ClientLogService.WriteLog(ClientLogService.Destinations.Server,ClientLogService.LogLevel.Warning,t)},this.GetChildByName=function(n,t,i){for(var f=n.childNodes,r,u=0;u<f.length;u++)if((r=f[u],this.GetName(r)==t)||i&&(r=this.GetChildByName(r,t,!0),r))return r;return null},this.GetName=function(n){var t=3;return n.nodeType==t?null:n.getAttribute("data-name")},this.AddCssToChildren=function(n,t){for(var u=Microsoft.Online.BOX.JS.WebControls.Alerts.AlertPriority,f=1,i=n.firstChild,r;i;){if(i.nodeType==f){for(r=1;r<u.CssClasses.length;r++)i.className=i.className.replace(u.CssClasses[r],"").trim();i.className+=" "+t}i=i.nextSibling}},this.EnsureProtocol=function(n){return window.location.protocol.indexOf('https:')==0&&(n=n.replace("http:","https:")),n}},Microsoft.Online.BOX.JS.WebControls.Alerts.AlertPriority=new function(){this.Unknown=0,this.Low=1,this.Medium=2,this.High=3,this.ImageStyles=[],this.TransparentImageUrl='https://prod.msocdn.com/16.00.1670.006/en-US/Images/transparent.gif',this.ImageStyles[this.Low]='background: url(https://prod.msocdn.com/16.00.1670.006/en-US/webcontrols.png) -335px -49px;width:22px;height:22px;',this.ImageStyles[this.Medium]='background: url(https://prod.msocdn.com/16.00.1670.006/en-US/webcontrols.png) -335px -73px;width:22px;height:22px;',this.ImageStyles[this.High]='background: url(https://prod.msocdn.com/16.00.1670.006/en-US/webcontrols.png) -335px -97px;width:22px;height:22px;',this.CssClasses=[],this.CssClasses[this.Low]="o365-info-b",this.CssClasses[this.Medium]="o365-wrn-b",this.CssClasses[this.High]="o365-err-b",this.ToolTips=[],this.ToolTips[this.Low]='Info',this.ToolTips[this.Medium]='Warning',this.ToolTips[this.High]='Error'};Namespace.Register("Microsoft.Online.BOX.JS.WebControls.CmsContent"),Microsoft.Online.BOX.JS.WebControls.CmsContent=new function(){this.GetContentAsync=function(){var n=$('[contentRef][personalized="1"]').map(function(){return $(this).attr("contentRef")}).get().join(';');n.length>0&&Microsoft.Online.BOX.UI.WebControls.CmsContent.GetContentAsync(n,Microsoft.Online.BOX.JS.WebControls.CmsContent.GetContentCallback,Microsoft.Online.BOX.JS.WebControls.CmsContent.GetContentErrorCallback)},this.GetContentCallback=function(n){n!==null&&n.length>0&&($(n).each(function(){$("'[contentRef=\""+this.Path+"\"]'").html(this.Content)}),typeof PageLayout!="undefined"&&PageLayout.ResizePanels())},this.GetContentErrorCallback=function(){}};var ActionBar=window.ActionBar||function(){var t=null,n=null,u=function(n,t){var r=$get(n,t),i=document.getElementById(n+"_disabled");r&&(r.removeAttribute("style"),i&&i.parentElement.removeChild(i))},i=function(n,t){var r=$get(n,t),u=document.getElementById(n+"_disabled"),i;r&&!u&&(i=document.createElement('a'),i.id=n+"_disabled",i.innerText=r.innerText,i.style.color="#808080",i.style.textDecoration="none",i.style.cursor="default",i.tabIndex="-1",r.parentElement.appendChild(i),r.style.display="none")},r=function(n){var r,t={},u,i,f,e,o;for(t.top=t.left=t.right=t.bottom=0,u=n.offsetParent,n.nodeType==1&&(t.top+=n.offsetTop,t.left+=n.offsetLeft),i=n.parentNode;i!=n.ownerDocument.body&&i!=null;){if(i.nodeType==1){if(r=typeof i.currentStyle!='undefined'?i.currentStyle:document.defaultView.getComputedStyle(i,null),r.position!="static"&&r.position!='')break;t.left-=i.scrollLeft,t.top-=i.scrollTop,null!=u&&i==u&&(t.top+=i.offsetTop,t.left+=i.offsetLeft,u=i.offsetParent)}i=i.parentNode}for(f=n.offsetHeight,o=0;o<n.children.length;o++)e=n.childNodes[o],f<e.offsetHeight&&(f=e.offsetHeight,t.top=e.offsetTop);return t.right=t.left+n.offsetWidth,t.bottom=t.top+f,t},f=function(t){if(t.tagName.toLowerCase()=="a")while(t.tagName.toLowerCase()!="tr")t=t.parentElement;t!=n&&(t.className="RowHover ms-bgc-tl",n!=null&&(n.className="")),n=t},e=function(){t!=null&&(t.style.display='none',t=null,n!=null&&(n.className="ActionRow",n=null))},o=function(n,i){var o="",u,f,e;t!=null&&(o=t.id),this.closeMenu(),u=document.getElementById(n),u!=null&&n!=o&&(f=r(i),u.style.display='block',Shared.IsTextRightToLeft?(e=r(u),u.style.left=(f.right-(e.right-e.left)).toString()+"px"):u.style.left=f.left.toString()+"px",u.style.top=f.bottom.toString()+"px",u.style.zIndex='100',u.style.backgroundColor="white",i.focus(),t=u)},s=function(n){n=n?n:window.event,n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0,n.cancel=!0},h=function(n,t,r){var e=$get(n),f;if(e){var o=e.getElementsByTagName('a'),s=0,h=!1,n='';for(f=0;f<o.length;f++)s=o[f].getAttribute("enablemask"),h=o[f].getAttribute("disallowBulkAction")=="1",n=o[f].getAttribute("id"),s&&n&&(h&&r?i(n,e):(s&t)!=0?u(n,e):i(n,e))}};return{HoverRow:f,closeMenu:e,openMenu:o,cancelBubble:s,SetEnabledState:h}}();var MultiPageLayout=function(n,t,i,r,u,f,e,o,s,h){this.ID=n,this.ActivePanelIdElem=document.getElementById(n+'_ActivePanelID'),this.HelpLinkElem=document.getElementById('HelpLink'),this.SaveBtn=document.getElementById(i),this.PrevBtn=document.getElementById(r),this.NextBtn=document.getElementById(u),this.FinishBtn=document.getElementById(f),this.CancelBtn=document.getElementById(e),this.ReturnBtn=document.getElementById(o),this.ShowPrevButtonOnFirstPanel=h,this.ActivePanelIndex=0,this.Panels=s;for(var c=0;c<s.length;c++)this.Panels[c].Panel=document.getElementById(s[c].ID),this.Panels[c].NavElement=document.getElementById(s[c].ID+'_Navigation'),this.Panels[c].StepNumberElement=document.getElementById(s[c].ID+'_StepNumber'),this.Panels[c].ID==this.ActivePanelIdElem.value&&(this.ActivePanelIndex=c);this.ActivePanelIndex<this.Panels.length&&(this.ActivePanelIdElem.value=this.Panels[this.ActivePanelIndex].ID),t&&this.ResizePanels(),MultiPageLayout.Layouts.push(this),this.ShowPanel(this.ActivePanelIndex)};MultiPageLayout.Layouts=[],MultiPageLayout.GetLayout=function(n){for(var t=0;t<MultiPageLayout.Layouts.length;t++)if(MultiPageLayout.Layouts[t].ID==n)return MultiPageLayout.Layouts[t];return null},MultiPageLayout.prototype.ResizePanels=function(){for(var t=this.GetMaxHeight(),n=0;n<this.Panels.length;n++)this.Panels[n].Panel.style.height=t+'px'},MultiPageLayout.prototype.GetMaxHeight=function(){for(var i=0,r=this.Panels[this.ActivePanelIndex].Panel.clientWidth,t,n=0;n<this.Panels.length;n++)if(this.Panels[n].Panel.style.display=='none'){var u=this.Panels[n].Panel.style.position,f=this.Panels[n].Panel.style.left,e=this.Panels[n].Panel.style.width;this.Panels[n].Panel.style.position='absolute',this.Panels[n].Panel.style.left='-10000px',this.Panels[n].Panel.style.width=r+'px',this.Panels[n].Panel.style.display='block',t=this.Panels[n].Panel.clientHeight,this.Panels[n].Panel.style.position=u,this.Panels[n].Panel.style.left=f,this.Panels[n].Panel.style.width=e,this.Panels[n].Panel.style.display='none',t>i&&(i=t)}else t=this.Panels[n].Panel.clientHeight,t>i&&(i=t);return i},MultiPageLayout.prototype.Save=function(){return this.Panels[this.ActivePanelIndex].SaveClientClick()?this.ValidatePanel()?(typeof PageModifiedWarning!='undefined'&&(PageModifiedWarning.Enabled=!1),!0):!1:!1},MultiPageLayout.prototype.Next=function(n){return this.Panels[this.ActivePanelIndex].NextClientClick()?n&&this.ActivePanelIndex<this.Panels.length-1?(this.ValidatePanel()&&this.ShowPanel(this.ActivePanelIndex+1),!1):(typeof PageModifiedWarning!='undefined'&&(PageModifiedWarning.Enabled=!1),!0):!1},MultiPageLayout.prototype.Prev=function(n){return this.Panels[this.ActivePanelIndex].PrevClientClick()?n&&this.ActivePanelIndex>0?(typeof BaseValidator!="undefined"&&typeof BaseValidator.HideAllCallouts=="function"&&BaseValidator.HideAllCallouts(!0),this.ShowPanel(this.ActivePanelIndex-1),!1):(typeof PageModifiedWarning!='undefined'&&(PageModifiedWarning.Enabled=!1),!0):!1},MultiPageLayout.prototype.Finish=function(){return this.Panels[this.ActivePanelIndex].FinishClientClick()?this.ValidatePanel()?(typeof PageModifiedWarning!='undefined'&&(PageModifiedWarning.Enabled=!1),!0):!1:!1},MultiPageLayout.prototype.Cancel=function(){return this.Panels[this.ActivePanelIndex].CancelClientClick()?(typeof Page_ValidationActive!='undefined'&&(Page_ValidationActive=!1),typeof PageModifiedWarning!='undefined'&&(PageModifiedWarning.Enabled=!1),!0):!1},MultiPageLayout.prototype.Return=function(){if(!this.Panels[this.ActivePanelIndex].ReturnClientClick())return!1;if(typeof Page_ValidationActive!='undefined'&&(Page_ValidationActive=!1),typeof PageModifiedWarning!='undefined'&&PageModifiedWarning.Enabled){try{__doPostBack('MultiPageLayout_Return','')}catch(n){}return!1}return!0},MultiPageLayout.prototype.ShowPanelId=function(n,t){for(var i=0;i<this.Panels.length;i++)if(i!=this.ActivePanelIndex&&this.Panels[i].ID==n){(typeof t=="boolean"&&!t||this.ValidatePanel())&&(typeof BaseValidator!="undefined"&&typeof BaseValidator.HideAllCallouts=="function"&&BaseValidator.HideAllCallouts(!0),this.ShowPanel(i));return}},MultiPageLayout.prototype.ValidatePanel=function(){return this.ValidatePanelByObject(this.Panels[this.ActivePanelIndex])},MultiPageLayout.prototype.ValidatePanelByObject=function(n){var t=!0;return typeof Page_ValidationActive!='undefined'&&typeof n!='undefined'&&typeof Page_ClientValidate=='function'&&Page_ValidationActive&&!Page_ClientValidate(n.ID)&&(t=!1),t},MultiPageLayout.prototype.ShowPanel=function(n){for(var i=null,t,u,r=0;r<this.Panels.length;r++)n!=r&&(this.Panels[r].NavElement!=null&&(this.Panels[r].NavElement.className='',i=this.Panels[r].NavElement.children,i!='undefined'&&i.length!=0&&(i[0].className='ms-fcl-ns',i[0].setAttribute("href","#"))),this.Panels[r].StepNumberElement!=null&&(this.Panels[r].StepNumberElement.className='ms-fcl-ns'),this.Panels[r].Panel.style.display='none');if(this.Panels[n].NavElement!=null&&(this.Panels[n].NavElement.className='selected ms-fcl-tp',i=this.Panels[n].NavElement.children,i!='undefined'&&i.length!=0&&(i[0].className='ms-fcl-tp',i[0].removeAttribute("href"))),this.Panels[n].StepNumberElement!=null&&(this.Panels[n].StepNumberElement.className='current ms-fcl-tp'),this.Panels[n].Panel.style.display='block',this.ActivePanelIndex=n,t=this.Panels[n],this.ActivePanelIdElem.value=t.ID,Microsoft.Online.BOX.JS.Shared.SetPageID(t.ID),t.ControlToFocus.length>0&&(u=document.getElementById(t.ControlToFocus),u!=null))try{u.focus(),u.tagName=="INPUT"&&u.getAttribute("type")=="text"&&u.select()}catch(f){}this.SaveBtn!=null&&(Button.SetText(this.SaveBtn.id,t.SaveName),t.HideSaveButton?Button.Hide(this.SaveBtn.id):(Button.Show(this.SaveBtn.id),Button.SetDefaultButton(this.SaveBtn.id))),this.PrevBtn!=null&&(Button.SetText(this.PrevBtn.id,t.PrevName),n==0&&!this.ShowPrevButtonOnFirstPanel||t.HidePrevButton?Button.Hide(this.PrevBtn.id):Button.Show(this.PrevBtn.id)),this.NextBtn!=null&&(Button.SetText(this.NextBtn.id,t.NextName),n==this.Panels.length-1||t.HideNextButton?Button.Hide(this.NextBtn.id):(Button.Show(this.NextBtn.id),Button.SetDefaultButton(this.NextBtn.id))),this.FinishBtn!=null&&(Button.SetText(this.FinishBtn.id,t.FinishName),n!=this.Panels.length-1||t.HideFinishButton?Button.Hide(this.FinishBtn.id):(Button.Show(this.FinishBtn.id),Button.SetDefaultButton(this.FinishBtn.id))),this.CancelBtn!=null&&(Button.SetText(this.CancelBtn.id,t.CancelName),t.HideCancelButton?Button.Hide(this.CancelBtn.id):Button.Show(this.CancelBtn.id)),this.ReturnBtn!=null&&(this.ReturnBtn.title=t.ReturnName,t.HideReturnButton?Button.Hide(this.ReturnBtn.id):Button.Show(this.ReturnBtn.id)),this.HelpLinkElem!=null&&this.HelpLinkElem.setAttribute("onclick",t.HelpLinkUrl),typeof PageLayout!='undefined'&&PageLayout.ResizePanels(),window.scrollTo(0,0),this.Panels[this.ActivePanelIndex].OnClientShowPanel(),O365.Log.WriteLog(171748,O365.LogLevel.Info,O365.LogArea.Wizard,O365.LogParameter.Empty,t.ID),WebTracking.TrackPageLoad(t.ID)},MultiPageLayout.prototype.ActivePanelId=function(){return this.Panels[this.ActivePanelIndex].ID};var Tiles=new function(){this.Collapse=function(n){$("#"+n+" .HeadlineTile").addClass("CollapsedTile"),$("#"+n+" .HeadlineTile").removeClass("ExpandedTile")},this.Expand=function(n){$("#"+n+" .HeadlineTile").removeClass("CollapsedTile"),$("#"+n+" .HeadlineTile").addClass("ExpandedTile")}};var BalloonTip=new function(){var r=this,t=[],n=null,u=null,i;this.HostingParentId="ShellBodyAndFooterContainer",this.Initialize=function(r,u,f,e,o,s){var h=$("#"+r);h.data("TargetControlID",u),h.data("AltTargetControlID",f),h.data("Position",e),h.data("ShowOverlay",o),h.data("HideCloseButton",s),t.push(h),o&&n==null&&(n=$("<div class=\"BalloonTipOverlay ms-bgc-b\" style=\"display:none\" />").appendTo(document.body)),$(window).resize(function(){h.is(":visible")&&i(h)}),$("#"+this.HostingParentId).scroll(function(){h.is(":visible")&&i(h)}),h.appendTo(document.body)},this.Show=function(r){for(var u,f=0;f<t.length;f++)t[f].fadeOut("fast");if(u=$("#"+r),n!=null&&u.data("ShowOverlay")&&(n.toggle(!0),this.tabSaver&&this.tabSaver.RestoreTab(),this.tabSaver=new O365.TabSaver(u.get(0)),this.tabSaver.DisableTab()),i(u),!0===u.data("ShowOverlay")?u.fadeIn("fast").focus():u.fadeIn("fast"),u.data("HideCloseButton")){$(document).on('click',BalloonTip.HideAll);u.click(function(n){n.preventDefault(),n.stopPropagation()})}},this.Hide=function(t){var i=$("#"+t);i.fadeOut("fast"),n!=null&&(n.hide(),this.tabSaver&&(this.tabSaver.RestoreTab(),this.tabSaver=null)),i.data("HideCloseButton")&&$(document).off('click',BalloonTip.HideAll)},this.HideAll=function(){for(var i=0;i<t.length;i++)t[i].fadeOut("fast");n!=null&&n.hide()},i=function(n){var y=15,i=30,t=$("#"+n.data("TargetControlID"));if(t.length!==0||(t=$("#"+n.data("AltTargetControlID")),t.length!==0)){var r=t.offset().left,f=t.offset().top,e=t.outerWidth(),v=t.outerHeight(),l=n.offsetParent(),u=l.offset().left,o=l.offset().top,p=n.outerWidth(),b=n.outerHeight(),c=-o+f-b-y,h=-o+f+v+y,s=-u+r-p+i+e/2,a=-u+r-i+e/2,w=-o+f-v/2;switch(n.data("Position")){case"TopLeft":n.css("left",s),n.css("top",c);break;case"TopRight":n.css("left",a),n.css("top",c);break;case"BottomLeft":n.css("left",s),n.css("top",h);break;case"BottomRight":n.css("left",a),n.css("top",h);break;case"Left":n.css("left",-u+r-p-i),n.css("top",w);break;case"Right":n.css("left",-u+r+e+i),n.css("top",w)}}}};var Loading=function(){var n=1e4,t=2e4;return this.Texts=[],this.Timers=[],this.SetText=function(n,t){var i=document.getElementById(n+"_Text");i!=null&&(i.innerHTML=t)},this.SetTimers=function(i){var f,r,u;this.CancelTimers(i),f=this.Texts[i][0],this.SetText(i,f),r=this.Texts[i][1],r&&(this.Timers[i][0]=setTimeout(function(){this.SetText(i,r)},n)),u=this.Texts[i][2],u&&(this.Timers[i][1]=setTimeout(function(){this.SetText(i,u)},t))},this.CancelTimers=function(n){var i=this.Timers[n][0],t;i&&clearTimeout(i),t=this.Timers[n][1],t&&clearTimeout(t)},this}();